<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>Criando Feeds RSS Para Sites Que N√£o os Fornecem</title>
	<meta name="description" content="O site pessoal de Guilherme Magalh√£es Gall, um trabalhador da √°rea de TI. Cont√©m textos t√©cnicos sobre programa√ß√£o e os demais assuntos que interessam ao autor.">
	<meta name="author" content="Guilherme Magalh√£es Gall">
	<meta name="generator" content="Hugo 0.109.0">
	<meta name="keywords" content="rss, python, bash, shell, shell script">
	<link rel="me" href="https://bolha.us/@gmgall">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.css?rnd=1683351441">
	
</head>
<body>
	<header>
	================
	<div style="border-style: dotted; border-width: 2px; float: right">
	<label for="toggle-switch"><small>inverter tema</small></label>
	<input type="checkbox" id="toggle-switch">
	</div><br>
	== <a href="https://gmgall.net/">gmgall.net</a> ==<br>
	================
	<div style="float: right;">√â de compreender que sobretudo nos cansamos. Viver √© n√£o pensar.</div><br>
	<p>
	<nav>
			<a href="/"><b>In√≠cio</b></a>.
			
			
			<a href="/blog/"><b>Blog</b></a>.
			
			<a href="/categories/"><b>Categorias</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
			<a href="/books/"><b>Livros lidos</b></a>.
			
			<a href="/feeds/"><b>Feeds üì°</b></a>.
			
			<a href="/contact/"><b><span class="highlighted-entry">Contato</span></b></a>.
			
	</nav>
	</p>
			
</header>

	
	<main>
		<article>
			<h1>Criando Feeds RSS Para Sites Que N√£o os Fornecem</h1>
			<b><time>12.04.2023 22:00</time></b>
				
					<a class="category-link" href="/categories/tech">tech</a>
				
				
					<a href="/tags/rss">rss</a>
				
					<a href="/tags/python">python</a>
				
					<a href="/tags/bash">bash</a>
				
					<a href="/tags/shell">shell</a>
				
					<a href="/tags/shell-script">shell script</a>
				

			<div>
				


				<p>Quem usa um agregador RSS como &ldquo;porta de entrada&rdquo; para a <em>web</em> hoje em dia sofre com v√°rios sites que deveriam publicar um <em>feed</em>, mas n√£o o fazem.</p>
<p>Resta buscar/escrever ferramentas que usem APIs ou fazer <em>scraping</em> para gerar os <em>feeds</em>.</p>
<p>Muitas dessas ferramentas, como a <a href="https://github.com/RSS-Bridge/rss-bridge">RSS-Bridge</a>, parecem interessantes, mas nunca parei para test√°-las porque elas sempre me pareceram <em>complicadas demais</em>. A RSS-Bridge, por exemplo, precisa de um servidor com PHP.</p>
<p>Uma ferramenta de linha de comando, f√°cil de instalar, que eu pudesse agendar a execu√ß√£o via <code>cron</code>, que recebesse as op√ß√µes em texto e &ldquo;jogasse&rdquo; o resultado como texto na sa√≠da padr√£o, seria minha ferramenta ideal.</p>
<p>Nunca tinha encontrado uma ferramenta assim, at√© recentemente. Ela chama-se <a href="https://github.com/ittner/newslinkrss">newslinkrss</a>. Citando o README, &ldquo;ele funciona como um <em>crawler</em> ou <em>scraper</em> de prop√≥sito espec√≠fico&rdquo;.</p>
<p>Acho que o grande &ldquo;pulo do gato&rdquo; dessa ferramenta √© servir como uma esp√©cie de <em>framework</em> para cria√ß√£o de <em>feeds</em> RSS. Voc√™ s√≥ precisa entrar com o conhecimento espec√≠fico sobre a p√°gina para a qual voc√™ est√° tentando criar um <em>feed</em>.</p>
<p>Op√ß√µes para capturar/filtrar a URL de cada item do <em>feed</em> (o conte√∫do de <code>&lt;link&gt;</code>), o corpo de cada item (o conte√∫do de <code>&lt;description&gt;</code>), a data de cada item (o conte√∫do de <code>&lt;pubDate&gt;</code>), o t√≠tulo do <em>feed</em>&hellip; Est√£o todas presentes.</p>
<p>Fica mais simples de entender com um exemplo: criarei um <em>feed</em> RSS para as cervejas em que dei <em>check-in</em> no <a href="https://untappd.com/">Untappd</a>. O ponto de partida √© sempre a URL da p√°gina que lista os links para o que ser√£o os <code>&lt;item&gt;</code>s individuais do <em>feed</em>. Essa URL √© o √∫nico par√¢metro posicional que o comando recebe.</p>
<p>Num blog, seria a URL da p√°gina com a lista dos posts. Num site de not√≠cias, seria a URL da p√°gina principal de uma editoria qualquer. Nesse exemplo, √© a URL da p√°gina do <a href="https://untappd.com/user/gmgall">meu perfil no Untappd</a>. Ela cont√©m uma <em>timeline</em> com as cervejas abaixo de <em>Guilherme&rsquo;s Recent Activity</em>.</p>
<figure><img src="untappd.png"
         alt="Um perfil do Untappd visualizado visto pela interface web."/><figcaption>
            <h4>Meu perfil no Untappd.</h4>
        </figcaption>
</figure>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ newslinkrss <span style="color:#e6db74">&#39;https://untappd.com/user/gmgall&#39;</span> -o /tmp/feed.xml
</span></span></code></pre></div><p>Estou usando a op√ß√£o <code>-o</code> para gravar o <em>feed</em> resultante num arquivo em <code>/tmp/feed.xml</code>. O comportamento <em>default</em> √© imprimir na sa√≠da padr√£o. Enquanto estou criando o <em>feed</em>, gosto de abri-lo com o Firefox para ter uma visualiza√ß√£o melhor da estrutura.</p>
<figure><img src="firefox_rss.png"
         alt="Um arquivo XML sendo visualizado pelo Firefox."/><figcaption>
            <h4>A estrutura do feed sendo mostrada pelo Firefox.</h4>
        </figcaption>
</figure>

<p>Analisando o que temos at√© aqui, percebemos que o comando est√° generalista demais. Todo link virou um item no <em>feed</em>, at√© aqueles do topo da p√°gina (&ldquo;Blog&rdquo;, &ldquo;Top Rated&rdquo;, &ldquo;Help&rdquo;). Precisamos pegar s√≥ os links para os <em>check-ins</em>.</p>
<p>Vamos inspecionar a p√°gina do perfil para descobrirmos que padr√£o seguem os links para os <em>check-ins</em>. Usando a op√ß√£o <em>Selecionar um elemento da p√°gina (Ctrl+Shift+C)</em> e colocando o cursor do mouse sobre os links de texto &ldquo;View Detailed Check-in&rdquo;, percebemos que o padr√£o √© <code>/user/gmgall/checkin/</code> seguido por um n√∫mero.</p>
<figure><img src="inspetor.png"
         alt="Firefox Developer Tools sendo usada para inspecionar a p√°gina de um perfil no Untappd"/><figcaption>
            <h4>Usando DevTools para descobrir o padr√£o dos links que apontam para a p√°gina individual de cada check-in.</h4>
        </figcaption>
</figure>

<p>A op√ß√£o que usamos para capturarmos apenas os links que casam com determinada regex √© <code>-p</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ newslinkrss <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-p <span style="color:#e6db74">&#39;.+/user/gmgall/checkin/[0-9]+&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	<span style="color:#e6db74">&#39;https://untappd.com/user/gmgall&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-o /tmp/feed.xml
</span></span></code></pre></div><p>Se abrirmos o <em>feed</em> que temos nesse ponto, veremos que cada item √© um <em>check-in</em>. Outros links no perfil n√£o viraram <code>&lt;item&gt;</code>s no <em>feed</em>. Exemplo de um dos itens:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;item&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;title&gt;</span>Sat, 01 Apr 2023 04:26:44 +0000<span style="color:#f92672">&lt;/title&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;link&gt;</span>https://untappd.com/user/gmgall/checkin/1260790060<span style="color:#f92672">&lt;/link&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;description&gt;</span>Sat, 01 Apr 2023 04:26:44 +0000<span style="color:#f92672">&lt;/description&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;guid</span> <span style="color:#a6e22e">isPermaLink=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>https://untappd.com/user/gmgall/checkin/1260790060<span style="color:#f92672">&lt;/guid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/item&gt;</span>
</span></span></code></pre></div><p>Os links est√£o corretos, mas o t√≠tulo poderia ser melhor. O conte√∫do de <code>&lt;description&gt;</code> tamb√©m. Vamos usar a op√ß√£o <code>--follow</code> para tentarmos capturar mais informa√ß√µes por item.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ newslinkrss <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-p <span style="color:#e6db74">&#39;.+/user/gmgall/checkin/[0-9]+&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--follow <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	<span style="color:#e6db74">&#39;https://untappd.com/user/gmgall&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-o /tmp/feed.xml
</span></span></code></pre></div><p>Agora cada item est√° como o abaixo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;item&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;title&gt;</span>Guilherme is drinking a Torobayo by Compa√±ia Cervecera Kunstmann on Untappd<span style="color:#f92672">&lt;/title&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;link&gt;</span>https://untappd.com/user/gmgall/checkin/1260790060<span style="color:#f92672">&lt;/link&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;description&gt;</span>Guilherme is drinking a Torobayo by Compa√±ia Cervecera Kunstmann on Untappd | UntappdLink text: Sat, 01 Apr 2023 04:26:44 +0000<span style="color:#f92672">&lt;/description&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;author&gt;</span>The Untappd Team<span style="color:#f92672">&lt;/author&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;guid</span> <span style="color:#a6e22e">isPermaLink=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>https://untappd.com/user/gmgall/checkin/1260790060<span style="color:#f92672">&lt;/guid&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/item&gt;</span>
</span></span></code></pre></div><p>Melhorou bastante, mas tem uma melhora √≥bvia: capturar a data. A op√ß√£o <code>--follow</code> nos d√° a capacidade de capturar a data a partir da p√°gina de cada item individual com op√ß√µes espec√≠ficas para isso.</p>
<p>Vamos usar o inspetor na p√°gina de um <em>check-in</em> individual para vermos onde podemos pegar a data.</p>
<figure><img src="inspetor2.png"
         alt="Firefox Developer Tools sendo usado para inspecionar a p√°gina de um check-in no Untappd."/><figcaption>
            <h4>Inspecionando a p√°gina de um check-in no Untappd.</h4>
        </figcaption>
</figure>

<p>A data/hora do <em>check-in</em> aparece num par√°grafo (elemento <code>p</code>) com a classe <code>time</code>. Podemos captur√°-la via um <a href="https://developer.mozilla.org/pt-BR/docs/Web/CSS/CSS_Selectors">seletor CSS</a> com a op√ß√£o <code>--date-from-csss</code> (<em>date from CSS selector</em>).</p>
<p>Vamos tamb√©m usar a op√ß√£o <code>--log DEBUG</code> para vermos exatamente o que est√° sendo capturado como data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ newslinkrss <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-p <span style="color:#e6db74">&#39;.+/user/gmgall/checkin/[0-9]+&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--follow <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--date-from-csss <span style="color:#e6db74">&#39;.time&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--log DEBUG <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	<span style="color:#e6db74">&#39;https://untappd.com/user/gmgall&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-o /tmp/feed.xml
</span></span></code></pre></div><p>A op√ß√£o <code>--log DEBUG</code> vai imprimir linhas como a abaixo para cada item:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>INFO:__main__:Following URL https://untappd.com/user/gmgall/checkin/1260790060
</span></span><span style="display:flex;"><span>DEBUG:__main__:date-from-csss found candidate text: <span style="color:#e6db74">&#39;Sat, 01 Apr 2023 04:26:44 +0000&#39;</span>
</span></span><span style="display:flex;"><span>DEBUG:__main__:date regex matched: src<span style="color:#f92672">=</span>Sat, <span style="color:#ae81ff">01</span> Apr <span style="color:#ae81ff">2023</span> 04:26:44 +0000, rx<span style="color:#f92672">=(</span>.+<span style="color:#f92672">)</span>, result<span style="color:#f92672">=</span>Sat, <span style="color:#ae81ff">01</span> Apr <span style="color:#ae81ff">2023</span> 04:26:44 +0000
</span></span><span style="display:flex;"><span>DEBUG:__main__:Found date from CSS Selector 2023-04-01 04:26:44+00:00
</span></span></code></pre></div><p>Nesse caso espec√≠fico, j√° temos uma data em formato utiliz√°vel, mas raramente esse √© o caso. Use <code>--log</code> quando for criar <em>feeds</em> para p√°ginas com formatos mais complicados.</p>
<p>Vamos ver como est√° cada item no <em>feed</em> agora:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;item&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;title&gt;</span>Guilherme is drinking a Torobayo by Compa√±ia Cervecera Kunstmann on Untappd<span style="color:#f92672">&lt;/title&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;link&gt;</span>https://untappd.com/user/gmgall/checkin/1260790060<span style="color:#f92672">&lt;/link&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;description&gt;</span>Guilherme is drinking a Torobayo by Compa√±ia Cervecera Kunstmann on Untappd | UntappdLink text: Sat, 01 Apr 2023 04:26:44 +0000<span style="color:#f92672">&lt;/description&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;author&gt;</span>The Untappd Team<span style="color:#f92672">&lt;/author&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;guid</span> <span style="color:#a6e22e">isPermaLink=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>https://untappd.com/user/gmgall/checkin/1260790060<span style="color:#f92672">&lt;/guid&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;pubDate&gt;</span>Sat, 01 Apr 2023 04:26:44 GMT<span style="color:#f92672">&lt;/pubDate&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/item&gt;</span>
</span></span></code></pre></div><p>Nesse ponto, temos as datas de cada item (<code>&lt;pubDate&gt;</code> agora est√° presente).</p>
<p>Vamos melhorar o t√≠tulo de cada item. A parte inicial (<code>Guilherme is drinking a</code>) e a final (<code>on Untappd</code>) s√£o redundantes. A op√ß√£o <code>--title-regex</code> nos permite filtrar os t√≠tulos dos itens. Ela recebe uma regex com um grupo e o que casar dentro desse grupo se torna o novo t√≠tulo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ newslinkrss <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-p <span style="color:#e6db74">&#39;.+/user/gmgall/checkin/[0-9]+&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--follow <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--date-from-csss <span style="color:#e6db74">&#39;.time&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--log DEBUG <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--title-regex <span style="color:#e6db74">&#39;Guilherme is drinking a (.+) on Untappd&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	<span style="color:#e6db74">&#39;https://untappd.com/user/gmgall&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-o /tmp/feed.xml
</span></span></code></pre></div><p>Cada item agora tem um t√≠tulo melhor:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;item&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;title&gt;</span>Torobayo by Compa√±ia Cervecera Kunstmann<span style="color:#f92672">&lt;/title&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;link&gt;</span>https://untappd.com/user/gmgall/checkin/1260790060<span style="color:#f92672">&lt;/link&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;description&gt;</span>Guilherme is drinking a Torobayo by Compa√±ia Cervecera Kunstmann on Untappd | UntappdLink text: Sat, 01 Apr 2023 04:26:44 +0000<span style="color:#f92672">&lt;/description&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;author&gt;</span>The Untappd Team<span style="color:#f92672">&lt;/author&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;guid</span> <span style="color:#a6e22e">isPermaLink=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>https://untappd.com/user/gmgall/checkin/1260790060<span style="color:#f92672">&lt;/guid&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;pubDate&gt;</span>Sat, 01 Apr 2023 04:26:44 GMT<span style="color:#f92672">&lt;/pubDate&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/item&gt;</span>
</span></span></code></pre></div><p>Precisamos agora de um corpo melhor em cada item. Atualmente em <code>&lt;description&gt;</code> temos apenas um texto com nome da cerveja e data/hora do <em>check-in</em>.</p>
<p>Vamos usar <code>--with-body</code> para incluirmos um corpo e <code>--body-csss</code> para filtrarmos o que far√° parte do corpo por meio de um seletor CSS. Usando apenas <code>--with-body</code>, tudo entre <code>&lt;body&gt;</code> e <code>&lt;/body&gt;</code> ser√° inclu√≠do no corpo de cada item do <em>feed</em>. Pode ser esse o comportamento desejado para p√°ginas mais simples, mas n√£o √© o caso do Untappd.</p>
<p>Inspecionando a p√°gina de cada <em>check-in</em>, descobrimos que o <em>card</em> com as informa√ß√µes do check-in √© uma <code>div</code> com as classes <code>checkin-info</code> e <code>pad-it</code>. Podemos selecion√°-la com o seletor <code>.checkin-info.pad-it</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ newslinkrss <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-p <span style="color:#e6db74">&#39;.+/user/gmgall/checkin/[0-9]+&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--follow <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--date-from-csss <span style="color:#e6db74">&#39;.time&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--log DEBUG <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--title-regex <span style="color:#e6db74">&#39;Guilherme is drinking a (.+) on Untappd&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--with-body <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	--body-csss <span style="color:#e6db74">&#39;.checkin-info.pad-it&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	<span style="color:#e6db74">&#39;https://untappd.com/user/gmgall&#39;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-o /tmp/feed.xml
</span></span></code></pre></div><p>Se visualizarmos esse <em>feed</em> num agregador, temos um resultado bem satisfat√≥rio:</p>
<figure><img src="quite_rss.png"
         alt="Agregador RSS exibindo o feed que acabamos de criar."/><figcaption>
            <h4>Agregador QuiteRSS mostrando o feed que acabamos de criar nesse post.</h4>
        </figcaption>
</figure>

<p>Com o comando que gera o <em>feed</em> pronto, podemos remover a op√ß√£o <code>--log</code>. Para assinarmos o <em>feed</em> criado podemos agendar a execu√ß√£o peri√≥dica do <code>newslinkrss</code> via <code>cron</code> e assinarmos o <em>feed</em> resultante ou ent√£o indicarmos no nosso agregador RSS que a origem √© um comando.</p>
<hr>
<p>Como voc√™ tem lidado com sites que n√£o oferecem <em>feeds</em>? Conhece alguma ferramenta parecida com o <code>newslinkrss</code>? Adoraria ouvir sobre. Fa√ßa <a href="/contact/">contato</a> se quiser conversar sobre isso.</p>

			</div>
		</article>
	</main>

<h3>Coment√°rios</h3>
<details>
  <summary>Responda pelo fediverso</summary>
  <p>Responda pelo fediverso colando a URL abaixo no seu cliente: <pre>https://bolha.us/@gmgall/110192034249830765</pre></p>
  <button onclick="navigator.clipboard.writeText('https:\/\/bolha.us\/@gmgall\/110192034249830765')">COPIAR URL</button>
</details>
<a id="load-comments">Carregar coment√°rios</a>

<div id="comments-list"></div>


<script src="/js/purify.min.js"></script>
<script>
  document.getElementById('load-comments').addEventListener('click', async () => {
    document.getElementById('load-comments').remove()
    const response = await fetch('https:\/\/bolha.us/api/v1/statuses/110192034249830765/context')
    const data = await response.json()

    if (data.descendants && data.descendants.length > 0) {
      let descendants = data.descendants
      for (let descendant of descendants) {
        document.getElementById('comments-list').appendChild(DOMPurify.sanitize(createCommentEl(descendant), { 'RETURN_DOM_FRAGMENT': true }))
      }
    } else {
      document.getElementById('comments-list').innerHTML = '<p>‚ö†Ô∏è Sem coment√°rios no fediverso. ‚ö†Ô∏è</p>'
    }
  })

  function createCommentEl(d) {
    let comment = document.createElement('div')
    comment.classList.add('comment')

    let commentHeader = document.createElement('div')
    commentHeader.classList.add('comment-header')

    let userAvatar = document.createElement('img')
    userAvatar.classList.add('avatar')
    userAvatar.setAttribute('height', 60 )
    userAvatar.setAttribute('width', 60 )
    userAvatar.setAttribute('src', d.account.avatar_static)

    let userLink = document.createElement('a')
    userLink.classList.add('user-link')
    userLink.setAttribute('href', d.account.url)
    for (let emoji of d.account.emojis) {
      d.account.display_name = d.account.display_name.replace(
        `:${emoji.shortcode}:`,
        `<img src="${emoji.static_url}" alt="${emoji.shortcode}" height="14px" width="14px" />`
        )
    }
    let serverName = d.account.url.replace(/https?:\/\/(.+)\/@.+/, '$1')
    userLink.innerHTML = d.account.display_name + " (@" + d.account.username + "@" + serverName + ")"

    let commentDateTime = document.createElement('a')
    commentDateTime.classList.add('comment-date')
    commentDateTime.setAttribute('href', d.url)
    commentDateTime.innerHTML = d.created_at.substr(0, 10).replace(/([0-9]{4})-([0-9]{2})-([0-9]{2})/, '$3/$2/$1')

    commentHeader.appendChild(userAvatar)
    commentHeader.appendChild(userLink)
    commentHeader.appendChild(commentDateTime)

    let commentContent = document.createElement('p')
    commentContent.innerHTML = d.content

    comment.appendChild(commentHeader)
    comment.appendChild(commentContent)

    return comment
  }
</script>


<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/blog/input_filename-em-jq-e-yq/">input_filename das ferramentas jq e yq n√£o funcionam como esperado</a></li>
				
				<li><a href="/blog/comentarios-via-mastodon/">Adicionando Coment√°rios via Mastodon em Sites Est√°ticos</a></li>
				
				<li><a href="/blog/squash&#43;merge-no-git/">squash&#43;merge no Git</a></li>
				
				<li><a href="/books/livro-do-desassossego/">Livro do Desassossego</a></li>
				
				<li><a href="/blog/sobre-o-app-do-mastodon-e-discussoes-no-mastodon-em-geral/">Sobre o App do Mastodon e Discuss√µes no Mastodon em Geral</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p><a href="/license">CC</a> 2023 <a href="https://gmgall.net/"><b>gmgall.net</b></a>.
	</p>
</footer>

</body>
<script src="/js/theme.js"></script>
</html>
