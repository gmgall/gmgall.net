<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>tech - non-tech on gmgall.net</title>
    <link>https://gmgall.net/categories/tech-non-tech/</link>
    <description>Recent content in tech - non-tech on gmgall.net</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>pt-br</language>
    <lastBuildDate>Mon, 22 Jul 2024 16:29:53 -0300</lastBuildDate><atom:link href="https://gmgall.net/categories/tech-non-tech/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Premissas Erradas, PipeWire e Bluetooth</title>
      <link>https://gmgall.net/blog/premissas-erradas-pipewire-e-bluetooth/</link>
      <pubDate>Mon, 22 Jul 2024 16:29:53 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/premissas-erradas-pipewire-e-bluetooth/</guid>
      <description>&lt;p&gt;Esse final de semana relembrei que pode ser elevado o custo de partir de premissas erradas e n√£o gastar nem 5 minutinhos verificando a validade delas. Marquei com &lt;a href=&#34;https://gmgall.net/categories/tech/&#34;&gt;tech&lt;/a&gt; e &lt;a href=&#34;https://gmgall.net/categories/non-tech/&#34;&gt;non-tech&lt;/a&gt; porque honestamente acho que isso √© uma li√ß√£o tanto na √°rea t√©cnica quanto para a vida.üòÖ&lt;/p&gt;
&lt;p&gt;Ap√≥s um desastre na parti√ß√£o em que mantinha meu &lt;a href=&#34;https://xubuntu.org/&#34;&gt;SO principal&lt;/a&gt;, resolvi aproveitar a oportunidade da reinstala√ß√£o para finalmente testar outra distro. Estava incomodado com os rumos de Ubuntu e derivados j√° h√° algum tempo, mas a pregui√ßa vencia a insatisfa√ß√£o e eu n√£o trocava.&lt;/p&gt;
&lt;p&gt;Queria testar algo sem &lt;a href=&#34;https://systemd.io/&#34;&gt;systemd&lt;/a&gt;, mais minimalista e em que eu me sentisse no controle do SO de novo. Uma distro em que eu entendesse melhor que estava acontecendo. Fiquei entre &lt;a href=&#34;https://archlinux.org/&#34;&gt;Arch&lt;/a&gt;, &lt;a href=&#34;https://www.gentoo.org/&#34;&gt;Gentoo&lt;/a&gt; e &lt;a href=&#34;https://voidlinux.org/&#34;&gt;Void&lt;/a&gt;. Acabei escolhendo esse √∫ltimo e as primeiras impress√µes t√™m sido excelentes.&lt;/p&gt;
&lt;p&gt;A &lt;a href=&#34;https://docs.voidlinux.org/&#34;&gt;documenta√ß√£o do Void Linux&lt;/a&gt;, apesar de menor que a dispon√≠vel nas excelentes wikis de &lt;a href=&#34;https://wiki.gentoo.org/wiki/Main_Page&#34;&gt;Gentoo&lt;/a&gt; e &lt;a href=&#34;https://wiki.archlinux.org/title/Main_page&#34;&gt;Arch&lt;/a&gt;, tem tudo para voc√™ terminar com um desktop funcional. Ao menos foi minha experi√™ncia partindo da imagem do Void + XFCE.&lt;/p&gt;
&lt;p&gt;S√≥ uma coisa n√£o consegui fazer funcionar ap√≥s a 1¬™ leitura do t√≥pico correspondente na documenta√ß√£o oficial: Bluetooth. Meus fones pareavam por 1 ou 2 segundos e desconectavam logo em seguida. Confirmei que meu adaptador e fones funcionavam sem problemas testando no &lt;a href=&#34;https://minios.dev/pt/&#34;&gt;MiniOS&lt;/a&gt; (um sabor de Debian). Era s√≥ no Void que eu n√£o conseguia parear. √Åudio era reproduzido nos alto-falantes, ent√£o &lt;em&gt;n√£o podia&lt;/em&gt; ser o &lt;a href=&#34;https://en.wikipedia.org/wiki/Sound_server&#34;&gt;&lt;em&gt;sound server&lt;/em&gt;&lt;/a&gt;, &lt;em&gt;tinha&lt;/em&gt; que ser Bluetooth.&lt;/p&gt;
&lt;p&gt;A &lt;a href=&#34;https://docs.voidlinux.org/config/bluetooth.html&#34;&gt;documenta√ß√£o sobre o assunto&lt;/a&gt; √© bem direta:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;To use an audio device such as a wireless speaker or headset, ALSA users need to install the bluez-alsa package. PulseAudio users do not need any additional software. PipeWire users need libspa-bluetooth.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure&gt;&lt;img src=&#34;captura_de_tela_2024-07-22_00-22-59.png&#34;
         alt=&#34;Menu &amp;#39;Aplicativos&amp;#39; do XFCE. No submenu &amp;#39;Multim√≠dia&amp;#39; h√° um aplicativo chamado &amp;#39;Controle de volume do PulseAudio&amp;#39;.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Esse mixer funciona. Eu obviamente estou usando PulseAudio, certo?&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Se eu uso PulseAudio, n√£o deveria precisar de mais nada. &lt;em&gt;Tinha&lt;/em&gt; que ser Bluetooth.&lt;/p&gt;
&lt;p&gt;Parti ent√£o para tentar deixar as vers√µes dos softwares instalados no Void iguais √†s dos softwares instalados no MiniOS (que eu sabia que funcionava). Devia ser alguma regress√£o. Fiz &lt;em&gt;build&lt;/em&gt; do meu pr√≥prio pacote do &lt;a href=&#34;https://www.bluez.org/&#34;&gt;BlueZ&lt;/a&gt; para poder fazer &lt;em&gt;downgrade&lt;/em&gt; da vers√£o 5.76 para a 5.66, instalei outras 2 ou 3 vers√µes de kernel e gastei um bom tempo em &lt;em&gt;issues&lt;/em&gt; do GitHub, listas de discuss√£o, f√≥runs etc.&lt;/p&gt;
&lt;p&gt;Mesmo resultado. Pareava por apenas uns instantes.ü§¶‚Äç‚ôÇÔ∏è&lt;/p&gt;
&lt;p&gt;Desisti de executar o &lt;code&gt;bluetoothd&lt;/code&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; como servi√ßo. Rodei o execut√°vel diretamente num &lt;em&gt;shell&lt;/em&gt; com as &lt;em&gt;flags&lt;/em&gt; &lt;a href=&#34;https://man.voidlinux.org/bluetoothd#n&#34;&gt;&lt;code&gt;-n&lt;/code&gt;&lt;/a&gt; e &lt;a href=&#34;https://man.voidlinux.org/bluetoothd#d,&#34;&gt;&lt;code&gt;-d&lt;/code&gt;&lt;/a&gt; enquanto tentava parear para ver se eu recebia alguma &amp;ldquo;luz&amp;rdquo; melhor que as mensagens de erro do &lt;a href=&#34;https://man.voidlinux.org/bluetoothctl&#34;&gt;&lt;code&gt;bluetoothctl&lt;/code&gt;&lt;/a&gt;&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;Eis que em algum ponto durante os breves instantes de pareamento, aparece algo como a mensagem abaixo:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;a2dp-sink profile connect failed for 60:F4:3A:70:E4:0B: Protocol not available
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/List_of_Bluetooth_profiles#Advanced_Audio_Distribution_Profile_%28A2DP%29&#34;&gt;A2DP&lt;/a&gt; tem a ver com √°udio&amp;hellip; E se aconteceu o seguinte?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;O dispositivo pareava.&lt;/li&gt;
&lt;li&gt;Ele tentava se registrar como um dispositivo capaz de A2DP de alguma forma.&lt;/li&gt;
&lt;li&gt;O &lt;em&gt;sound server&lt;/em&gt; n√£o suportava esse perfil.&lt;/li&gt;
&lt;li&gt;O dispositivo se desconectava porque n√£o tinha mais o que ser feito.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Foi minha hip√≥tese naquele momento, mas isso implicaria em erro na documenta√ß√£o do Void, que dizia claramente &lt;em&gt;PulseAudio users do not need any additional software.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Mas e se&amp;hellip;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ pgrep -a pipewire
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1188&lt;/span&gt; pipewire
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1233&lt;/span&gt; /usr/bin/pipewire -c pipewire-pulse.conf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Eu estava, afinal, com o &lt;a href=&#34;https://pipewire.org/&#34;&gt;PipeWire&lt;/a&gt; instalado e rodando.ü§°&lt;/p&gt;
&lt;p&gt;Matei o processo, o som parou. Era o PipeWire em uso mesmo.ü§°ü§°&lt;/p&gt;
&lt;p&gt;Voltei √† documenta√ß√£o, √†quele √∫nico par√°grafo. &lt;em&gt;PipeWire users need &lt;code&gt;libspa-bluetooth&lt;/code&gt;&lt;/em&gt;. Instalei o pacote. Passou a parear e a reproduzir √°udio nos fones t√£o logo reiniciei os servi√ßos.ü§°ü§°ü§°&lt;/p&gt;
&lt;p&gt;Por n√£o ter conferido o que eu estava &lt;strong&gt;realmente&lt;/strong&gt;&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt; usando para √°udio, &amp;ldquo;botei a culpa&amp;rdquo; no subsistema errado e enveredei por um caminho que me tomou v√°rias horas. Verificar levaria s√≥ alguns segundos.&lt;/p&gt;
&lt;p&gt;Acho que a moral da hist√≥ria √©: especialmente se for r√°pido e barato, cheque suas premissas.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;√â preciso ter d√∫vidas. S√≥ os est√∫pidos t√™m uma confian√ßa absoluta em si mesmos.&lt;/p&gt;
&lt;p&gt;&amp;ndash; Orson Welles&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;O &lt;em&gt;daemon&lt;/em&gt;.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;Uma ferramenta de CLI de controle de Bluetooth.&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;A bem da verdade, o nome do &lt;em&gt;mixer&lt;/em&gt; do XFCE ser &amp;ldquo;Controle de volume &lt;strong&gt;do PulseAudio&lt;/strong&gt;&amp;rdquo;, me induziu bastante ao erro. N√£o muda o fato que conferir levaria literalmente apenas alguns segundos.&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
