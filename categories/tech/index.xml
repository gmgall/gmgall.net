<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>tech on gmgall.net</title>
    <link>https://gmgall.net/categories/tech/</link>
    <description>Recent content in tech on gmgall.net</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>pt-br</language>
    <lastBuildDate>Wed, 24 Jan 2024 20:51:04 -0300</lastBuildDate><atom:link href="https://gmgall.net/categories/tech/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Automatizando Blogroll Com OPML</title>
      <link>https://gmgall.net/blog/automatizando-blogroll-com-opml/</link>
      <pubDate>Wed, 24 Jan 2024 20:51:04 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/automatizando-blogroll-com-opml/</guid>
      <description>&lt;p&gt;TL;DR&lt;/p&gt;
&lt;p&gt;Gero o meu &lt;a href=&#34;https://gmgall.net/blogroll/&#34;&gt;blogroll&lt;/a&gt; a partir de um OPML gerado pelo meu agregador RSS. SÃ£o 4 etapas:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Gerar o OPML no agregador.&lt;/li&gt;
&lt;li&gt;Filtrar para manter apenas as categorias desejadas no OPML.&lt;/li&gt;
&lt;li&gt;Escrever um &lt;em&gt;shortcode&lt;/em&gt; do Hugo que renderiza o &lt;em&gt;blogroll&lt;/em&gt; a partir do OPML.&lt;/li&gt;
&lt;li&gt;Baixar o arquivo OPML para os diretÃ³rios corretos do Hugo antes de gerar o site.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Mais detalhes abaixo.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;HÃ¡ uma &lt;a href=&#34;https://liaamancio.com.br/2024/01/07/blogroll-como-no-tempo-da-internet-arte-internet-moleque/&#34;&gt;tendÃªncia&lt;/a&gt; &lt;a href=&#34;https://www.lireo.com/bringing-back-the-blogroll/&#34;&gt;recente&lt;/a&gt; &lt;a href=&#34;https://blog.cadusilva.com/blogroll&#34;&gt;interessante&lt;/a&gt; em sites pessoais e blogs: o ressurgimento dos &lt;em&gt;blogrolls&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Acho uma ideia excelente, uma forma de &lt;a href=&#34;https://tomcritchlow.com/2022/04/21/new-rss/&#34;&gt;aumentar a Ã¡rea de superfÃ­cie do &lt;em&gt;blogging&lt;/em&gt;&lt;/a&gt;, de fazer as pessoas descobrirem mais conteÃºdo em sites pessoais.&lt;/p&gt;
&lt;p&gt;Fiz um &lt;a href=&#34;https://gmgall.net/blogroll/&#34;&gt;blogroll para chamar de meu tambÃ©m&lt;/a&gt;, mas a forma como gero o meu nÃ£o Ã© manual. Como leio a Indie Web principalmente por &lt;a href=&#34;https://gmgall.net/tags/rss/&#34;&gt;RSS&lt;/a&gt;, pensei em oferecer tambÃ©m um link para um arquivo &lt;a href=&#34;http://opml.org/&#34;&gt;OPML&lt;/a&gt; com os &lt;em&gt;feeds&lt;/em&gt; dos sites no &lt;em&gt;blogroll&lt;/em&gt; para que fosse possÃ­vel subscriÃ§Ã£o em todos os sites de uma vez sÃ³.&lt;/p&gt;
&lt;p&gt;Penso que essa possibilidade Ã© uma boa para quem estÃ¡ conhecendo RSS sÃ³ agora ou perdeu o hÃ¡bito de acompanhar as atualizaÃ§Ãµes dos sites por um agregador (olÃ¡, viÃºvas do Google Reader, tudo bem por aÃ­? ğŸ‘‹).&lt;/p&gt;
&lt;p&gt;O &lt;strong&gt;1Âº passo&lt;/strong&gt; para gerar o &lt;em&gt;blogroll&lt;/em&gt; seria exportar meus &lt;em&gt;feeds&lt;/em&gt; num arquivo OPML. Uso o &lt;a href=&#34;https://freshrss.org/&#34;&gt;FreshRSS&lt;/a&gt;, que tem uma &lt;a href=&#34;https://github.com/FreshRSS/FreshRSS/tree/edge/cli&#34;&gt;ferramenta de linha de comando&lt;/a&gt; chamada &lt;code&gt;export-opml-for-user.php&lt;/code&gt; para isso.&lt;/p&gt;
&lt;p&gt;Eu poderia usar o arquivo OPML que ela gera diretamente, mas preciso dar uma limpada legal nos &lt;em&gt;feeds&lt;/em&gt; em que estou inscrito. Tem muitos sites sem atualizaÃ§Ã£o hÃ¡ anos e &lt;em&gt;feeds&lt;/em&gt; quebrados ali. Pensei em sÃ³ manter no OPML algumas categorias e fazer uma curadoria mais cuidadosa dessas que vou manter. EntÃ£o o &lt;strong&gt;2Âº passo&lt;/strong&gt; Ã© filtrar esse arquivo OPML que o FreshRSS gera.&lt;/p&gt;
&lt;p&gt;Isso Ã© relativamente fÃ¡cil com de fazer em &lt;a href=&#34;https://docs.python.org/3/library/xml.etree.elementtree.html&#34;&gt;Python&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/usr/bin/python3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; sys
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; xml.etree.ElementTree &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; ET
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tree &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ET&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;parse(sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdin)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;root &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tree&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;getroot()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;body &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; root&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;find(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;body&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;categories &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argv[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; category &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; body&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;findall(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;outline&amp;#39;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; category&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;attrib&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;not&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; categories:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        body&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;remove(category)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tree&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write(sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdout&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;buffer, encoding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;, xml_declaration&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;O script acima lÃª OPML da &lt;code&gt;stdin&lt;/code&gt; e escreve na &lt;code&gt;stdout&lt;/code&gt; o mesmo OPML com apenas as categorias passadas como argumentos.&lt;/p&gt;
&lt;p&gt;EntÃ£o, supondo que o script acima esteja num arquivo chamado &lt;code&gt;filter_opml.py&lt;/code&gt;, o comando abaixo grava em &lt;code&gt;blogroll.xml&lt;/code&gt; um arquivo OPML sÃ³ com as categorias &lt;code&gt;Fediverso lusÃ³fono&lt;/code&gt; e &lt;code&gt;ctrl-c.club&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;./export-opml-for-user.php --user gmgall | python filter_opml.py &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Fediverso lusÃ³fono&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ctrl-c.club&amp;#39;&lt;/span&gt; &amp;gt; blogroll.xml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Tendo esse arquivo disponÃ­vel, Ã© &amp;ldquo;fÃ¡cil&amp;rdquo; consumi-lo no &lt;a href=&#34;https://gohugo.io/&#34;&gt;Hugo&lt;/a&gt;. Ele permite guardar arquivos no diretÃ³rio &lt;code&gt;data&lt;/code&gt; que terÃ£o seus dados expostos nos templates, entÃ£o Ã© &amp;ldquo;sÃ³&amp;rdquo; questÃ£o de copiar meu arquivo OPML para &lt;code&gt;data&lt;/code&gt; e consumi-los com algo como &lt;code&gt;{{ $body := .Site.Data.blogroll.body }}&lt;/code&gt;, certo?&lt;/p&gt;
&lt;p&gt;Sim, mas nÃ£o achei intuitivo fazer isso. Saiu, mas teve alguma tentativa e erro envolvidas. A &lt;a href=&#34;https://github.com/gohugoio/hugo/commit/0eaaa8fee37068bfc8ecfb760f770ecc9a7af22a&#34;&gt;mensagem de commit&lt;/a&gt; na implementaÃ§Ã£o dessa funcionalidade cita casos simples, em que se recupera o &lt;strong&gt;conteÃºdo&lt;/strong&gt; de tags XML. O padrÃ£o OPML traz as informaÃ§Ãµes quase todas como &lt;strong&gt;atributos&lt;/strong&gt;. VocÃª precisa usar a &lt;a href=&#34;https://gohugo.io/functions/index-function/&#34;&gt;funÃ§Ã£o &lt;code&gt;index&lt;/code&gt; do Hugo&lt;/a&gt; para acessar os atributos e eles viram chaves com nomes iniciados por &lt;code&gt;-&lt;/code&gt; nos templates. Recomendo ler o que o &lt;a href=&#34;https://brainbaking.com/post/2022/01/generating-a-blogroll-with-opml-in-hugo/#hugo-and-xml-parsing&#34;&gt;Wouter Groeneveld escreveu sobre&lt;/a&gt;. ApÃ³s brigar um pouco com isso, saiu o &lt;a href=&#34;https://gohugo.io/content-management/shortcodes/&#34;&gt;&lt;em&gt;shortcode&lt;/em&gt;&lt;/a&gt; abaixo, o &lt;strong&gt;3Âº passo&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;body&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; .&lt;span style=&#34;color:#a6e22e&#34;&gt;Site&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;Data&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;blogroll&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;body&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ &lt;span style=&#34;color:#66d9ef&#34;&gt;range&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;body&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;outline&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  {{&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;text&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;index&lt;/span&gt; . &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-text&amp;#34;&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &amp;lt;&lt;span style=&#34;color:#a6e22e&#34;&gt;h2&lt;/span&gt;&amp;gt;{{ &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;text&lt;/span&gt; }}&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;h2&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &amp;lt;&lt;span style=&#34;color:#a6e22e&#34;&gt;ul&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {{&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;range&lt;/span&gt; .&lt;span style=&#34;color:#a6e22e&#34;&gt;outline&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      {{&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;feed_text&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;index&lt;/span&gt; . &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-text&amp;#34;&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      {{&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;feed_description&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;index&lt;/span&gt; . &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-description&amp;#34;&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      {{&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;feed_htmlUrl&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;index&lt;/span&gt; . &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-htmlUrl&amp;#34;&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      {{&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;feed_xmlUrl&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;index&lt;/span&gt; . &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-xmlUrl&amp;#34;&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &amp;lt;&lt;span style=&#34;color:#a6e22e&#34;&gt;li&lt;/span&gt;&amp;gt;&amp;lt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;href&lt;/span&gt;=&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{{ $feed_htmlUrl }}&amp;#34;&lt;/span&gt;&amp;gt;{{ &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;feed_text&lt;/span&gt; }}&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt;&amp;gt; &amp;lt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;href&lt;/span&gt;=&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{{ $feed_xmlUrl }}&amp;#34;&lt;/span&gt;&amp;gt;&amp;lt;&lt;span style=&#34;color:#a6e22e&#34;&gt;img&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;alt&lt;/span&gt;=&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;O logo do RSS.&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;src&lt;/span&gt;=&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/img/rss.svg&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;height&lt;/span&gt;=&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;12&amp;#34;&lt;/span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;width&lt;/span&gt;=&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;12&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;style&lt;/span&gt;=&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;display: inline&amp;#34;&lt;/span&gt;&amp;gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt;&amp;gt; {{ &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;feed_description&lt;/span&gt; }}&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;li&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {{ &lt;span style=&#34;color:#a6e22e&#34;&gt;end&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;ul&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ &lt;span style=&#34;color:#a6e22e&#34;&gt;end&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Esse &lt;em&gt;shortcode&lt;/em&gt; quebra nos casos em que uma categoria tem um Ãºnico &lt;em&gt;feed&lt;/em&gt; ou caso &lt;code&gt;body&lt;/code&gt; possua uma Ãºnica categoria. Vi quem preferisse &lt;a href=&#34;https://nikdoof.com/posts/2022/automating-a-blogroll-in-hugo/#the-script&#34;&gt;transformar o OPML em JSON antes de processÃ¡-lo&lt;/a&gt; com o Hugo. Tendo enfrentado esses probleminhas, entendo a motivaÃ§Ã£o.&lt;/p&gt;
&lt;p&gt;Chamei esse &lt;em&gt;shortcode&lt;/em&gt; de &lt;code&gt;blogroll&lt;/code&gt; e isso me permite renderizÃ¡-lo em qualquer arquivo de conteÃºdo desse site com &lt;code&gt;{{&amp;lt; blogroll &amp;gt;}}&lt;/code&gt;. Vou renderizÃ¡-lo entre 2 linhas horizontais abaixo:&lt;/p&gt;
&lt;hr&gt;


  &lt;h2&gt;ctrl-c.club&lt;/h2&gt;
  &lt;ul&gt;
      &lt;li&gt;&lt;a href=&#34;https://ctrl-c.club/~chiptune/blog/&#34;&gt;~chiptune posts on ctrl-c.club&lt;/a&gt; &lt;a href=&#34;https://ctrl-c.club/~gmgall/feeds/chiptune.xml&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; chiptune&amp;#39;s blog&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://ctrl-c.club/~FikaMedHasse/blog.html&#34;&gt;~FikaMedHasse posts on ctrl-c.club&lt;/a&gt; &lt;a href=&#34;https://ctrl-c.club/~gmgall/feeds/FikaMedHasse.xml&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; Blog!&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://ctrl-c.club/~gome/journal/&#34;&gt;~gome posts on ctrl-c.club&lt;/a&gt; &lt;a href=&#34;https://ctrl-c.club/~gmgall/feeds/gome.xml&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; gome â€” journal&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://ctrl-c.club/~lettuce/&#34;&gt;~lettuce posts on ctrl-c.club&lt;/a&gt; &lt;a href=&#34;https://ctrl-c.club/~gmgall/feeds/lettuce.xml&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; /home/lettuce/public_html/index.html&lt;/li&gt;
    
  &lt;/ul&gt;

  &lt;h2&gt;Fediverso lusÃ³fono&lt;/h2&gt;
  &lt;ul&gt;
      &lt;li&gt;&lt;a href=&#34;https://blog.cadusilva.com/&#34;&gt;Blog do Cadu Silva&lt;/a&gt; &lt;a href=&#34;https://blog.cadusilva.com/feed&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; Site pessoal de Cadu Silva. Aqui vocÃª encontra especialmente textos sobre tecnologia.&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://www.brunoarine.com/posts/&#34;&gt;Blog on Bruno Arine&lt;/a&gt; &lt;a href=&#34;https://brunoarine.com/posts/index.xml&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; Recent content in Blog on Bruno Arine&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://crieaporradeum.blog/&#34;&gt;Crie a Porra de um Blog&lt;/a&gt; &lt;a href=&#34;https://crieaporradeum.blog/index.xml&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; Recent content on Crie a Porra de um Blog&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://escrevescreve.wordpress.com/&#34;&gt;escrevescreve â€“ cecilia giannetti&lt;/a&gt; &lt;a href=&#34;https://gmgall.github.io/feeds/escrevescreve.xml&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; cecilia giannetti&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://blog.ayom.media/felipe-siles/&#34;&gt;Felipe Siles&lt;/a&gt; &lt;a href=&#34;https://blog.ayom.media/felipe-siles/feed/&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; Espero que seja Ãºtil&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;http://helio.loureiro.eng.br/index.php&#34;&gt;Home - helio.loureiro.eng.br&lt;/a&gt; &lt;a href=&#34;http://helio.loureiro.eng.br/index.php?format=feed&amp;amp;type=rss&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; Helio Loureiro - site pessoal, blog, informaÃ§Ãµes, scripts, unix, linux, receitas tÃ©cnicas, python, cyberativismo e outros&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://kiff.blog/&#34;&gt;Kiff&lt;/a&gt; &lt;a href=&#34;https://kiff.blog/rss&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; No more empty sketchbooks. Gallery of drawings and sketches produced during 2021, in an attempt to be daily studies.&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://liaamancio.com.br/&#34;&gt;Lia Amancio&lt;/a&gt; &lt;a href=&#34;https://liaamancio.com.br/feed/&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; Desde 2001 servindo conteÃºdo de qualidade na internet.&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://www.memedecarbono.com.br/&#34;&gt;Meme de Carbono&lt;/a&gt; &lt;a href=&#34;https://www.memedecarbono.com.br/feed/&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; Os Ã¡tomos e ideias que constroem a consciÃªncia&lt;/li&gt;
    
      &lt;li&gt;&lt;a href=&#34;https://sol2070.in/&#34;&gt;sol2070&lt;/a&gt; &lt;a href=&#34;https://sol2070.in/feed/notes.xml&#34;&gt;&lt;img alt=&#34;O logo do RSS.&#34; src=&#34;https://gmgall.net/img/rss.svg&#34; height=&#34;12&#34;  width=&#34;12&#34; style=&#34;display: inline&#34;&gt;&lt;/a&gt; &lt;/li&gt;
    
  &lt;/ul&gt;


&lt;hr&gt;
&lt;p&gt;Falta sÃ³ baixar o arquivo OPML para o diretÃ³rio &lt;code&gt;data&lt;/code&gt; (para que os dados fiquem disponÃ­veis para o &lt;em&gt;shortcode&lt;/em&gt; &lt;code&gt;blogroll&lt;/code&gt;) e para o diretÃ³rio &lt;code&gt;static&lt;/code&gt; (para que ele fique disponÃ­vel para download) a cada geraÃ§Ã£o do site. Como uso &lt;a href=&#34;https://docs.github.com/en/actions&#34;&gt;GitHub Actions&lt;/a&gt;, o &lt;strong&gt;4Âº passo&lt;/strong&gt; Ã© adicionar uma etapa no &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/.github/workflows/gh-pages-deployment.yml&#34;&gt;workflow de geraÃ§Ã£o desse site&lt;/a&gt; que coloca o arquivo nesses diretÃ³rios.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;- &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Download OPML for blogroll&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;run&lt;/span&gt;: |&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    wget &amp;#39;${{ secrets.OPML_URL }}&amp;#39; -O data/blogroll.xml
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    cp data/blogroll.xml static/blogroll.xml&lt;/span&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Isso Ã© tudo.&lt;/p&gt;
&lt;p&gt;E aÃ­? VocÃª tem um &lt;em&gt;blogroll&lt;/em&gt;? JÃ¡ pensou em oferecer um OPML para facilitar a inscriÃ§Ã£o em todos os &lt;em&gt;feeds&lt;/em&gt; de uma vez sÃ³?&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Migrando Para Uma Alternativa GPL Ao LastPass Authenticator</title>
      <link>https://gmgall.net/blog/migrando-para-uma-alternativa-gpl-ao-lastpass-authenticator/</link>
      <pubDate>Fri, 29 Sep 2023 03:40:06 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/migrando-para-uma-alternativa-gpl-ao-lastpass-authenticator/</guid>
      <description>&lt;p&gt;Usei o &lt;a href=&#34;https://play.google.com/store/apps/details?id=com.lastpass.authenticator&#34;&gt;LastPass Authenticator&lt;/a&gt; como &lt;em&gt;app&lt;/em&gt; de 2FA no meu celular Android por alguns anos. NÃ£o me recordo agora o que me levou a escolhÃª-lo no passado, mas, por hÃ¡bito, acabou sendo o que instalei no &lt;em&gt;smartphone&lt;/em&gt; que comprei recentemente.&lt;/p&gt;
&lt;p&gt;2 problemas sÃ©rios com o LastPass Authenticator:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ã© software proprietÃ¡rio e&lt;/li&gt;
&lt;li&gt;sÃ³ permite &lt;em&gt;backup&lt;/em&gt; na nuvem da LastPass&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Eu devia ter pesquisado uma alternativa livre antes, mas a &lt;strike&gt;preguiÃ§a&lt;/strike&gt;
 rotina venceu. Fiquei com esse problema por resolver.&lt;/p&gt;
&lt;p&gt;AtÃ© agora.&lt;/p&gt;
&lt;p&gt;A insÃ´nia me deu a oportunidade de ler o texto &lt;a href=&#34;https://joelchrono.xyz/blog/what-is-on-my-phone-fall-2023/&#34;&gt;&lt;em&gt;What&amp;rsquo;s on my Phone (Fall 2023)&lt;/em&gt;&lt;/a&gt;, recheado de recomendaÃ§Ãµes de &lt;em&gt;apps&lt;/em&gt; livres para Android instalÃ¡veis via &lt;a href=&#34;https://f-droid.org/&#34;&gt;F-Droid&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;O &lt;a href=&#34;https://getaegis.app/&#34;&gt;&lt;em&gt;Aegis Authenticator&lt;/em&gt;&lt;/a&gt;&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt; tinha a descriÃ§Ã£o &lt;em&gt;2FA manager with a nice&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt; interface and easy to backup&lt;/em&gt;. Boa, achei &amp;ldquo;o cara&amp;rdquo;!&lt;/p&gt;
&lt;p&gt;Aegis instalado, fui em &lt;code&gt;ConfiguraÃ§Ãµes&lt;/code&gt; &amp;gt; &lt;code&gt;Importar &amp;amp; Exportar&lt;/code&gt; &amp;gt; &lt;code&gt;Importar de arquivo&lt;/code&gt;. Tem mais de 10 opÃ§Ãµes de &lt;em&gt;apps&lt;/em&gt; de origem para escolher, mas o LastPass nÃ£o Ã© uma delas. ğŸ˜”&lt;/p&gt;
&lt;p&gt;Por sorte, alguÃ©m parou para olhar o arquivo gerado pela opÃ§Ã£o &lt;code&gt;Exportar contas para arquivo&lt;/code&gt; do LastPass Authenticator e descobriu que nÃ£o Ã© um JSON muito diferente do usado pelo prÃ³prio Aegis.&lt;/p&gt;
&lt;p&gt;Um &lt;a href=&#34;https://github.com/tghw/lastpass_aegis_convert&#34;&gt;conversor estÃ¡ disponÃ­vel no GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;O processo para migrar as contas foi o seguinte:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;No LastPass, fui em &lt;code&gt;ConfiguraÃ§Ãµes&lt;/code&gt; &amp;gt; &lt;code&gt;Transferir contas&lt;/code&gt; &amp;gt; &lt;code&gt;Exportar contas para arquivo&lt;/code&gt;. Foi gerado um arquivo JSON.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Transferi o arquivo para o computador e usei &lt;code&gt;python convert.py path/to/lastpass_auth_export.json&lt;/code&gt;. Um arquivo com nome no padrÃ£o &lt;code&gt;aegis_*.json&lt;/code&gt; foi gerado.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Transferi o arquivo &lt;code&gt;aegis_*.json&lt;/code&gt; para o celular. No Aegis, fui em &lt;code&gt;ConfiguraÃ§Ãµes&lt;/code&gt; &amp;gt; &lt;code&gt;Importar &amp;amp; Exportar&lt;/code&gt; &amp;gt; &lt;code&gt;Importar de arquivo&lt;/code&gt;. Selecionei &lt;code&gt;Aegis&lt;/code&gt; e escolhi em seguida o arquivo &lt;code&gt;aegis_*.json&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Funcionou perfeitamente. ğŸ˜Š&lt;/p&gt;
&lt;p&gt;Com as contas migradas, confirmei o &lt;em&gt;easy to backup&lt;/em&gt;. Em &lt;code&gt;ConfiguraÃ§Ãµes&lt;/code&gt; &amp;gt; &lt;code&gt;Backups&lt;/code&gt; consegui rapidamente selecionar um diretÃ³rio numa instÃ¢ncia do &lt;a href=&#34;https://nextcloud.com/&#34;&gt;Nextcloud&lt;/a&gt; e agora tenho backups regulares das contas.&lt;/p&gt;
&lt;p&gt;âš ï¸ &lt;strong&gt;NÃ£o deixe os arquivos JSON usados para migraÃ§Ã£o de bobeira no celular ou no computador. Apague-os assim que terminar a migraÃ§Ã£o.&lt;/strong&gt; âš ï¸&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;NÃ£o sei se Ã© uma boa ideia ter uma conta na nuvem de uma empresa que tem como maior seÃ§Ã£o de seu artigo na Wikipedia uma &lt;a href=&#34;https://en.wikipedia.org/wiki/LastPass#Security_incidents&#34;&gt;lista de incidentes de seguranÃ§a&lt;/a&gt;.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;O Aegis usa a licenÃ§a GPLv3.&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;EstÃ¡ aÃ­: acho que o motivo para eu ter instalado o LastPass Authenticator pela 1Âª vez foi eu ter achado a interface bonita.&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>GitHub Pages e Nomes de DiretÃ³rio Iniciados com Underline</title>
      <link>https://gmgall.net/blog/github-pages-underline/</link>
      <pubDate>Wed, 07 Jun 2023 19:25:06 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/github-pages-underline/</guid>
      <description>&lt;p&gt;Levei mais tempo para descobrir isso do que me orgulharia em compartilhar, entÃ£o escrevo aqui para nÃ£o esquecer.&lt;/p&gt;
&lt;p&gt;O &lt;a href=&#34;https://pages.github.com/&#34;&gt;GitHub Pages&lt;/a&gt; trata diretÃ³rios com nomes iniciados por &lt;code&gt;_&lt;/code&gt; (&lt;em&gt;underline&lt;/em&gt;) de forma especial &lt;strong&gt;mesmo se vocÃª estiver usando GitHub Actions para gerar os arquivos estÃ¡ticos com outras ferramentas&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Isso ocorre porque o &lt;a href=&#34;https://docs.github.com/en/pages/setting-up-a-github-pages-site-with-jekyll/about-github-pages-and-jekyll&#34;&gt;GitHub Pages pode gerar e servir um site feito com Jekyll&lt;/a&gt; se vocÃª quiser e para o &lt;a href=&#34;https://jekyllrb.com/&#34;&gt;Jekyll&lt;/a&gt;, diretÃ³rios com nomes iniciados por &lt;code&gt;_&lt;/code&gt; sÃ£o especiais.&lt;/p&gt;
&lt;p&gt;Aparentemente o Jekyll estÃ¡ envolvido mesmo quando configuramos o Pages para servir os arquivos de um &lt;em&gt;branch&lt;/em&gt; separado e escrevemos nosso prÃ³prio &lt;em&gt;workflow&lt;/em&gt; no &lt;a href=&#34;https://github.com/features/actions&#34;&gt;Actions&lt;/a&gt; para escrever nesse &lt;em&gt;branch&lt;/em&gt;. Achei pouco intuitivo e outras pessoas que conversaram comigo sobre o assunto concordaram, mas Ã© assim que o Pages funciona.&lt;/p&gt;
&lt;p&gt;Um site que eu estava tentando servir tinha uma estrutura de arquivos parecida com a seguinte:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;about
css
doc
â”œâ”€â”€ index.html
â”œâ”€â”€ _static
â”‚Â Â  â”œâ”€â”€ basic.css
â”‚Â Â  â”œâ”€â”€ doctools.js
â”‚Â Â  â”œâ”€â”€ documentation_options.js
â”‚Â Â  â”œâ”€â”€ file.png
â”‚Â Â  â”œâ”€â”€ graphviz.css
â”‚Â Â  â”œâ”€â”€ language_data.js
â”‚Â Â  â”œâ”€â”€ minus.png
â”‚Â Â  â”œâ”€â”€ plus.png
â”‚Â Â  â”œâ”€â”€ pygments.css
â”‚Â Â  â”œâ”€â”€ scripts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bootstrap.js
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bootstrap.js.LICENSE.txt
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bootstrap.js.map
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ pydata-sphinx-theme.js
â”‚Â Â  â”‚Â Â  â””â”€â”€ pydata-sphinx-theme.js.map
â”‚Â Â  â”œâ”€â”€ searchtools.js
â”‚Â Â  â”œâ”€â”€ sphinx_highlight.js
â”‚Â Â  â”œâ”€â”€ styles
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bootstrap.css
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ pydata-sphinx-theme.css
â”‚Â Â  â”‚Â Â  â””â”€â”€ theme.css
â”‚Â Â  â”œâ”€â”€ switcher.json
â”‚Â Â  â””â”€â”€ webpack-macros.html
â””â”€â”€ tutorial
    â”œâ”€â”€ graphs.html
    â”œâ”€â”€ index.html
    â”œâ”€â”€ plotting_customization.html
    â””â”€â”€ quantum_walk_models.html
example.html
features
gethelp
getstarted
images
index.html
index.xml
js
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;O arquivo &lt;code&gt;doc/index.html&lt;/code&gt; carregava vÃ¡rios recursos de &lt;code&gt;doc/_static/&lt;/code&gt;. SÃ³ a requisiÃ§Ã£o para o arquivo &lt;code&gt;doc/index.html&lt;/code&gt; era concluÃ­da com sucesso. Para as requisiÃ§Ãµes de todos os arquivos em &lt;code&gt;doc/_static&lt;/code&gt; eu recebia um erro 404 como resposta, &lt;strong&gt;mesmo que os arquivos estivessem lÃ¡&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Para que esses arquivos passassem a ser servidos normalmente, precisei criar um arquivo oculto de nome &lt;code&gt;.nojekyll&lt;/code&gt; na &lt;strong&gt;raiz do site&lt;/strong&gt;. A estrutura ficou mais ou menos a seguinte:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;about
css
doc
â”œâ”€â”€ index.html
â”œâ”€â”€ _static
â”‚Â Â  â”œâ”€â”€ basic.css
â”‚Â Â  â”œâ”€â”€ doctools.js
â”‚Â Â  â”œâ”€â”€ documentation_options.js
â”‚Â Â  â”œâ”€â”€ file.png
â”‚Â Â  â”œâ”€â”€ graphviz.css
â”‚Â Â  â”œâ”€â”€ language_data.js
â”‚Â Â  â”œâ”€â”€ minus.png
â”‚Â Â  â”œâ”€â”€ plus.png
â”‚Â Â  â”œâ”€â”€ pygments.css
â”‚Â Â  â”œâ”€â”€ scripts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bootstrap.js
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bootstrap.js.LICENSE.txt
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bootstrap.js.map
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ pydata-sphinx-theme.js
â”‚Â Â  â”‚Â Â  â””â”€â”€ pydata-sphinx-theme.js.map
â”‚Â Â  â”œâ”€â”€ searchtools.js
â”‚Â Â  â”œâ”€â”€ sphinx_highlight.js
â”‚Â Â  â”œâ”€â”€ styles
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ bootstrap.css
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ pydata-sphinx-theme.css
â”‚Â Â  â”‚Â Â  â””â”€â”€ theme.css
â”‚Â Â  â”œâ”€â”€ switcher.json
â”‚Â Â  â””â”€â”€ webpack-macros.html
â””â”€â”€ tutorial
    â”œâ”€â”€ graphs.html
    â”œâ”€â”€ index.html
    â”œâ”€â”€ plotting_customization.html
    â””â”€â”€ quantum_walk_models.html
example.html
features
gethelp
getstarted
images
index.html
index.xml
js
.nojekyll
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Depois da criaÃ§Ã£o desse arquivo, todas as requisiÃ§Ãµes eram concluÃ­das normalmente.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>input_filename das ferramentas jq e yq nÃ£o funcionam como esperado</title>
      <link>https://gmgall.net/blog/input_filename-em-jq-e-yq/</link>
      <pubDate>Fri, 05 May 2023 13:17:37 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/input_filename-em-jq-e-yq/</guid>
      <description>&lt;h2 id=&#34;tldr&#34;&gt;TL;DR&lt;/h2&gt;
&lt;p&gt;As ferramentas de linha de comando &lt;a href=&#34;https://stedolan.github.io/jq/&#34;&gt;&lt;code&gt;jq&lt;/code&gt;&lt;/a&gt; e &lt;a href=&#34;https://kislyuk.github.io/yq/&#34;&gt;&lt;code&gt;yq&lt;/code&gt;&lt;/a&gt; possuem uma funÃ§Ã£o &lt;em&gt;builtin&lt;/em&gt; chamada &lt;a href=&#34;https://stedolan.github.io/jq/manual/#input_filename&#34;&gt;&lt;code&gt;input_filename&lt;/code&gt;&lt;/a&gt; que deveria retornar o nome do arquivo sendo filtrado. Ela nÃ£o funciona como esperado.&lt;/p&gt;
&lt;p&gt;No caso especÃ­fico da &lt;code&gt;yq&lt;/code&gt; Ã© &lt;a href=&#34;https://github.com/kislyuk/yq/issues/84&#34;&gt;sempre retornado &lt;code&gt;&amp;lt;stdin&amp;gt;&lt;/code&gt;&lt;/a&gt;.  Exemplo&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ xq &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;input_filename&amp;#39;&lt;/span&gt; feeds/*xml
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;lt;stdin&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;lt;stdin&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;lt;stdin&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;lt;stdin&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;lt;stdin&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;lt;stdin&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;O comportamento em &lt;code&gt;jq&lt;/code&gt; tambÃ©m me parece inesperado:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cat a.json 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Roberpierre&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;equipment&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;guillotine&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cat b.json 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Yurovsky&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;equipment&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;gun&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ jq -s &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;map({name, &amp;#34;file&amp;#34;: input_filename})&amp;#39;&lt;/span&gt; *.json &lt;span style=&#34;color:#75715e&#34;&gt;# input_filename retorna sÃ³ o nome do Ãºltimo arquivo&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Roberpierre&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;b.json&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Yurovsky&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;b.json&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;como-esse-comportamento-me-pegou&#34;&gt;Como esse comportamento &amp;ldquo;me pegou&amp;rdquo;&lt;/h2&gt;
&lt;p&gt;JÃ¡ expliquei &lt;a href=&#34;https://gmgall.net/blog/gerando-feeds-com-github-actions-e-os-servindo-com-github-pages/&#34;&gt;aqui&lt;/a&gt; que possuo &lt;a href=&#34;https://github.com/gmgall/feeds&#34;&gt;um repositÃ³rio com &lt;em&gt;feeds&lt;/em&gt; RSS&lt;/a&gt; para sites que nÃ£o fornecem os seus prÃ³prios. Hoje nÃ£o estÃ¡ listado em lugar nenhum para que sites gero &lt;em&gt;feeds&lt;/em&gt;. A Ãºnica forma de ver isso, Ã© listar o &lt;a href=&#34;https://github.com/gmgall/feeds/tree/gh-pages&#34;&gt;&lt;em&gt;branch&lt;/em&gt; &lt;code&gt;gh-pages&lt;/code&gt; desse repositÃ³rio&lt;/a&gt;. Sabendo o nome do arquivo, vocÃª sabe que a URL para o &lt;em&gt;feed&lt;/em&gt; Ã© &lt;code&gt;https://gmgall.github.io/feeds/NOME_DO_ARQUIVO.xml&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Pensei em gerar um arquivo JSON com algumas metainformaÃ§Ãµes de cada &lt;em&gt;feed&lt;/em&gt;. Pretendo usÃ¡-lo mais tarde para listar os &lt;em&gt;feeds&lt;/em&gt; disponÃ­veis tanto &lt;a href=&#34;https://gmgall.net/feeds&#34;&gt;aqui&lt;/a&gt; quanto em outros lugares.&lt;/p&gt;
&lt;p&gt;Queria um arquivo no formato seguinte&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-JSON&#34; data-lang=&#34;JSON&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DiÃ¡rio de PetrÃ³polis&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;link&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://www.diariodepetropolis.com.br/&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;(EdiÃ§Ã£o online) Ãšltimas notÃ­cias, artigos e classificados da cidade.&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;feed&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://gmgall.github.io/feeds/diario_de_petropolis.xml&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  },
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NFL na ESPN - Resultados, vÃ­deos e estatÃ­sticas&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;link&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://www.espn.com.br/nfl&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Acesse ESPN para placares ao vivo da NFL, melhores momentos e notÃ­cias. Assista Ã  NFL pela ESPN no Star+&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;feed&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://gmgall.github.io/feeds/espn_nfl.xml&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;title&lt;/code&gt;, &lt;code&gt;link&lt;/code&gt; e &lt;code&gt;description&lt;/code&gt; sÃ£o informaÃ§Ãµes &lt;a href=&#34;https://validator.w3.org/feed/docs/rss2.html#requiredChannelElements&#34;&gt;requeridas nos &lt;em&gt;feeds&lt;/em&gt; RSS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Minha linha de raciocÃ­nio entÃ£o foi a seguinte:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ConheÃ§o um pouco dos filtros do &lt;code&gt;jq&lt;/code&gt;. Sei que existe &lt;a href=&#34;https://stedolan.github.io/jq/manual/#map(x),map_values(x)&#34;&gt;&lt;code&gt;map(x)&lt;/code&gt;&lt;/a&gt;, que aplica o filtro a cada elemento do &lt;em&gt;array&lt;/em&gt; de entrada.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sei que posso processar mais de um arquivo com a opÃ§Ã£o &lt;code&gt;-s&lt;/code&gt;, que coloca o conteÃºdo dos arquivos num &lt;em&gt;array&lt;/em&gt; Ãºnico, cada elemento com o conteÃºdo de um arquivo.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;xq&lt;/code&gt; Ã© sÃ³ um &lt;em&gt;wrapper&lt;/em&gt; para o &lt;code&gt;jq&lt;/code&gt;. EntÃ£o bastaria processar meus &lt;em&gt;feeds&lt;/em&gt; (XML) com &lt;code&gt;xq&lt;/code&gt; da mesma forma que faria se fossem arquivos JSON. A saÃ­da vai ser em JSON, o que vai facilitar bastante.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Como citei acima, 3 das 4 propriedades que quero no meu JSON sÃ£o requeridas pelo padrÃ£o RSS. Seria questÃ£o de gerar um objeto sÃ³ com elas para cada elemento do &lt;em&gt;array&lt;/em&gt; que estarÃ¡ disponÃ­vel por conta da opÃ§Ã£o de linha de comando &lt;code&gt;-s&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ xq -s &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;map({&amp;#34;title&amp;#34;: .rss.channel.title, &amp;#34;link&amp;#34;: .rss.channel.link, &amp;#34;description&amp;#34;: .rss.channel.description })&amp;#39;&lt;/span&gt; feeds/*xml
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DiÃ¡rio de PetrÃ³polis&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;link&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://www.diariodepetropolis.com.br/&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;(EdiÃ§Ã£o online) Ãšltimas notÃ­cias, artigos e classificados da cidade.&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NFL na ESPN - Resultados, vÃ­deos e estatÃ­sticas&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;link&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://www.espn.com.br/nfl&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Acesse ESPN para placares ao vivo da NFL, melhores momentos e notÃ­cias. Assista Ã  NFL pela ESPN no Star+&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Perfeito! A propriedade que falta, &lt;code&gt;feed&lt;/code&gt;, deve ser bem fÃ¡cil de adicionar, certo? Eu gero os &lt;em&gt;feeds&lt;/em&gt; num diretÃ³rio de nome &lt;code&gt;feeds&lt;/code&gt;. Basta cada objeto ter uma propriedade cujo valor serÃ¡ a &lt;em&gt;string&lt;/em&gt; &lt;code&gt;https://gmgall.github.io/&lt;/code&gt; + uma &lt;em&gt;string&lt;/em&gt; com &lt;em&gt;path&lt;/em&gt; do arquivo. Ainda bem que existe &lt;code&gt;input_filename&lt;/code&gt;, vai ser um &lt;em&gt;one-liner&lt;/em&gt;. ğŸ˜&lt;/p&gt;
&lt;p&gt;Vamos testar antes sÃ³ com o nome do arquivo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ xq -s &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;map({&amp;#34;title&amp;#34;: .rss.channel.title, &amp;#34;link&amp;#34;: .rss.channel.link, &amp;#34;description&amp;#34;: .rss.channel.description, &amp;#34;feed&amp;#34;: input_filename})&amp;#39;&lt;/span&gt; feeds/*xml
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DiÃ¡rio de PetrÃ³polis&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;link&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://www.diariodepetropolis.com.br/&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;(EdiÃ§Ã£o online) Ãšltimas notÃ­cias, artigos e classificados da cidade.&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;feed&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;lt;stdin&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NFL na ESPN - Resultados, vÃ­deos e estatÃ­sticas&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;link&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://www.espn.com.br/nfl&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Acesse ESPN para placares ao vivo da NFL, melhores momentos e notÃ­cias. Assista Ã  NFL pela ESPN no Star+&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;feed&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;lt;stdin&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;FuÃ©n. ğŸ¤¡&lt;/p&gt;
&lt;p&gt;Como resolvi no fim das contas?&lt;/p&gt;
&lt;p&gt;Para evitar instalar mais coisas no &lt;em&gt;runner&lt;/em&gt; que gera os &lt;em&gt;feeds&lt;/em&gt; e para evitar ler os XMLs e &amp;ldquo;montar&amp;rdquo; o JSON &amp;ldquo;na mÃ£o&amp;rdquo;, quis continuar com a suÃ­te &lt;code&gt;yq&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;O sonho do &lt;em&gt;one-liner&lt;/em&gt; morreu:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; feed in feeds/*; &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  xq --arg feed_url &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://gmgall.github.io/&lt;/span&gt;$feed&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{&amp;#34;title&amp;#34;: .rss.channel.title, &amp;#34;link&amp;#34;: .rss.channel.link, &amp;#34;description&amp;#34;: .rss.channel.description, &amp;#34;feed&amp;#34;: $feed_url}&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$feed&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;done&lt;/span&gt; | jq -s &amp;gt; ./feeds/feeds.json
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;O que acabei fazendo foi chamar o &lt;code&gt;xq&lt;/code&gt; para cada arquivo XML para gerar cada objeto dentro de um laÃ§o &lt;strong&gt;do shell&lt;/strong&gt; e sÃ³ no fim junto tudo com &lt;code&gt;jq -s&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;--arg&lt;/code&gt; permitiu injetar uma propriedade com o valor &lt;code&gt;https://gmgall.github.io/&lt;/code&gt; + &lt;em&gt;path&lt;/em&gt; do arquivo.&lt;/p&gt;
&lt;p&gt;Funciona. Estou orgulhoso?&lt;/p&gt;
&lt;p&gt;
&lt;figure&gt;
  &lt;img src=&#34;https://i.makeagif.com/media/9-25-2017/XOax9n.gif&#34; alt=&#34;Mais ou menos&amp;amp;hellip;&#34; /&gt;
&lt;/figure&gt;


&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;Uso o comando &lt;code&gt;xq&lt;/code&gt; que faz parte da suÃ­te &lt;code&gt;yq&lt;/code&gt;, que sÃ£o ambos &lt;em&gt;wrappers&lt;/em&gt; para o &lt;code&gt;jq&lt;/code&gt;.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;Gero mais que 2 &lt;em&gt;feeds&lt;/em&gt; no momento em que escrevo esse texto. Estou listando apenas 2 por brevidade.&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Adicionando ComentÃ¡rios via Mastodon em Sites EstÃ¡ticos</title>
      <link>https://gmgall.net/blog/comentarios-via-mastodon/</link>
      <pubDate>Wed, 03 May 2023 11:43:58 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/comentarios-via-mastodon/</guid>
      <description>&lt;p&gt;Esse site agora possui um botÃ£o &lt;code&gt;Carregar comentÃ¡rios&lt;/code&gt; abaixo das postagens cujos &lt;em&gt;links&lt;/em&gt; anunciei no Mastodon. Ao clicar nele, as respostas ao &lt;em&gt;toot&lt;/em&gt; sÃ£o exibidas. Foi possÃ­vel fazer isso apenas no lado do cliente com JavaScript acessando a API do Mastodon, entÃ£o Ã© uma soluÃ§Ã£o para ter comentÃ¡rios em sites estÃ¡ticos.&lt;/p&gt;
&lt;p&gt;Essa ideia nÃ£o Ã© minha, me baseei fortemente &lt;a href=&#34;https://joelchrono12.xyz/blog/how-to-add-mastodon-comments-to-jekyll-blog/&#34;&gt;numa postagem de Joel Garcia&lt;/a&gt;. Ele nÃ£o Ã©, porÃ©m, o &lt;a href=&#34;https://carlschwan.eu/2020/12/29/adding-comments-to-your-static-blog-with-mastodon/&#34;&gt;Ãºnico que fez isso&lt;/a&gt;. Existe tambÃ©m &lt;a href=&#34;https://dusanmitrovic.xyz/blog/post/2022-05-18/Adding-support-for-comments-through-integration-with-Mastodon&#34;&gt;quem faÃ§a uso de cÃ³digo no lado do servidor&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;O cerne da soluÃ§Ã£o Ã© o &lt;a href=&#34;https://docs.joinmastodon.org/methods/statuses/#context&#34;&gt;seguinte mÃ©todo&lt;/a&gt; na API do Mastodon:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;GET /api/v1/statuses/:id/context
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;A resposta serÃ¡ um JSON com 2 &lt;em&gt;arrays&lt;/em&gt;, um chamado &lt;code&gt;ancestors&lt;/code&gt; e outro chamado &lt;code&gt;descendants&lt;/code&gt;. As respostas ao &lt;em&gt;toot&lt;/em&gt; estarÃ£o em &lt;code&gt;descendants&lt;/code&gt;. Para &lt;em&gt;toots&lt;/em&gt; pÃºblicos, nÃ£o Ã© necessÃ¡rio autenticaÃ§Ã£o. A ideia, portanto, Ã© ter um botÃ£o&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; que chama uma funÃ§Ã£o em JavaScript que acessa esse mÃ©todo e cria &lt;code&gt;div&lt;/code&gt;s com os comentÃ¡rios abaixo de cada postagem.&lt;/p&gt;
&lt;h2 id=&#34;o-cÃ³digo&#34;&gt;O cÃ³digo&lt;/h2&gt;
&lt;p&gt;Criei um &lt;a href=&#34;https://gohugo.io/templates/partials/&#34;&gt;partial&lt;/a&gt; chamado &lt;code&gt;comments.html&lt;/code&gt; que trata dos comentÃ¡rios. Listo o cÃ³digo abaixo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ with .Params.comments }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;h3&lt;/span&gt;&amp;gt;ComentÃ¡rios&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;h3&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;details&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;summary&lt;/span&gt;&amp;gt;Responda pelo fediverso&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;summary&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;p&lt;/span&gt;&amp;gt;Responda pelo fediverso colando a URL abaixo no seu cliente: &amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;pre&lt;/span&gt;&amp;gt;{{ . }}&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;pre&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;p&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;button&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;onclick&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;navigator.clipboard.writeText(&amp;#39;{{ . }}&amp;#39;)&amp;#34;&lt;/span&gt;&amp;gt;COPIAR URL&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;button&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;details&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;a&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;load-comments&amp;#34;&lt;/span&gt;&amp;gt;Carregar comentÃ¡rios&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;a&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;div&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;id&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;comments-list&amp;#34;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;div&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ $server := replaceRE `(https://.*?)/.*` &amp;#34;$1&amp;#34; . }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ $toot_id := replaceRE `https://.+?/([0-9]*)$` &amp;#34;$1&amp;#34; . }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;script&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;src&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{{ &amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;js&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;purify&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;min&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;js&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;relURL&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;}}&amp;#34;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;script&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;script&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  document.&lt;span style=&#34;color:#a6e22e&#34;&gt;getElementById&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;load-comments&amp;#39;&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;addEventListener&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;click&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; () =&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    document.&lt;span style=&#34;color:#a6e22e&#34;&gt;getElementById&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;load-comments&amp;#39;&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;remove&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;response&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{{ $server }}/api/v1/statuses/{{ $toot_id }}/context&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;data&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;response&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;json&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#a6e22e&#34;&gt;data&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;descendants&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;data&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;descendants&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;length&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;descendants&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;data&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;descendants&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;descendant&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;descendants&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        document.&lt;span style=&#34;color:#a6e22e&#34;&gt;getElementById&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;comments-list&amp;#39;&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;appendChild&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;DOMPurify&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;sanitize&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;createCommentEl&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;descendant&lt;/span&gt;), { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;RETURN_DOM_FRAGMENT&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt; }))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      document.&lt;span style=&#34;color:#a6e22e&#34;&gt;getElementById&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;comments-list&amp;#39;&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;innerHTML&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;lt;p&amp;gt;âš ï¸ Sem comentÃ¡rios no fediverso. âš ï¸&amp;lt;/p&amp;gt;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  })
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;createCommentEl&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;comment&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; document.&lt;span style=&#34;color:#a6e22e&#34;&gt;createElement&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;div&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;comment&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;classList&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;add&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;comment&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;commentHeader&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; document.&lt;span style=&#34;color:#a6e22e&#34;&gt;createElement&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;div&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;commentHeader&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;classList&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;add&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;comment-header&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;userAvatar&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; document.&lt;span style=&#34;color:#a6e22e&#34;&gt;createElement&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;img&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;userAvatar&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;classList&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;add&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;avatar&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;userAvatar&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;setAttribute&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;height&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;60&lt;/span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;userAvatar&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;setAttribute&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;width&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;60&lt;/span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;userAvatar&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;setAttribute&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;src&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;account&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;avatar_static&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;userLink&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; document.&lt;span style=&#34;color:#a6e22e&#34;&gt;createElement&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;userLink&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;classList&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;add&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;user-link&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;userLink&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;setAttribute&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;href&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;account&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;url&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;emoji&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;of&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;account&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;emojis&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;account&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;display_name&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;account&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;display_name&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e6db74&#34;&gt;`:&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;emoji&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;shortcode&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;:`&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e6db74&#34;&gt;`&amp;lt;img src=&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;emoji&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;static_url&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; alt=&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;emoji&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;shortcode&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; height=&amp;#34;14px&amp;#34; width=&amp;#34;14px&amp;#34; /&amp;gt;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        )
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;serverName&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;account&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;url&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;/https?:\/\/(.+)\/@.+/&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;$1&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;userLink&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;innerHTML&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;account&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;display_name&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; (@&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;account&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;username&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;@&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;serverName&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;)&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;commentDateTime&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; document.&lt;span style=&#34;color:#a6e22e&#34;&gt;createElement&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;commentDateTime&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;classList&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;add&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;comment-date&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;commentDateTime&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;setAttribute&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;href&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;url&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;commentDateTime&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;innerHTML&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;created_at&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;substr&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;replace&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;/([0-9]{4})-([0-9]{2})-([0-9]{2})/&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;$3/$2/$1&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;commentHeader&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;appendChild&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;userAvatar&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;commentHeader&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;appendChild&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;userLink&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;commentHeader&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;appendChild&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;commentDateTime&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;commentContent&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; document.&lt;span style=&#34;color:#a6e22e&#34;&gt;createElement&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;p&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;commentContent&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;innerHTML&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;d&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;content&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;comment&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;appendChild&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;commentHeader&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;comment&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;appendChild&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;commentContent&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;comment&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;script&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ end }}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ã‰ bastante parecido com o &lt;a href=&#34;https://joelchrono12.xyz/blog/how-to-add-mastodon-comments-to-jekyll-blog/#main-function&#34;&gt;cÃ³digo do Joel&lt;/a&gt;, as diferenÃ§as sÃ£o as seguinte:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Na &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/layouts/partials/comments.html#L1&#34;&gt;linha 1&lt;/a&gt; garanto que vai ser incluÃ­do o cÃ³digo do &lt;em&gt;partial&lt;/em&gt; &lt;strong&gt;apenas&lt;/strong&gt; nas pÃ¡ginas que fornecerem um contexto com um &lt;em&gt;link&lt;/em&gt; para um &lt;em&gt;toot&lt;/em&gt; numa variÃ¡vel &lt;code&gt;comments&lt;/code&gt;. Isso Ã© feito graÃ§as Ã  &lt;a href=&#34;https://gohugo.io/functions/with/&#34;&gt;funÃ§Ã£o &lt;code&gt;with&lt;/code&gt; do Hugo&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Na &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/layouts/partials/comments.html#L6&#34;&gt;linha 6&lt;/a&gt; incluo um botÃ£o para copiar o &lt;em&gt;link&lt;/em&gt; para o &lt;em&gt;toot&lt;/em&gt; para a Ã¡rea de transferÃªncia. Isso facilita para quem deseja comentar. NÃ£o Ã© necessÃ¡rio selecionar e copiar o &lt;em&gt;link&lt;/em&gt; manualmente. Como a &lt;a href=&#34;https://gohugo.io/functions/with/&#34;&gt;funÃ§Ã£o &lt;code&gt;with&lt;/code&gt;&lt;/a&gt; faz um &lt;em&gt;rebinding&lt;/em&gt; do contexto, o &lt;em&gt;link&lt;/em&gt; estarÃ¡ em &lt;code&gt;{{ . }}&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Nas &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/layouts/partials/comments.html#L11&#34;&gt;linhas 11&lt;/a&gt; e &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/layouts/partials/comments.html#L12&#34;&gt;12&lt;/a&gt; extraio o servidor e o &lt;code&gt;id&lt;/code&gt; do &lt;em&gt;toot&lt;/em&gt; do &lt;em&gt;link&lt;/em&gt; para o &lt;em&gt;toot&lt;/em&gt; com &lt;a href=&#34;https://gohugo.io/functions/replacere/&#34;&gt;&lt;em&gt;regex&lt;/em&gt;&lt;/a&gt;. Isso me permite construir a URL para o mÃ©todo &lt;code&gt;GET /api/v1/statuses/:id/context&lt;/code&gt; da API do Mastodon na &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/layouts/partials/comments.html#L17&#34;&gt;linha 17&lt;/a&gt;. &lt;strong&gt;Acho que essa Ã© uma diferenÃ§a interessante entre a minha soluÃ§Ã£o e a do Joel.&lt;/strong&gt; A minha sÃ³ precisa que cada pÃ¡gina tenha adicionado ao seu &lt;a href=&#34;https://gohugo.io/content-management/front-matter/&#34;&gt;&lt;em&gt;front matter&lt;/em&gt;&lt;/a&gt; uma variÃ¡vel &lt;code&gt;comments&lt;/code&gt; com um &lt;em&gt;link&lt;/em&gt; para um &lt;em&gt;toot&lt;/em&gt;. A dele precisa de &lt;a href=&#34;https://joelchrono12.xyz/blog/how-to-add-mastodon-comments-to-jekyll-blog/#jekyll-set-up&#34;&gt;3 variÃ¡veis diferentes&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Na &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/layouts/partials/comments.html#L52&#34;&gt;linha 52&lt;/a&gt; eu extraio o nome do servidor. O Joel nÃ£o faz questÃ£o de mostrar o nome do servidor nos comentÃ¡rios do site dele.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Na &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/layouts/partials/comments.html#L58&#34;&gt;linha 58&lt;/a&gt; eu troco o formato da data para DD/MM/AAAA.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O resto Ã© praticamente igual:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Da &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/layouts/partials/comments.html#L15&#34;&gt;linha 15 Ã  linha 28&lt;/a&gt; defino uma funÃ§Ã£o que falarÃ¡ com a API do Mastodon se o botÃ£o &lt;code&gt;Carregar comentÃ¡rios&lt;/code&gt; for clicado.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Da &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/layouts/partials/comments.html#L30&#34;&gt;linha 30 Ã  linha 71&lt;/a&gt; defino uma funÃ§Ã£o que retorna uma &lt;code&gt;div&lt;/code&gt; para cada item no &lt;a href=&#34;https://docs.joinmastodon.org/entities/Context/#descendants&#34;&gt;&lt;em&gt;array&lt;/em&gt; &lt;code&gt;descendants&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Com o &lt;em&gt;partial&lt;/em&gt; definido, bastou chamÃ¡-lo nos &lt;em&gt;layouts&lt;/em&gt; das pÃ¡ginas em que eu desejo ativar comentÃ¡rios. Eu quero nos &lt;a href=&#34;https://github.com/gmgall/gmgall.net/commit/2c0b89bd238e1c136b4086cb1bc5c88d482d161b#diff-5942e866d871d1df37aadd5f735f37d2708ea0c3ebc753ccd1cc38a71a68e19bR19&#34;&gt;&lt;em&gt;posts&lt;/em&gt; do blog&lt;/a&gt; e em cada &lt;a href=&#34;https://github.com/gmgall/gmgall.net/commit/2c0b89bd238e1c136b4086cb1bc5c88d482d161b#diff-48079b3f67152acaf42b23c1205c876a542c5a83e2be44e4548d4a847ab54cb5R34&#34;&gt;livro que eu postar impressÃµes de leitura&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;vantagens&#34;&gt;Vantagens&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Simples de implementar.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Nada Ã© executado no servidor, funciona para sites estÃ¡ticos.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Basta a adiÃ§Ã£o de &lt;a href=&#34;https://github.com/gmgall/gmgall.net/commit/996e3941cd666ece381daba209d41780a088c24d&#34;&gt;uma variÃ¡vel&lt;/a&gt; no &lt;em&gt;front matter&lt;/em&gt; para ativar os comentÃ¡rios.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;desvantagens&#34;&gt;Desvantagens&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Se esse site se tornar acessado demais, ele pode comeÃ§ar a fazer mais requisiÃ§Ãµes ao servidor da instÃ¢ncia que uso do que ele suporta.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SÃ³ tenho o &lt;em&gt;link&lt;/em&gt; para &lt;em&gt;toot&lt;/em&gt; que anuncia o &lt;em&gt;post&lt;/em&gt; &lt;strong&gt;depois&lt;/strong&gt; de fazer o &lt;em&gt;toot&lt;/em&gt; e preciso fornecÃª-lo &lt;strong&gt;antes&lt;/strong&gt; do &lt;em&gt;build&lt;/em&gt; da pÃ¡gina. Isso quer dizer ter um &lt;em&gt;toot&lt;/em&gt; pÃºblico com um &lt;em&gt;link&lt;/em&gt; para um &lt;em&gt;post&lt;/em&gt; que sÃ³ estarÃ¡ disponÃ­vel depois de uns 3 minutos.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MigraÃ§Ãµes entre instÃ¢ncias do Mastodon carregam os perfis seguidos e os seguidores, mas ainda nÃ£o os &lt;em&gt;toots&lt;/em&gt;. Se eu migrar de instÃ¢ncia, os comentÃ¡rios ficam &amp;ldquo;presos&amp;rdquo; na instÃ¢ncia anterior.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;possibilidades-futuras&#34;&gt;Possibilidades futuras&lt;/h2&gt;
&lt;p&gt;Posso ter um &lt;em&gt;workflow&lt;/em&gt; do GitHub Actions que faz o &lt;em&gt;toot&lt;/em&gt; anunciando os &lt;em&gt;posts&lt;/em&gt; novos e insere os &lt;em&gt;links&lt;/em&gt; para os &lt;em&gt;toots&lt;/em&gt; no &lt;em&gt;front matter&lt;/em&gt; para mim. Isso me pouparia o trabalho de fazer o &lt;em&gt;toot&lt;/em&gt; manualmente e eliminaria o problema de ter um &lt;em&gt;toot&lt;/em&gt; indicando um &lt;em&gt;post&lt;/em&gt; novo enquanto o &lt;em&gt;build&lt;/em&gt; do site ainda estÃ¡ terminando.&lt;/p&gt;
&lt;p&gt;NÃ£o sei se vou nesse caminho. Deixaria de ser uma soluÃ§Ã£o simples. O &lt;em&gt;workflow&lt;/em&gt; precisaria se autenticar para fazer o &lt;em&gt;toot&lt;/em&gt; por mim e seria aumentada a dependÃªncia do GitHub Actions.&lt;/p&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;Seria possÃ­vel chamar a funÃ§Ã£o a cada carregamento de pÃ¡gina, mas quero reduzir a quantidade de requisiÃ§Ãµes Ã  API da instÃ¢ncia em que tenho conta.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>squash&#43;merge no Git</title>
      <link>https://gmgall.net/blog/squash&#43;merge-no-git/</link>
      <pubDate>Mon, 01 May 2023 23:22:39 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/squash&#43;merge-no-git/</guid>
      <description>&lt;p&gt;Ã€s vezes, depois de terminar o trabalho num &lt;em&gt;feature branch&lt;/em&gt; qualquer, vocÃª nÃ£o deseja simplesmente fazer um &lt;code&gt;merge&lt;/code&gt;. VocÃª quer dar uma &amp;ldquo;limpada&amp;rdquo; no histÃ³rico primeiro antes de fazer &lt;code&gt;merge&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Frequentemente essa &amp;ldquo;limpeza&amp;rdquo; se dÃ¡ na forma de um &lt;code&gt;squash&lt;/code&gt;, uma junÃ§Ã£o das alteraÃ§Ãµes inseridas por mais de um &lt;em&gt;commit&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Por exemplo: o &lt;a href=&#34;https://github.com/gmgall/gmgall.net&#34;&gt;repositÃ³rio desse site&lt;/a&gt; tem um &lt;em&gt;branch&lt;/em&gt; &lt;code&gt;main&lt;/code&gt; com histÃ³rico relativamente &amp;ldquo;limpo&amp;rdquo;. Cada &lt;em&gt;commit&lt;/em&gt; representa um novo conteÃºdo no site ou uma nova funcionalidade. O &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/.github/workflows/gh-pages-deployment.yml&#34;&gt;workflow que faz deploy&lt;/a&gt; do site Ã© disparado cada vez que eu faÃ§o um &lt;code&gt;push&lt;/code&gt; em &lt;code&gt;main&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Eu criei um &lt;em&gt;branch&lt;/em&gt; local chamado &lt;code&gt;fediverse_comments&lt;/code&gt; para trabalhar na funcionalidade de comentÃ¡rios. Era uma funcionalidade nova, eu nÃ£o sabia exatamente quantos &lt;em&gt;commits&lt;/em&gt; eu precisaria fazer. Estava experimentando muita coisa. EntÃ£o, mesmo sendo local, nÃ£o quis fazer bagunÃ§a em &lt;code&gt;main&lt;/code&gt;.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;branches_antes.png&#34;
         alt=&#34;Screenshot do gitk mostrando um branch main e um branch fediverse_comments com vÃ¡rios commits desorganizados.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Branch main &amp;#34;limpo&amp;#34; e feature branch fediverse_comments &amp;#34;sujo&amp;#34; antes do merge.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Depois de 5 &lt;em&gt;commits&lt;/em&gt; em &lt;code&gt;fediverse_comments&lt;/code&gt; (na imagem acima sÃ³ aparecem 4, mas fiz mais um depois de tirar o &lt;em&gt;screenshot&lt;/em&gt;) me dei por satisfeito. Era hora do &lt;code&gt;merge&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Eu normalmente faria:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;git rebase -i&lt;/code&gt; para transformar os &lt;em&gt;commits&lt;/em&gt; em &lt;code&gt;fediverse_comments&lt;/code&gt; em um ou mais &lt;em&gt;commits&lt;/em&gt; &amp;ldquo;limpos&amp;rdquo;, ou seja, &lt;em&gt;commits&lt;/em&gt; que eu estaria OK em trazer via &lt;code&gt;merge&lt;/code&gt; para &lt;code&gt;main&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;trocaria para o &lt;em&gt;branch&lt;/em&gt; &lt;code&gt;main&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;faria o &lt;code&gt;merge&lt;/code&gt; com o &lt;code&gt;fediverse_comments&lt;/code&gt; (agora jÃ¡ &amp;ldquo;limpo&amp;rdquo;)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Eu achava um pouco &amp;ldquo;indireto&amp;rdquo; demais &amp;ldquo;limpar&amp;rdquo; um &lt;em&gt;branch&lt;/em&gt; que em breve estaria em desuso para sÃ³ depois fazer &lt;code&gt;merge&lt;/code&gt;, mas era como eu sabia fazer e nunca me questionei muito.&lt;/p&gt;
&lt;p&gt;Pois bem, descobri uma forma que me pareceu mais intuitiva semana passada. O comando &lt;code&gt;merge&lt;/code&gt; jÃ¡ possui uma &lt;em&gt;flag&lt;/em&gt; &lt;code&gt;--squash&lt;/code&gt; que faz o que eu precisava.&lt;/p&gt;
&lt;p&gt;EntÃ£o, depois de terminar os trabalhos em &lt;code&gt;fediverse_comments&lt;/code&gt;, foi sÃ³ trocar para &lt;code&gt;main&lt;/code&gt; e dar o seguinte comando:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;git merge --squash fediverse_comments
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;O que esse comando faz Ã© colocar no &lt;strong&gt;working directory&lt;/strong&gt; e na &lt;strong&gt;staging area&lt;/strong&gt; todas as alteraÃ§Ãµes em &lt;code&gt;fediverse_comments&lt;/code&gt;. PorÃ©m, &lt;strong&gt;nÃ£o faz &lt;code&gt;commit&lt;/code&gt;&lt;/strong&gt;. Acho isso positivo porque me dÃ¡ a oportunidade de dar uma Ãºltima revisada ou de fazer mais alguma alteraÃ§Ã£o no &lt;em&gt;commit&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;NÃ£o precisei nessa situaÃ§Ã£o, entÃ£o fiz um &lt;em&gt;commit&lt;/em&gt; de mensagem &lt;code&gt;Adiciona comentÃ¡rios pelo fediverso&lt;/code&gt; em &lt;code&gt;main&lt;/code&gt;.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;branches_depois.png&#34;
         alt=&#34;Screenshot do gitk mostrando um branch main com um Ãºnico commit limpo que traz as alteraÃ§Ãµes de todos os commits sujos de fediverse_comments.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Branch main &amp;#34;limpo&amp;#34; com um Ãºnico commit com todas alternaÃ§Ãµes feitas em fediverse_comments.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Dessa forma, meu &lt;code&gt;main&lt;/code&gt; ficou apenas com &lt;em&gt;commits&lt;/em&gt; &amp;ldquo;limpos&amp;rdquo; e poupei a etapa de fazer &lt;code&gt;squash&lt;/code&gt; no &lt;em&gt;feature branch&lt;/em&gt;. Devo fazer mais dessa forma no futuro.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Gerando Feeds Com GitHub Actions e os Servindo Com GitHub Pages</title>
      <link>https://gmgall.net/blog/gerando-feeds-com-github-actions-e-os-servindo-com-github-pages/</link>
      <pubDate>Sun, 16 Apr 2023 14:01:34 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/gerando-feeds-com-github-actions-e-os-servindo-com-github-pages/</guid>
      <description>&lt;p&gt;Terminei o &lt;a href=&#34;https://gmgall.net/blog/criando-feeds-rss-com-newslinkrss/&#34;&gt;post anterior&lt;/a&gt; sobre o &lt;a href=&#34;https://github.com/ittner/newslinkrss&#34;&gt;newslinkrss&lt;/a&gt; falando o seguinte:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Com o comando que gera o &lt;em&gt;feed&lt;/em&gt; pronto, podemos remover a opÃ§Ã£o &lt;code&gt;--log&lt;/code&gt;. Para assinarmos o &lt;em&gt;feed&lt;/em&gt; criado podemos agendar a execuÃ§Ã£o periÃ³dica do &lt;code&gt;newslinkrss&lt;/code&gt; via &lt;code&gt;cron&lt;/code&gt; e assinarmos o &lt;em&gt;feed&lt;/em&gt; resultante ou entÃ£o indicarmos no nosso agregador RSS que a origem Ã© um comando.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Isso cobre 2 de 3 possibilidades de consumo dos &lt;em&gt;feeds&lt;/em&gt; criados. SÃ£o elas:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;arquivo local;&lt;/li&gt;
&lt;li&gt;comando e&lt;/li&gt;
&lt;li&gt;URL.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A 1Âª possibilidade, a de agendar o &lt;code&gt;newslinkrss&lt;/code&gt; para escrever periodicamente um &lt;em&gt;feed&lt;/em&gt; em &lt;code&gt;/path/para/o/feed.xml&lt;/code&gt; e depois informar ao agregador que a origem do &lt;em&gt;feed&lt;/em&gt; Ã© um arquivo, nÃ£o Ã© viÃ¡vel caso o nosso agregador RSS seja um serviÃ§o &lt;em&gt;web&lt;/em&gt; como o &lt;a href=&#34;https://feedly.com/&#34;&gt;Feedly&lt;/a&gt;. Ele naturalmente nÃ£o tem acesso ao nosso sistema de arquivos local.&lt;/p&gt;
&lt;p&gt;A 2Âª possibilidade, a de informar que a origem do &lt;em&gt;feed&lt;/em&gt; Ã© um comando, Ã© interessante por nÃ£o nos obrigar a agendar a execuÃ§Ã£o periÃ³dica do &lt;code&gt;newslinkrss&lt;/code&gt;, mas nÃ£o sÃ£o todos os agregadores que possuem essa funcionalidade.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;liferea.png&#34;
         alt=&#34;Tela de cadastro do agregador RSS Liferea mostrando 3 fontes possÃ­veis para o feed: URL, comando e arquivo local.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Tela de cadastro de feed no agregador Liferea. NÃ£o sÃ£o todos que permitem usar um comando como fonte.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Resta a Ãºltima possibilidade: gerar os &lt;em&gt;feeds&lt;/em&gt;, servi-los na &lt;em&gt;web&lt;/em&gt; e informar no agregador que a origem Ã© a URL dos &lt;em&gt;feeds&lt;/em&gt; gerados. Isso vai funcionar em agregadores &lt;em&gt;web&lt;/em&gt;, &lt;em&gt;mobile&lt;/em&gt; ou &lt;em&gt;desktop&lt;/em&gt; e vai permitir que outras pessoas tambÃ©m cadastrem o &lt;em&gt;feed&lt;/em&gt; que vocÃª criou. Ã‰ a possibilidade mais versÃ¡til porque estaremos fazendo o trabalho que o dono do site &lt;strong&gt;deveria ter feito, mas nÃ£o fez&lt;/strong&gt;: servir um &lt;em&gt;feed&lt;/em&gt; para o site acessÃ­vel a qualquer um na &lt;em&gt;web&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;A desvantagem dessa abordagem Ã© que nem todo mundo vai ter um servidor &lt;em&gt;web&lt;/em&gt; acessÃ­vel na internet e configurar um sÃ³ para servir &lt;em&gt;feeds&lt;/em&gt; de sites de terceiros pode ser trabalho demais. Seria Ã³timo uma alternativa mais simples e sugiro uma que depende apenas de termos uma conta no &lt;a href=&#34;https://github.com&#34;&gt;GitHub&lt;/a&gt;: gerar os &lt;em&gt;feeds&lt;/em&gt; com &lt;a href=&#34;https://docs.github.com/en/actions&#34;&gt;GitHub Actions&lt;/a&gt; e servi-los via &lt;a href=&#34;https://pages.github.com/&#34;&gt;GitHub Pages&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;O &amp;ldquo;estalo&amp;rdquo; veio ao pensar no &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/.github/workflows/gh-pages-deployment.yml&#34;&gt;&lt;em&gt;workflow&lt;/em&gt; que uso para publicar meu site&lt;/a&gt;. Se tenho um &lt;em&gt;workflow&lt;/em&gt; que executa o &lt;a href=&#34;https://gohugo.io/&#34;&gt;Hugo&lt;/a&gt; e faz o &lt;em&gt;deploy&lt;/em&gt; dos arquivos HTML/CSS/JS/etc. gerados por ele no GitHub Pages, seria questÃ£o de pouca adaptaÃ§Ã£o ter um &lt;em&gt;workflow&lt;/em&gt; que executa o &lt;code&gt;newslinkrss&lt;/code&gt; e faz o &lt;em&gt;deploy&lt;/em&gt; dos arquivos XML gerados.&lt;/p&gt;
&lt;p&gt;Funcionou praticamente na 1Âª tentativa. O &lt;a href=&#34;https://github.com/gmgall/feeds&#34;&gt;repositÃ³rio&lt;/a&gt; com o &lt;a href=&#34;https://github.com/gmgall/feeds/blob/main/generate_feeds.sh&#34;&gt;script que gera os &lt;em&gt;feeds&lt;/em&gt;&lt;/a&gt; e o &lt;a href=&#34;https://github.com/gmgall/feeds/blob/main/.github/workflows/feeds.yml&#34;&gt;&lt;em&gt;workflow&lt;/em&gt; que executa o script e faz o &lt;em&gt;deploy&lt;/em&gt;&lt;/a&gt; dos arquivos Ã© pÃºblico. O script &lt;code&gt;generate_feeds.sh&lt;/code&gt; Ã© sÃ³ um script Bash com uma sucessÃ£o de chamadas ao &lt;code&gt;newslinkrss&lt;/code&gt;. Os arquivos gerados em sÃ£o escritos em &lt;code&gt;./feeds&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;O arquivo &lt;code&gt;.github/workflows/feeds.yml&lt;/code&gt; descreve um &lt;em&gt;workflow&lt;/em&gt; do GitHub Actions que prepara o ambiente, executa o script &lt;code&gt;generate_feeds.sh&lt;/code&gt; e faz o &lt;em&gt;deploy&lt;/em&gt; dos arquivos em &lt;code&gt;./feeds&lt;/code&gt; no GitHub Pages. Vou descrever o que cada trecho do arquivo faz sem muito detalhamento porque acho que Ã© praticamente autoexplicativo. Vou me deter no processo de configuraÃ§Ã£o do Pages e das chaves no final, por ser as maiores &amp;ldquo;pegadinhas&amp;rdquo; do processo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Generate and deploy feeds&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;on&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;schedule&lt;/span&gt;: &lt;span style=&#34;color:#75715e&#34;&gt;# Run workflow automatically&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#f92672&#34;&gt;cron&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0 * * * *&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# Runs every hour, on the hour&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;workflow_dispatch&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;O trecho acima nomeia o &lt;em&gt;workflow&lt;/em&gt; e define que ele serÃ¡ executado em 2 situaÃ§Ãµes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Periodicamente, a cada 1h. A sintaxe usada Ã© a do &lt;code&gt;cron&lt;/code&gt;. Se precisar de ajuda com ela, veja o assistente &lt;a href=&#34;https://crontab.guru/&#34;&gt;crontab guru&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Ao se clicar no botÃ£o &lt;strong&gt;Run workflow&lt;/strong&gt; na pÃ¡gina das &lt;em&gt;Actions&lt;/em&gt; do repositÃ³rio no GitHub. NÃ£o Ã© estritamente necessÃ¡rio, mas Ã© interessante enquanto vocÃª estiver testando. Imagine precisar esperar uma hora pela prÃ³xima execuÃ§Ã£o do &lt;em&gt;workflow&lt;/em&gt; sÃ³ para descobrir se alguma alteraÃ§Ã£o funcionou como previsto?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;jobs&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#f92672&#34;&gt;build-deploy&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;runs-on&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;ubuntu-latest&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;steps&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#f92672&#34;&gt;uses&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;actions/checkout@v1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Aqui Ã© definido que a mÃ¡quina virtual (o &lt;em&gt;runner&lt;/em&gt;) em que os passos seguintes serÃ£o executados usarÃ¡ a Ãºltima versÃ£o disponÃ­vel do Ubuntu Linux.&lt;/p&gt;
&lt;p&gt;TambÃ©m executa o primeiro passo: fazer &lt;em&gt;checkout&lt;/em&gt; do repositÃ³rio. O &lt;em&gt;runner&lt;/em&gt; vai precisar usar o script &lt;code&gt;generate_feeds.sh&lt;/code&gt;. Essa &lt;em&gt;action&lt;/em&gt; torna o script disponÃ­vel no &lt;em&gt;runner&lt;/em&gt;. Ã‰ como se estivÃ©ssemos fazendo &lt;code&gt;git clone&lt;/code&gt; no &lt;em&gt;runner&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Instala Python 3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;uses&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;actions/setup-python@v2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;with&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f92672&#34;&gt;python-version&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;3.9&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Instala newslinkrss&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;run&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;pip3 install newslinkrss&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Acima instalamos o Python e o &lt;code&gt;newslinkrss&lt;/code&gt; via &lt;code&gt;pip&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Cria diretÃ³rio que receberÃ¡ os feeds&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;run&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;mkdir feeds&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Acima criamos o diretÃ³rio &lt;code&gt;feeds&lt;/code&gt;. Lembram que &lt;code&gt;generate_feeds.sh&lt;/code&gt; escreve sempre no diretÃ³rio &lt;code&gt;feeds&lt;/code&gt;? Com esse passo, criamos esse diretÃ³rio no &lt;em&gt;runner&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Executa newslinkrss&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;run&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;bash generate_feeds.sh&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Acima executamos o script &lt;code&gt;generate_feeds.sh&lt;/code&gt;. O script estÃ¡ disponÃ­vel no &lt;em&gt;runner&lt;/em&gt; porque o 1Âº passo que fizemos foi um &lt;em&gt;checkout&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-yml&#34; data-lang=&#34;yml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    - &lt;span style=&#34;color:#f92672&#34;&gt;name&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;Deploy&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;uses&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;peaceiris/actions-gh-pages@v2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#f92672&#34;&gt;env&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f92672&#34;&gt;ACTIONS_DEPLOY_KEY&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;${{ secrets.ACTIONS_DEPLOY_KEY }}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f92672&#34;&gt;PUBLISH_BRANCH&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;gh-pages&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f92672&#34;&gt;PUBLISH_DIR&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;./feeds&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Acima Ã© feito o &lt;em&gt;deploy&lt;/em&gt; com a &lt;em&gt;action&lt;/em&gt; &lt;a href=&#34;https://github.com/peaceiris/actions-gh-pages&#34;&gt;&lt;code&gt;peaceiris/actions-gh-pages&lt;/code&gt;&lt;/a&gt;. Essa Ã© a parte final do &lt;em&gt;workflow&lt;/em&gt; e a que eu acho que merece um pouco mais de atenÃ§Ã£o &lt;strong&gt;porque demanda configuraÃ§Ãµes em outros locais&lt;/strong&gt;. Vou falar de cada variÃ¡vel abaixo de &lt;code&gt;env:&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PUBLISH_DIR&lt;/code&gt; define o diretÃ³rio cujo conteÃºdo serÃ¡ servido via GitHub Pages. Os &lt;em&gt;feeds&lt;/em&gt; sÃ£o escritos em &lt;code&gt;./feeds&lt;/code&gt; no &lt;em&gt;runner&lt;/em&gt; pelo script &lt;code&gt;generate_feeds.sh&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PUBLISH_BRANCH&lt;/code&gt; define o nome do &lt;em&gt;branch&lt;/em&gt; no nosso repositÃ³rio que terÃ¡ os arquivos servidos via GitHub Pages. Ele serÃ¡ um branch Ã³rfÃ£o do repositÃ³rio. NÃ£o terÃ¡ o script &lt;code&gt;generate_feeds.sh&lt;/code&gt;, o &lt;code&gt;README.md&lt;/code&gt;, o arquivo YAML que descreve o &lt;em&gt;workflow&lt;/em&gt; ou qualquer outra coisa que nÃ£o sejam os arquivos servidos via GitHub Pages. Aqui estamos definindo o &lt;em&gt;branch&lt;/em&gt; &lt;code&gt;gh-pages&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Certifique-se de que as configuraÃ§Ãµes do seu repositÃ³rio em &lt;em&gt;Settings&lt;/em&gt; &amp;gt; &lt;em&gt;Pages&lt;/em&gt; estejam como na imagem abaixo: definindo que a origem Ã© um &lt;em&gt;branch&lt;/em&gt; de nome &lt;code&gt;gh-pages&lt;/code&gt;. No momento em que escrevo esse post, a URL para acessar essa configuraÃ§Ã£o Ã© &lt;a href=&#34;https://github.com/USER/REPO/settings/pages&#34;&gt;https://github.com/USER/REPO/settings/pages&lt;/a&gt;.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;pages_config.png&#34;
         alt=&#34;ConfiguraÃ§Ãµes do GitHub Pages para um repositÃ³rio no GitHub. As configuraÃ§Ãµes mostram que o branch de origem Ã© gh-pages.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;ConfiguraÃ§Ãµes do GitHub Pages.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;code&gt;ACTIONS_DEPLOY_KEY&lt;/code&gt; define um &lt;a href=&#34;https://docs.github.com/en/actions/security-guides/encrypted-secrets&#34;&gt;&lt;em&gt;segredo criptografado&lt;/em&gt;&lt;/a&gt; de mesmo nome com a &lt;strong&gt;parte privada&lt;/strong&gt; de um par de chaves que serÃ¡ usada para o &lt;a href=&#34;https://docs.github.com/en/authentication/connecting-to-github-with-ssh/managing-deploy-keys&#34;&gt;&lt;em&gt;deploy&lt;/em&gt;&lt;/a&gt;. Os segredos sÃ£o configurados em &lt;em&gt;Settings&lt;/em&gt; &amp;gt; &lt;em&gt;Secrets and variables&lt;/em&gt;. No momento em que escrevo esse post, a URL Ã© &lt;a href=&#34;https://github.com/USER/REPO/settings/secrets/actions&#34;&gt;https://github.com/USER/REPO/settings/secrets/actions&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A &lt;strong&gt;parte pÃºblica&lt;/strong&gt; deve ser configurada em &lt;em&gt;Settings&lt;/em&gt; &amp;gt; &lt;em&gt;Deploy keys&lt;/em&gt;. No momento em que escrevo esse post, a URL para essa configuraÃ§Ã£o Ã© &lt;a href=&#34;https://github.com/USER/REPO/settings/keys&#34;&gt;https://github.com/USER/REPO/settings/keys&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A lÃ³gica Ã© anÃ¡loga a configurar login numa mÃ¡quina remota via SSH com um par de chaves. A sua mÃ¡quina local fica com a parte privada. A mÃ¡quina remota fica com a parte pÃºblica.&lt;/p&gt;
&lt;p&gt;O repositÃ³rio tem uma chave pÃºblica configurada para que apenas &lt;strong&gt;as mÃ¡quinas com a parte privada correspondente&lt;/strong&gt; possam fazer &lt;em&gt;deploy&lt;/em&gt; nele. Essa parte privada Ã© usada pelos &lt;em&gt;runners&lt;/em&gt; do GitHub Actions. Eles nada mais sÃ£o que mÃ¡quinas virtuais efÃªmeras, entÃ£o nÃ£o podemos logar nelas uma Ãºnica vez e configurar a chave privada como farÃ­amos em uma mÃ¡quina qualquer que controlamos. A parte privada fica acessÃ­vel aos &lt;em&gt;runners&lt;/em&gt; por meio dos &lt;a href=&#34;https://docs.github.com/en/actions/security-guides/encrypted-secrets&#34;&gt;segredos&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Como configuramos ambas as partes nas configuraÃ§Ãµes de um mesmo repositÃ³rio, pode ficar confuso o papel de cada parte. Espero as linhas acima tenham ajudado a elucidar o papel de cada uma. Mostro como fazer na prÃ¡tica abaixo.&lt;/p&gt;
&lt;h2 id=&#34;configurando-as-chaves&#34;&gt;Configurando as chaves&lt;/h2&gt;
&lt;h3 id=&#34;criando-as-chaves&#34;&gt;Criando as chaves&lt;/h3&gt;
&lt;p&gt;A criaÃ§Ã£o do par de chaves pode ser feita com um comando como o seguinte:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ssh-keygen -t rsa -b &lt;span style=&#34;color:#ae81ff&#34;&gt;4096&lt;/span&gt; -C &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;git config user.email&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; -f gh-pages -N &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;2 arquivos serÃ£o criados por esse comando: &lt;code&gt;gh-pages&lt;/code&gt; e &lt;code&gt;gh-pages.pub&lt;/code&gt;, as chaves privada e pÃºblica, respectivamente.&lt;/p&gt;
&lt;h3 id=&#34;adicionando-a-chave-pÃºblica-como-deploy-key&#34;&gt;Adicionando a chave pÃºblica como &lt;em&gt;deploy key&lt;/em&gt;&lt;/h3&gt;
&lt;p&gt;Acesse &lt;a href=&#34;https://github.com/USER/REPO/settings/keys&#34;&gt;https://github.com/USER/REPO/settings/keys&lt;/a&gt;, clique em &lt;em&gt;Add deploy key&lt;/em&gt; e cole a &lt;strong&gt;parte pÃºblica&lt;/strong&gt;. Lembre-se de marcar a caixa &lt;em&gt;Allow write access&lt;/em&gt; e clique em &lt;em&gt;Add key&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;As configuraÃ§Ãµes em &lt;em&gt;Settings&lt;/em&gt; &amp;gt; &lt;em&gt;Deploy keys&lt;/em&gt; devem ficar parecidas Ã s da figura abaixo.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;deploy_keys.png&#34;
         alt=&#34;ConfiguraÃ§Ãµes das deploy keys num repositÃ³rio do GitHub apÃ³s a configuraÃ§Ã£o de uma chave.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;ConfiguraÃ§Ãµes das deploy keys.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h3 id=&#34;adicionando-a-chave-privada-como-segredo&#34;&gt;Adicionando a chave privada como segredo&lt;/h3&gt;
&lt;p&gt;Acesse &lt;a href=&#34;https://github.com/USER/REPO/settings/secrets/actions&#34;&gt;https://github.com/USER/REPO/settings/secrets/actions&lt;/a&gt;, clique no botÃ£o verde &lt;em&gt;New repository secret&lt;/em&gt;, use &lt;code&gt;ACTIONS_DEPLOY_KEY&lt;/code&gt; como nome, cole a &lt;strong&gt;parte privada&lt;/strong&gt; no campo &lt;em&gt;Secret&lt;/em&gt; e clique em &lt;em&gt;Add secret&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;As configuraÃ§Ãµes em &lt;em&gt;Settings&lt;/em&gt; &amp;gt; &lt;em&gt;Secrets and variables&lt;/em&gt; &amp;gt; &lt;em&gt;Actions&lt;/em&gt; devem ficar parecidas Ã s da figura abaixo.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;secrets.png&#34;
         alt=&#34;ConfiguraÃ§Ãµes dos segredos criptografados num repositÃ³rio do GitHub apÃ³s a inserÃ§Ã£o de um segredo chamado &amp;#34;ACTIONS_DEPLOY_KEY&amp;#34;.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;ConfiguraÃ§Ãµes dos segredos num repositÃ³rio apÃ³s a inserÃ§Ã£o de um segredo chamado ACTIONS_DEPLOY_KEY.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Com o &lt;em&gt;workflow&lt;/em&gt; funcionando, os &lt;em&gt;feeds&lt;/em&gt; estarÃ£o disponÃ­veis numa URL como &lt;a href=&#34;https://USER.github.io/REPO/FILE.xml&#34;&gt;https://USER.github.io/REPO/FILE.xml&lt;/a&gt;. No caso do &lt;em&gt;feed&lt;/em&gt; de exemplo que fiz para o &lt;a href=&#34;https://gmgall.net/blog/criando-feeds-rss-com-newslinkrss/&#34;&gt;post anterior&lt;/a&gt;, a URL Ã© &lt;a href=&#34;https://gmgall.github.io/feeds/gmgall_untappd.xml&#34;&gt;https://gmgall.github.io/feeds/gmgall_untappd.xml&lt;/a&gt; (&lt;code&gt;feeds&lt;/code&gt; Ã© o &lt;a href=&#34;https://github.com/gmgall/feeds&#34;&gt;nome do repositÃ³rio&lt;/a&gt; e &lt;code&gt;gmgall_untappd.xml&lt;/code&gt; Ã© o &lt;a href=&#34;https://github.com/gmgall/feeds/blob/464ddf704a3ee2d46bbc40220331b0bb27d4e767/generate_feeds.sh#L20&#34;&gt;nome do arquivo gerado pelo script&lt;/a&gt; &lt;code&gt;generate_feeds.sh&lt;/code&gt;).&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Usa o GitHub Actions para algo parecido? Pensou em outra forma de servir os &lt;em&gt;feeds&lt;/em&gt;? Seria Ã³timo conversar sobre isso. Entre com &lt;a href=&#34;https://gmgall.net/contact/&#34;&gt;contato&lt;/a&gt; se quiser trocar ideia.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Criando Feeds RSS Para Sites Que NÃ£o os Fornecem</title>
      <link>https://gmgall.net/blog/criando-feeds-rss-com-newslinkrss/</link>
      <pubDate>Wed, 12 Apr 2023 22:00:07 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/criando-feeds-rss-com-newslinkrss/</guid>
      <description>&lt;p&gt;Quem usa um agregador RSS como &amp;ldquo;porta de entrada&amp;rdquo; para a &lt;em&gt;web&lt;/em&gt; hoje em dia sofre com vÃ¡rios sites que deveriam publicar um &lt;em&gt;feed&lt;/em&gt;, mas nÃ£o o fazem.&lt;/p&gt;
&lt;p&gt;Resta buscar/escrever ferramentas que usem APIs ou fazer &lt;em&gt;scraping&lt;/em&gt; para gerar os &lt;em&gt;feeds&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Muitas dessas ferramentas, como a &lt;a href=&#34;https://github.com/RSS-Bridge/rss-bridge&#34;&gt;RSS-Bridge&lt;/a&gt;, parecem interessantes, mas nunca parei para testÃ¡-las porque elas sempre me pareceram &lt;em&gt;complicadas demais&lt;/em&gt;. A RSS-Bridge, por exemplo, precisa de um servidor com PHP.&lt;/p&gt;
&lt;p&gt;Uma ferramenta de linha de comando, fÃ¡cil de instalar, que eu pudesse agendar a execuÃ§Ã£o via &lt;code&gt;cron&lt;/code&gt;, que recebesse as opÃ§Ãµes em texto e &amp;ldquo;jogasse&amp;rdquo; o resultado como texto na saÃ­da padrÃ£o, seria minha ferramenta ideal.&lt;/p&gt;
&lt;p&gt;Nunca tinha encontrado uma ferramenta assim, atÃ© recentemente. Ela chama-se &lt;a href=&#34;https://github.com/ittner/newslinkrss&#34;&gt;newslinkrss&lt;/a&gt;. Citando o README, &amp;ldquo;ele funciona como um &lt;em&gt;crawler&lt;/em&gt; ou &lt;em&gt;scraper&lt;/em&gt; de propÃ³sito especÃ­fico&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Acho que o grande &amp;ldquo;pulo do gato&amp;rdquo; dessa ferramenta Ã© servir como uma espÃ©cie de &lt;em&gt;framework&lt;/em&gt; para criaÃ§Ã£o de &lt;em&gt;feeds&lt;/em&gt; RSS. VocÃª sÃ³ precisa entrar com o conhecimento especÃ­fico sobre a pÃ¡gina para a qual vocÃª estÃ¡ tentando criar um &lt;em&gt;feed&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;OpÃ§Ãµes para capturar/filtrar a URL de cada item do &lt;em&gt;feed&lt;/em&gt; (o conteÃºdo de &lt;code&gt;&amp;lt;link&amp;gt;&lt;/code&gt;), o corpo de cada item (o conteÃºdo de &lt;code&gt;&amp;lt;description&amp;gt;&lt;/code&gt;), a data de cada item (o conteÃºdo de &lt;code&gt;&amp;lt;pubDate&amp;gt;&lt;/code&gt;), o tÃ­tulo do &lt;em&gt;feed&lt;/em&gt;&amp;hellip; EstÃ£o todas presentes.&lt;/p&gt;
&lt;p&gt;Fica mais simples de entender com um exemplo: criarei um &lt;em&gt;feed&lt;/em&gt; RSS para as cervejas em que dei &lt;em&gt;check-in&lt;/em&gt; no &lt;a href=&#34;https://untappd.com/&#34;&gt;Untappd&lt;/a&gt;. O ponto de partida Ã© sempre a URL da pÃ¡gina que lista os links para o que serÃ£o os &lt;code&gt;&amp;lt;item&amp;gt;&lt;/code&gt;s individuais do &lt;em&gt;feed&lt;/em&gt;. Essa URL Ã© o Ãºnico parÃ¢metro posicional que o comando recebe.&lt;/p&gt;
&lt;p&gt;Num blog, seria a URL da pÃ¡gina com a lista dos posts. Num site de notÃ­cias, seria a URL da pÃ¡gina principal de uma editoria qualquer. Nesse exemplo, Ã© a URL da pÃ¡gina do &lt;a href=&#34;https://untappd.com/user/gmgall&#34;&gt;meu perfil no Untappd&lt;/a&gt;. Ela contÃ©m uma &lt;em&gt;timeline&lt;/em&gt; com as cervejas abaixo de &lt;em&gt;Guilherme&amp;rsquo;s Recent Activity&lt;/em&gt;.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;untappd.png&#34;
         alt=&#34;Um perfil do Untappd visualizado visto pela interface web.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Meu perfil no Untappd.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ newslinkrss &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;https://untappd.com/user/gmgall&amp;#39;&lt;/span&gt; -o /tmp/feed.xml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Estou usando a opÃ§Ã£o &lt;code&gt;-o&lt;/code&gt; para gravar o &lt;em&gt;feed&lt;/em&gt; resultante num arquivo em &lt;code&gt;/tmp/feed.xml&lt;/code&gt;. O comportamento &lt;em&gt;default&lt;/em&gt; Ã© imprimir na saÃ­da padrÃ£o. Enquanto estou criando o &lt;em&gt;feed&lt;/em&gt;, gosto de abri-lo com o Firefox para ter uma visualizaÃ§Ã£o melhor da estrutura.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;firefox_rss.png&#34;
         alt=&#34;Um arquivo XML sendo visualizado pelo Firefox.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;A estrutura do feed sendo mostrada pelo Firefox.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Analisando o que temos atÃ© aqui, percebemos que o comando estÃ¡ generalista demais. Todo link virou um item no &lt;em&gt;feed&lt;/em&gt;, atÃ© aqueles do topo da pÃ¡gina (&amp;ldquo;Blog&amp;rdquo;, &amp;ldquo;Top Rated&amp;rdquo;, &amp;ldquo;Help&amp;rdquo;). Precisamos pegar sÃ³ os links para os &lt;em&gt;check-ins&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Vamos inspecionar a pÃ¡gina do perfil para descobrirmos que padrÃ£o seguem os links para os &lt;em&gt;check-ins&lt;/em&gt;. Usando a opÃ§Ã£o &lt;em&gt;Selecionar um elemento da pÃ¡gina (Ctrl+Shift+C)&lt;/em&gt; e colocando o cursor do mouse sobre os links de texto &amp;ldquo;View Detailed Check-in&amp;rdquo;, percebemos que o padrÃ£o Ã© &lt;code&gt;/user/gmgall/checkin/&lt;/code&gt; seguido por um nÃºmero.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;inspetor.png&#34;
         alt=&#34;Firefox Developer Tools sendo usada para inspecionar a pÃ¡gina de um perfil no Untappd&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Usando DevTools para descobrir o padrÃ£o dos links que apontam para a pÃ¡gina individual de cada check-in.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;A opÃ§Ã£o que usamos para capturarmos apenas os links que casam com determinada regex Ã© &lt;code&gt;-p&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ newslinkrss &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-p &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.+/user/gmgall/checkin/[0-9]+&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;https://untappd.com/user/gmgall&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-o /tmp/feed.xml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Se abrirmos o &lt;em&gt;feed&lt;/em&gt; que temos nesse ponto, veremos que cada item Ã© um &lt;em&gt;check-in&lt;/em&gt;. Outros links no perfil nÃ£o viraram &lt;code&gt;&amp;lt;item&amp;gt;&lt;/code&gt;s no &lt;em&gt;feed&lt;/em&gt;. Exemplo de um dos itens:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;item&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Sat, 01 Apr 2023 04:26:44 +0000&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;link&amp;gt;&lt;/span&gt;https://untappd.com/user/gmgall/checkin/1260790060&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/link&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;Sat, 01 Apr 2023 04:26:44 +0000&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;guid&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;isPermaLink=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;https://untappd.com/user/gmgall/checkin/1260790060&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/guid&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/item&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Os links estÃ£o corretos, mas o tÃ­tulo poderia ser melhor. O conteÃºdo de &lt;code&gt;&amp;lt;description&amp;gt;&lt;/code&gt; tambÃ©m. Vamos usar a opÃ§Ã£o &lt;code&gt;--follow&lt;/code&gt; para tentarmos capturar mais informaÃ§Ãµes por item.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ newslinkrss &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-p &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.+/user/gmgall/checkin/[0-9]+&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--follow &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;https://untappd.com/user/gmgall&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-o /tmp/feed.xml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Agora cada item estÃ¡ como o abaixo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;item&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Guilherme is drinking a Torobayo by CompaÃ±ia Cervecera Kunstmann on Untappd&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;link&amp;gt;&lt;/span&gt;https://untappd.com/user/gmgall/checkin/1260790060&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/link&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;Guilherme is drinking a Torobayo by CompaÃ±ia Cervecera Kunstmann on Untappd | UntappdLink text: Sat, 01 Apr 2023 04:26:44 +0000&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;author&amp;gt;&lt;/span&gt;The Untappd Team&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/author&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;guid&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;isPermaLink=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;https://untappd.com/user/gmgall/checkin/1260790060&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/guid&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/item&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Melhorou bastante, mas tem uma melhora Ã³bvia: capturar a data. A opÃ§Ã£o &lt;code&gt;--follow&lt;/code&gt; nos dÃ¡ a capacidade de capturar a data a partir da pÃ¡gina de cada item individual com opÃ§Ãµes especÃ­ficas para isso.&lt;/p&gt;
&lt;p&gt;Vamos usar o inspetor na pÃ¡gina de um &lt;em&gt;check-in&lt;/em&gt; individual para vermos onde podemos pegar a data.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;inspetor2.png&#34;
         alt=&#34;Firefox Developer Tools sendo usado para inspecionar a pÃ¡gina de um check-in no Untappd.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Inspecionando a pÃ¡gina de um check-in no Untappd.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;A data/hora do &lt;em&gt;check-in&lt;/em&gt; aparece num parÃ¡grafo (elemento &lt;code&gt;p&lt;/code&gt;) com a classe &lt;code&gt;time&lt;/code&gt;. Podemos capturÃ¡-la via um &lt;a href=&#34;https://developer.mozilla.org/pt-BR/docs/Web/CSS/CSS_Selectors&#34;&gt;seletor CSS&lt;/a&gt; com a opÃ§Ã£o &lt;code&gt;--date-from-csss&lt;/code&gt; (&lt;em&gt;date from CSS selector&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;Vamos tambÃ©m usar a opÃ§Ã£o &lt;code&gt;--log DEBUG&lt;/code&gt; para vermos exatamente o que estÃ¡ sendo capturado como data.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ newslinkrss &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-p &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.+/user/gmgall/checkin/[0-9]+&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--follow &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--date-from-csss &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.time&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--log DEBUG &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;https://untappd.com/user/gmgall&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-o /tmp/feed.xml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A opÃ§Ã£o &lt;code&gt;--log DEBUG&lt;/code&gt; vai imprimir linhas como a abaixo para cada item:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;INFO:__main__:Following URL https://untappd.com/user/gmgall/checkin/1260790060
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;DEBUG:__main__:date-from-csss found candidate text: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Sat, 01 Apr 2023 04:26:44 +0000&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;DEBUG:__main__:date regex matched: src&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;Sat, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt; Apr &lt;span style=&#34;color:#ae81ff&#34;&gt;2023&lt;/span&gt; 04:26:44 +0000, rx&lt;span style=&#34;color:#f92672&#34;&gt;=(&lt;/span&gt;.+&lt;span style=&#34;color:#f92672&#34;&gt;)&lt;/span&gt;, result&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;Sat, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt; Apr &lt;span style=&#34;color:#ae81ff&#34;&gt;2023&lt;/span&gt; 04:26:44 +0000
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;DEBUG:__main__:Found date from CSS Selector 2023-04-01 04:26:44+00:00
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Nesse caso especÃ­fico, jÃ¡ temos uma data em formato utilizÃ¡vel, mas raramente esse Ã© o caso. Use &lt;code&gt;--log&lt;/code&gt; quando for criar &lt;em&gt;feeds&lt;/em&gt; para pÃ¡ginas com formatos mais complicados.&lt;/p&gt;
&lt;p&gt;Vamos ver como estÃ¡ cada item no &lt;em&gt;feed&lt;/em&gt; agora:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;item&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Guilherme is drinking a Torobayo by CompaÃ±ia Cervecera Kunstmann on Untappd&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;link&amp;gt;&lt;/span&gt;https://untappd.com/user/gmgall/checkin/1260790060&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/link&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;Guilherme is drinking a Torobayo by CompaÃ±ia Cervecera Kunstmann on Untappd | UntappdLink text: Sat, 01 Apr 2023 04:26:44 +0000&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;author&amp;gt;&lt;/span&gt;The Untappd Team&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/author&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;guid&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;isPermaLink=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;https://untappd.com/user/gmgall/checkin/1260790060&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/guid&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;pubDate&amp;gt;&lt;/span&gt;Sat, 01 Apr 2023 04:26:44 GMT&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/pubDate&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/item&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Nesse ponto, temos as datas de cada item (&lt;code&gt;&amp;lt;pubDate&amp;gt;&lt;/code&gt; agora estÃ¡ presente).&lt;/p&gt;
&lt;p&gt;Vamos melhorar o tÃ­tulo de cada item. A parte inicial (&lt;code&gt;Guilherme is drinking a&lt;/code&gt;) e a final (&lt;code&gt;on Untappd&lt;/code&gt;) sÃ£o redundantes. A opÃ§Ã£o &lt;code&gt;--title-regex&lt;/code&gt; nos permite filtrar os tÃ­tulos dos itens. Ela recebe uma regex com um grupo e o que casar dentro desse grupo se torna o novo tÃ­tulo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ newslinkrss &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-p &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.+/user/gmgall/checkin/[0-9]+&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--follow &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--date-from-csss &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.time&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--log DEBUG &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--title-regex &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Guilherme is drinking a (.+) on Untappd&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;https://untappd.com/user/gmgall&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-o /tmp/feed.xml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Cada item agora tem um tÃ­tulo melhor:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;item&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Torobayo by CompaÃ±ia Cervecera Kunstmann&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;link&amp;gt;&lt;/span&gt;https://untappd.com/user/gmgall/checkin/1260790060&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/link&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;Guilherme is drinking a Torobayo by CompaÃ±ia Cervecera Kunstmann on Untappd | UntappdLink text: Sat, 01 Apr 2023 04:26:44 +0000&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;author&amp;gt;&lt;/span&gt;The Untappd Team&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/author&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;guid&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;isPermaLink=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;https://untappd.com/user/gmgall/checkin/1260790060&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/guid&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;pubDate&amp;gt;&lt;/span&gt;Sat, 01 Apr 2023 04:26:44 GMT&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/pubDate&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/item&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Precisamos agora de um corpo melhor em cada item. Atualmente em &lt;code&gt;&amp;lt;description&amp;gt;&lt;/code&gt; temos apenas um texto com nome da cerveja e data/hora do &lt;em&gt;check-in&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Vamos usar &lt;code&gt;--with-body&lt;/code&gt; para incluirmos um corpo e &lt;code&gt;--body-csss&lt;/code&gt; para filtrarmos o que farÃ¡ parte do corpo por meio de um seletor CSS. Usando apenas &lt;code&gt;--with-body&lt;/code&gt;, tudo entre &lt;code&gt;&amp;lt;body&amp;gt;&lt;/code&gt; e &lt;code&gt;&amp;lt;/body&amp;gt;&lt;/code&gt; serÃ¡ incluÃ­do no corpo de cada item do &lt;em&gt;feed&lt;/em&gt;. Pode ser esse o comportamento desejado para pÃ¡ginas mais simples, mas nÃ£o Ã© o caso do Untappd.&lt;/p&gt;
&lt;p&gt;Inspecionando a pÃ¡gina de cada &lt;em&gt;check-in&lt;/em&gt;, descobrimos que o &lt;em&gt;card&lt;/em&gt; com as informaÃ§Ãµes do check-in Ã© uma &lt;code&gt;div&lt;/code&gt; com as classes &lt;code&gt;checkin-info&lt;/code&gt; e &lt;code&gt;pad-it&lt;/code&gt;. Podemos selecionÃ¡-la com o seletor &lt;code&gt;.checkin-info.pad-it&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ newslinkrss &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-p &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.+/user/gmgall/checkin/[0-9]+&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--follow &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--date-from-csss &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.time&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--log DEBUG &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--title-regex &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Guilherme is drinking a (.+) on Untappd&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--with-body &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	--body-csss &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.checkin-info.pad-it&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;https://untappd.com/user/gmgall&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;&lt;/span&gt;	-o /tmp/feed.xml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Se visualizarmos esse &lt;em&gt;feed&lt;/em&gt; num agregador, temos um resultado bem satisfatÃ³rio:&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;quite_rss.png&#34;
         alt=&#34;Agregador RSS exibindo o feed que acabamos de criar.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Agregador QuiteRSS mostrando o feed que acabamos de criar nesse post.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Com o comando que gera o &lt;em&gt;feed&lt;/em&gt; pronto, podemos remover a opÃ§Ã£o &lt;code&gt;--log&lt;/code&gt;. Para assinarmos o &lt;em&gt;feed&lt;/em&gt; criado podemos agendar a execuÃ§Ã£o periÃ³dica do &lt;code&gt;newslinkrss&lt;/code&gt; via &lt;code&gt;cron&lt;/code&gt; e assinarmos o &lt;em&gt;feed&lt;/em&gt; resultante ou entÃ£o indicarmos no nosso agregador RSS que a origem Ã© um comando.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Como vocÃª tem lidado com sites que nÃ£o oferecem &lt;em&gt;feeds&lt;/em&gt;? Conhece alguma ferramenta parecida com o &lt;code&gt;newslinkrss&lt;/code&gt;? Adoraria ouvir sobre. FaÃ§a &lt;a href=&#34;https://gmgall.net/contact/&#34;&gt;contato&lt;/a&gt; se quiser conversar sobre isso.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Acompanhando Suas InscriÃ§Ãµes no YouTube por RSS</title>
      <link>https://gmgall.net/blog/acompanhando-suas-inscricoes-no-youtube-por-rss/</link>
      <pubDate>Thu, 23 Feb 2023 15:01:04 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/acompanhando-suas-inscricoes-no-youtube-por-rss/</guid>
      <description>&lt;p&gt;TL;DR. Escrevi uma ferramenta que converte um CSV com suas inscriÃ§Ãµes no YouTube em um arquivo &lt;a href=&#34;http://opml.org/&#34;&gt;OPML&lt;/a&gt; com os &lt;em&gt;feeds&lt;/em&gt; RSS dos canais. Esse arquivo OPML Ã© importÃ¡vel em quase todos os agregadores RSS. Use o conversor em &lt;a href=&#34;https://yt2opml.gmgall.net/&#34;&gt;https://yt2opml.gmgall.net/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Com FreshRSS + extensÃµes, nÃ£o Ã© necessÃ¡rio nem sair do agregador para assistir aos vÃ­deos.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Procurei colocar RSS de volta na minha vida desde a &lt;a href=&#34;https://gmgall.net/blog/tchau-twitter&#34;&gt;debacle do Twitter&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sempre fui fÃ£ do padrÃ£o RSS. Acho que Ã© a melhor forma de consumo de conteÃºdo na &lt;em&gt;web&lt;/em&gt;. Hoje, Ã© mais importante do que nunca, jÃ¡ que dÃ¡ liberdade ao usuÃ¡rio de desviar das diversas formas pelas quais &lt;a href=&#34;https://thewebisfucked.com/&#34;&gt;a &lt;em&gt;web&lt;/em&gt; se tornou uma merda&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;SÃ³ que eu era uma das folclÃ³ricas viÃºvas do &lt;a href=&#34;https://pt.wikipedia.org/wiki/Google_Reader&#34;&gt;Google Reader&lt;/a&gt;. NÃ£o tinha me adaptado bem a nenhum outro agregador depois dele. Tentei usar vÃ¡rios, mas nunca parava com nenhum. O que usei por mais tempo depois do Reader foi o &lt;a href=&#34;https://feedly.com/&#34;&gt;Feedly&lt;/a&gt;, mas ele nunca virou meu &amp;ldquo;ponto central&amp;rdquo; de consumo da &lt;em&gt;web&lt;/em&gt; como o Reader foi.&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;viuva_google_reader_23-02-2023.png&#34;
         alt=&#34;Print de tweet com texto &amp;#34;Eu trocaria fÃ¡cil todas as minhas redes sociais pelo Google Reader&amp;#34;.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Toda viÃºva do Google Reader desde 2013.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;EntÃ£o fui mantendo o Twitter como &amp;ldquo;agregador&amp;rdquo;. Junta isso com o fato de estarem lÃ¡ vÃ¡rias pessoas que eu gosto e a comodidade falou mais alto. Meu &amp;ldquo;ponto central&amp;rdquo; virou o Twitter.&lt;/p&gt;
&lt;p&gt;O novo senhor feudal do Twitter ser um &lt;a href=&#34;https://www.platformer.news/p/yes-elon-musk-created-a-special-system&#34;&gt;dÃ©spota&lt;/a&gt; &lt;a href=&#34;https://arstechnica.com/tech-policy/2023/02/musk-fired-top-engineer-for-explaining-why-his-tweets-views-are-down/&#34;&gt;mimado&lt;/a&gt; me colocou para procurar, mais uma vez, um agregador que pudesse usar rotineiramente.&lt;/p&gt;
&lt;p&gt;Estou feliz em dizer que parece que a busca terminou. Estou usando o &lt;a href=&#34;https://freshrss.org/&#34;&gt;FreshRSS&lt;/a&gt; hÃ¡ uns 15 dias e estou bem satisfeito.&lt;/p&gt;
&lt;p&gt;Minha &amp;ldquo;dieta de informaÃ§Ãµes&amp;rdquo; melhorou demais. JÃ¡ nÃ£o fico tÃ£o ansioso com o &lt;em&gt;doomscrolling&lt;/em&gt; na &lt;em&gt;timeline&lt;/em&gt; do Twitter ou lendo a Ãºltima polÃªmica de polÃ­tica que chegou aos &lt;em&gt;trending topics&lt;/em&gt;. Estou lendo textos mais longos, sem um algoritmo no caminho.&lt;/p&gt;
&lt;p&gt;Foi apenas natural que eu quisesse consumir &lt;strong&gt;tudo&lt;/strong&gt; via RSS, nÃ£o apenas texto. O prÃ³ximo candidato Ã³bvio era o YouTube. Com frequÃªncia eu abro o &lt;em&gt;app&lt;/em&gt; e vejo alguma coisa indicada na &lt;em&gt;home&lt;/em&gt; ou entÃ£o entro numa sequÃªncia de &lt;em&gt;Shorts&lt;/em&gt; que me fazem gastar um tempÃ£o neles enquanto os vÃ­deos dos canais em que sou inscrito mesmo vÃ£o ficando para depois.&lt;/p&gt;
&lt;p&gt;Minha intuiÃ§Ã£o Ã© que a Google nÃ£o ia deixar os canais com &lt;em&gt;feeds&lt;/em&gt; RSS, justamente para forÃ§ar a visita ao site. Fico feliz de estar errado. Todo canal tem um &lt;em&gt;feed&lt;/em&gt; (por enquanto?), sÃ³ Ã© uma funcionalidade um pouco &amp;ldquo;escondida&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Os canais no YouTube tÃªm um &lt;em&gt;Channel ID&lt;/em&gt; Ãºnico e a URL dos canais seguem o formato &lt;code&gt;https://www.youtube.com/channel/ID&lt;/code&gt;.  O feed fica em &lt;code&gt;https://www.youtube.com/feeds/videos.xml?channel_id=ID&lt;/code&gt;. Usando como exemplo o canal &lt;a href=&#34;https://www.youtube.com/@TeseOnze&#34;&gt;Tese Onze&lt;/a&gt;, temos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;URL do canal: &lt;a href=&#34;http://www.youtube.com/channel/UC0fGGprihDIlQ3ykWvcb9hg&#34;&gt;http://www.youtube.com/channel/UC0fGGprihDIlQ3ykWvcb9hg&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;URL do &lt;em&gt;feed&lt;/em&gt; RSS: &lt;a href=&#34;https://www.youtube.com/feeds/videos.xml?channel_id=UC0fGGprihDIlQ3ykWvcb9hg&#34;&gt;https://www.youtube.com/feeds/videos.xml?channel_id=UC0fGGprihDIlQ3ykWvcb9hg&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O problema Ã© que ninguÃ©m divulga a URL do seu canal nesse formato. Em geral se usa o formato mais amigÃ¡vel &lt;a href=&#34;https://www.youtube.com/@TeseOnze&#34;&gt;https://www.youtube.com/@TeseOnze&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;EntÃ£o, quem quer acompanhar via RSS os vÃ­deos de suas inscriÃ§Ãµes no YouTube precisa:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;obter uma lista dos IDs de todos os canais em que Ã© inscrito;&lt;/li&gt;
&lt;li&gt;gerar uma lista das URLs dos &lt;em&gt;feeds&lt;/em&gt;;&lt;/li&gt;
&lt;li&gt;importar todos os &lt;em&gt;feeds&lt;/em&gt; da lista no agregador.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O formato usado no mundo RSS para importar/exportar listas de &lt;em&gt;feeds&lt;/em&gt; Ã© o &lt;a href=&#34;http://opml.org/&#34;&gt;OPML&lt;/a&gt;, baseado em XML.&lt;/p&gt;
&lt;p&gt;Segue um exemplo de OPML:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-XML&#34; data-lang=&#34;XML&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;ISO-8859-1&amp;#34;?&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;opml&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;version=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;2.0&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;mySubscriptions.opml&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;dateCreated&amp;gt;&lt;/span&gt;Sat, 18 Jun 2005 12:11:52 GMT&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/dateCreated&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;outline&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;text=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Yahoo! News: Technology&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;description=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Technology&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;htmlUrl=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://news.yahoo.com/news?tmpl=index&amp;amp;amp;cid=738&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;language=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;unknown&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;title=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Yahoo! News: Technology&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;type=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;rss&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;version=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RSS2&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlUrl=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://rss.news.yahoo.com/rss/tech&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/opml&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;O padrÃ£o OPML Ã© quase autoexplicativo: Ã© simplesmente um elemento &lt;code&gt;&amp;lt;opml&amp;gt;&lt;/code&gt; com 2 elementos obrigatÃ³rios: &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; e &lt;code&gt;&amp;lt;outline&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Dentro do 1Âº vÃ£o metainformaÃ§Ãµes do arquivo.&lt;/p&gt;
&lt;p&gt;Dentro do 2Âº vai a lista dos &lt;em&gt;feeds&lt;/em&gt; em si, cada um dentro de um &lt;code&gt;&amp;lt;outline&amp;gt;&lt;/code&gt;. Os &lt;code&gt;&amp;lt;outlines&amp;gt;&lt;/code&gt;s podem ser aninhados (caso se deseje colocar &lt;em&gt;feeds&lt;/em&gt; dentro de uma categoria, por exemplo) e claro que uma lista tÃ­pica vai trazer mais de um &lt;em&gt;feed&lt;/em&gt;, mas a intenÃ§Ã£o aqui Ã© sÃ³ mostrar o formato. O atributo chave para a gente aqui Ã© o &lt;code&gt;xmlUrl&lt;/code&gt;, que Ã© o endereÃ§o do &lt;em&gt;feed&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;NÃ³s jÃ¡ sabemos o formato usado para importaÃ§Ã£o de &lt;em&gt;feeds&lt;/em&gt; e como formar a URL de um &lt;em&gt;feed&lt;/em&gt; de um canal no YouTube a partir do seu ID.&lt;/p&gt;
&lt;p&gt;SÃ³ precisamos obter a lista dos IDs dos canais agora.&lt;/p&gt;
&lt;p&gt;O &lt;a href=&#34;https://takeout.google.com/&#34;&gt;Google Takeout&lt;/a&gt; Ã© uma forma de fazer download de todos os registros que a Google possui de um usuÃ¡rio. Basta nÃ£o esquecer de marcar o YouTube que o arquivo resultante vai conter uma lista de inscriÃ§Ãµes em &lt;code&gt;Takeout/YouTube and YouTube Music/subscriptions/subscriptions.csv&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;O formato Ã© bem simples, Ã© um CSV de 3 colunas:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Channel ID,Channel URL,Channel title
UC0fGGprihDIlQ3ykWvcb9hg,http://www.youtube.com/channel/UC0fGGprihDIlQ3ykWvcb9hg,Tese Onze
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Se vocÃª Ã© como eu, pensou logo em fazer um &lt;em&gt;shell script&lt;/em&gt; que para cada linha do CSV:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;concatena &lt;code&gt;https://www.youtube.com/feeds/videos.xml?channel_id=&lt;/code&gt; com os valores da 1Âª coluna;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;joga o valor resultante dentro de um &lt;code&gt;&amp;lt;outline&amp;gt;&lt;/code&gt;, numa propriedade &lt;code&gt;xmlURL&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Provavelmente funcionaria, mas decidi nÃ£o &lt;a href=&#34;https://stackoverflow.com/questions/3034611/whats-so-bad-about-building-xml-with-string-concatenation&#34;&gt;correr&lt;/a&gt; com &lt;a href=&#34;https://news.ycombinator.com/item?id=16915823&#34;&gt;tesouras&lt;/a&gt; dessa vez e usei pacotes JavaScript prÃ³prios para processar &lt;a href=&#34;https://d3js.org/&#34;&gt;CSV&lt;/a&gt; e &lt;a href=&#34;https://github.com/scripting/opmlPackage&#34;&gt;OPML&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Se quiser usar no seu navegador, acesse: &lt;a href=&#34;https://yt2opml.gmgall.net/&#34;&gt;https://yt2opml.gmgall.net/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Tudo Ã© 100% feito no lado do cliente. O &lt;a href=&#34;https://github.com/gmgall/YTtoOPML&#34;&gt;cÃ³digo&lt;/a&gt; Ã© de um &lt;em&gt;backender&lt;/em&gt;, entÃ£o as manipulaÃ§Ãµes do DOM provavelmente poderiam ser mais elegantes, mas funciona.&lt;/p&gt;
&lt;p&gt;Com o arquivo OPML gerado, foi sÃ³ importÃ¡-lo no FreshRSS. Uma possibilidade &lt;strong&gt;muito interessante&lt;/strong&gt; nele Ã© a instalaÃ§Ã£o de uma &lt;a href=&#34;https://github.com/kevinpapst/freshrss-youtube&#34;&gt;extensÃ£o&lt;/a&gt; que incorpora os vÃ­deos dentro. Assim, nÃ£o Ã© necessÃ¡rio sair do agregador para assistir aos vÃ­deos. Mostrei como fica no vÃ­deo abaixo.&lt;/p&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/FwTSpqo4Ucw&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;FreshRSS com extensÃ£o pra embutir vÃ­deos do YouTube ativada.&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;p&gt;Bem prÃ¡tico, nÃ£o?&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Shortcodes no Hugo Inserem Quebras de Linha Indesejadas</title>
      <link>https://gmgall.net/blog/shortcodes-no-hugo-inserem-quebras-de-linha-indesejadas/</link>
      <pubDate>Wed, 08 Feb 2023 11:57:12 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/shortcodes-no-hugo-inserem-quebras-de-linha-indesejadas/</guid>
      <description>&lt;p&gt;Essa jÃ¡ &amp;ldquo;me pegou&amp;rdquo; algumas vezes e demorei um pouco para encontrar soluÃ§Ã£o, entÃ£o documento aqui.&lt;/p&gt;
&lt;p&gt;O &lt;a href=&#34;https://gohugo.io/&#34;&gt;Hugo&lt;/a&gt; insere quebras de linha apÃ³s o conteÃºdo gerado pelos &lt;a href=&#34;https://gohugo.io/content-management/shortcodes/&#34;&gt;shortcodes&lt;/a&gt; que podem causar a renderizaÃ§Ã£o do HTML de forma indesejada.&lt;/p&gt;
&lt;p&gt;Exemplo: suponha que no seu site vocÃª queira tratar das palavras sagradas protegidas pelos &lt;a href=&#34;https://youtu.be/0e2kaQqxmQ0&#34;&gt;Cavaleiros que Dizem Ni&lt;/a&gt;. VocÃª quer usar um &lt;em&gt;snippet&lt;/em&gt; de cÃ³digo para inseri-las, afinal sÃ£o sagradas e vocÃª nÃ£o quer correr o risco de digitÃ¡-las errado.&lt;/p&gt;
&lt;p&gt;EntÃ£o cria o seguinte &lt;em&gt;shortcode&lt;/em&gt; em &lt;code&gt;layouts/shortcodes/sacred_words.html&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;words&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;slice&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ni&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;peng&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;neee-won&amp;#34;&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ &lt;span style=&#34;color:#a6e22e&#34;&gt;upper&lt;/span&gt; (&lt;span style=&#34;color:#a6e22e&#34;&gt;delimit&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;words&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;, &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; e &amp;#34;&lt;/span&gt; ) }}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;E usa o &lt;em&gt;shortcode&lt;/em&gt; no meio do markdown em alguma pÃ¡gina de conteÃºdo. Exemplo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Os Cavaleiros que Dizem &amp;#34;Ni&amp;#34; sÃ£o os quardiÃµes das palavras sagradas {{&amp;lt; &lt;span style=&#34;color:#f92672&#34;&gt;sacred_words&lt;/span&gt; &amp;gt;}}.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ao visualizar o HTML gerado para esse trecho, vÃª algo como:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;p&lt;/span&gt;&amp;gt;Os Cavaleiros que Dizem &amp;amp;ldquo;Ni&amp;amp;rdquo; sÃ£o os quardiÃµes das palavras sagradas 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;NI, PENG E NEEE-WON
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;.&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;p&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Tem uma quebra de linha indesejada no final do conteÃºdo gerado pelo &lt;em&gt;shortcode&lt;/em&gt;.&lt;/strong&gt; O cÃ³digo do &lt;em&gt;shortcode&lt;/em&gt; nÃ£o insere essa quebra, mas ela estÃ¡ lÃ¡. Isso faz esse trecho ser renderizado da seguinte forma pelos navegadores:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Os Cavaleiros que Dizem â€œNiâ€ sÃ£o os quardiÃµes das palavras sagradas NI, PENG E NEEE-WON .
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Tem um espaÃ§o entre a Ãºltima palavra e o ponto final da frase&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Encontrei &lt;strike&gt;as gambiarras&lt;/strike&gt;
 os &lt;em&gt;workarounds&lt;/em&gt; para resolver esse problema numa &lt;a href=&#34;https://github.com/gohugoio/hugo/issues/1753&#34;&gt;issue do prÃ³prio projeto Hugo&lt;/a&gt;, mas parece que a discussÃ£o sobre mudar esse comportamento dos &lt;em&gt;shortcodes&lt;/em&gt; nÃ£o andou muito. Resta-nos nos adaptar.&lt;/p&gt;
&lt;p&gt;&lt;strike&gt;Uma das gambiarras&lt;/strike&gt;
Um dos recursos tÃ©cnicos Ã© truncar o arquivo do &lt;em&gt;shortcode&lt;/em&gt; com o comando &lt;code&gt;truncate -s -1 layouts/shortcodes/sacred_words.html&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Depois disso, o HTML gerado para o trecho que usa o &lt;em&gt;shortcode&lt;/em&gt; fica assim:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;p&lt;/span&gt;&amp;gt;Os Cavaleiros que Dizem &amp;amp;ldquo;Ni&amp;amp;rdquo; sÃ£o os quardiÃµes das palavras sagradas 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;NI, PENG E NEEE-WON.&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;p&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;E Ã© renderizado da seguinte forma:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Os Cavaleiros que Dizem â€œNiâ€ sÃ£o os quardiÃµes das palavras sagradas NI, PENG E NEEE-WON.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;VitÃ³ria!&lt;/p&gt;
&lt;p&gt;Satisfeito, vocÃª decide que sÃ³ falta uma coisa para o seu &lt;em&gt;shortcode&lt;/em&gt; ficar perfeito: ele precisa inserir cÃ³digo para gerar um alerta gritando &amp;ldquo;ni&amp;rdquo; a cada vez que a pÃ¡gina Ã© (re)carregada. Por sorte, pouco cÃ³digo precisa ser adicionado para isso. O &lt;em&gt;shortcode&lt;/em&gt; agora tem a seguinte implementaÃ§Ã£o:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;words&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;slice&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ni&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;peng&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;neee-won&amp;#34;&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ &lt;span style=&#34;color:#a6e22e&#34;&gt;upper&lt;/span&gt; (&lt;span style=&#34;color:#a6e22e&#34;&gt;delimit&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;words&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;, &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; e &amp;#34;&lt;/span&gt; ) }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#a6e22e&#34;&gt;script&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;alert&lt;/span&gt;(&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;NI&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;)&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;script&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Dessa vez vocÃª estÃ¡ esperto e &lt;strong&gt;lembra de truncar o arquivo&lt;/strong&gt;. Quando vai ver a pÃ¡gina gerada num navegador, o alerta aparece, mas&amp;hellip;&lt;/p&gt;
&lt;p&gt;O espaÃ§o entre a Ãºltima palavra sagrada e o ponto final estÃ¡ lÃ¡ de novo! Mesmo apÃ³s usar o &lt;code&gt;truncate&lt;/code&gt;! O HTML foi gerado com uma quebra de linha indesejada novamente:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;p&lt;/span&gt;&amp;gt;Os Cavaleiros que Dizem &amp;amp;ldquo;Ni&amp;amp;rdquo; sÃ£o os quardiÃµes das palavras sagradas 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;NI, PENG E NEEE-WON
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;script&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;alert&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;NI&amp;#39;&lt;/span&gt;)&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;script&lt;/span&gt;&amp;gt;.&amp;lt;/&lt;span style=&#34;color:#f92672&#34;&gt;p&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Se o seu &lt;em&gt;shortcode&lt;/em&gt; vai inserir mais coisa do que a saÃ­da gerada pelos comandos da linguagem de &lt;em&gt;template&lt;/em&gt; do Go, como Ã© o trecho &lt;code&gt;&amp;lt;script&amp;gt;alert(&#39;NI&#39;)&amp;lt;/script&amp;gt;.&amp;lt;/p&amp;gt;&lt;/code&gt; no exemplo acima, vocÃª precisa retirar aquela quebra antes do trecho tambÃ©m.&lt;/p&gt;
&lt;p&gt;Isso pode ser feito deixando o &lt;em&gt;shortcode&lt;/em&gt; assim:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;words&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;slice&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ni&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;peng&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;neee-won&amp;#34;&lt;/span&gt; }}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{{ &lt;span style=&#34;color:#a6e22e&#34;&gt;upper&lt;/span&gt; (&lt;span style=&#34;color:#a6e22e&#34;&gt;delimit&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;words&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;, &amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; e &amp;#34;&lt;/span&gt; ) }}{{&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;}}
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&amp;lt;&lt;span style=&#34;color:#a6e22e&#34;&gt;script&lt;/span&gt;&amp;gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;alert&lt;/span&gt;(&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;NI&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;)&amp;lt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;script&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Agora sim, as quebras de linha que fazem a pÃ¡gina ser renderizada erradamente estÃ£o fora. O espaÃ§o antes do ponto final nÃ£o aparece mais e o alerta ocorre.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;A versÃ£o dos softwares envolvidos no momento em que escrevo esse texto sÃ£o as seguintes:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ go version
go version go1.19.4 linux/amd64
$ hugo version
hugo v0.109.0+extended linux/amd64 BuildDate=unknown
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Build Websites With Hugo</title>
      <link>https://gmgall.net/books/build-websites-with-hugo/</link>
      <pubDate>Sun, 15 Jan 2023 00:00:00 -0300</pubDate>
      
      <guid>https://gmgall.net/books/build-websites-with-hugo/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://gohugo.io/&#34;&gt;Hugo&lt;/a&gt; Ã© o gerador de sites estÃ¡ticos usado para gerar esse site. Depois de alguma pesquisa, me pareceu a melhor ferramenta do tipo disponÃ­vel.&lt;/p&gt;
&lt;p&gt;AdotÃ¡-lo nÃ£o foi um processo rÃ¡pido para mim. Sempre que eu parava para estudÃ¡-lo por tutoriais no YouTube ou pela documentaÃ§Ã£o oficial, acabava um pouco frustrado por nÃ£o estar entendendo 100% do que estava acontecendo. AÃ­ deixava ele de lado por um tempo.&lt;/p&gt;
&lt;p&gt;O Hugo nÃ£o Ã© uma ferramenta difÃ­cil de usar, longe disso. O problema Ã© que com frequÃªncia eu esbarrava em termos especÃ­ficos dele nos tutoriais. Nunca existia muita preocupaÃ§Ã£o em explicar o que eles significavam. Parecia que os autores sempre assumiam algum conhecimento prÃ©vio da ferramenta e eu nÃ£o tinha conhecimento algum.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gohugo.io/content-management/front-matter/&#34;&gt;&lt;em&gt;Front matter&lt;/em&gt;&lt;/a&gt;, &lt;a href=&#34;https://gohugo.io/content-management/archetypes/&#34;&gt;&lt;em&gt;archetypes&lt;/em&gt;&lt;/a&gt;, &lt;a href=&#34;https://gohugo.io/content-management/page-bundles/&#34;&gt;&lt;em&gt;page bundles&lt;/em&gt;&lt;/a&gt;, &lt;a href=&#34;https://gohugo.io/content-management/shortcodes/&#34;&gt;&lt;em&gt;shortcodes&lt;/em&gt;&lt;/a&gt;, &lt;a href=&#34;https://gohugo.io/content-management/taxonomies/&#34;&gt;&lt;em&gt;taxonomies&lt;/em&gt;&lt;/a&gt;&amp;hellip; Um ou mais termos desses eventualmente apareciam &amp;ldquo;jogados&amp;rdquo; no meio da explicaÃ§Ã£o e isso me fazia adiar o consumo daquela documentaÃ§Ã£o para depois que eu tivesse dominado esses conceitos.&lt;/p&gt;
&lt;p&gt;A documentaÃ§Ã£o oficial Ã© boa, mas mais como guia de referÃªncia do que para aprender do zero.&lt;/p&gt;
&lt;p&gt;O livro &lt;em&gt;Build Websites With Hugo&lt;/em&gt; foi o livro que me fez sair desse zero para decidir manter esse site com o Hugo. &lt;strong&gt;Ã‰ um livro 100% orientado pela prÃ¡tica.&lt;/strong&gt; A proposta dele Ã© fazer um site de portfÃ³lio pessoal que sai do mais simples possÃ­vel e vai ficando mais sofisticado a cada capÃ­tulo.&lt;/p&gt;
&lt;p&gt;Eu fui lendo, tomando notas e fazendo o site proposto pelo livro. Mantive a evoluÃ§Ã£o do site em &lt;a href=&#34;https://github.com/gmgall/hugo-example&#34;&gt;um repositÃ³rio git&lt;/a&gt; e tentei fazer mensagens de &lt;em&gt;commit&lt;/em&gt; informativas para eu poder rever algum conceito depois caso fosse necessÃ¡rio.&lt;/p&gt;
&lt;p&gt;2 coisas &amp;ldquo;clarearam&amp;rdquo; bastante o Hugo para mim:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ler esse livro, fazendo o site proposto e&lt;/li&gt;
&lt;li&gt;fazer esse site que vocÃª estÃ¡ lendo com ele.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Escolhi &lt;a href=&#34;https://themes.gohugo.io/themes/smol/&#34;&gt;um tema&lt;/a&gt; &lt;a href=&#34;https://themes.gohugo.io/tags/minimal/&#34;&gt;minimalista&lt;/a&gt; e fiz umas poucas adaptaÃ§Ãµes. AlÃ©m da minha preferÃªncia por sites em que o foco Ã© o conteÃºdo, ser um tema simples tornou mais fÃ¡cil fazer pequenas alteraÃ§Ãµes.&lt;/p&gt;
&lt;p&gt;AlÃ©m de interessante, foi bem divertido. Esse livro Ã© o manual que falta para o Hugo.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Hello World</title>
      <link>https://gmgall.net/blog/hello-world/</link>
      <pubDate>Thu, 12 Jan 2023 13:45:38 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/hello-world/</guid>
      <description>&lt;p&gt;Eu jÃ¡ tentei manter um site pessoal na internet N vezes. Nunca foi &amp;ldquo;pra frente&amp;rdquo;. Essa Ã© a tentativa N + 1.&lt;/p&gt;
&lt;p&gt;NÃ£o preciso ser convencido da importÃ¢ncia da escrita, sei dos benefÃ­cios que posso tirar dela. Escrever nos ajuda a entender as coisas, robustece nosso pensamento. Existem coisas que parecem bem estruturadas na nossa cabeÃ§a atÃ© que tentemos escrever ou conversar com alguÃ©m sobre. Escrever Ã© &lt;a href=&#34;https://en.wikipedia.org/wiki/Debugging&#34;&gt;&lt;em&gt;debugar&lt;/em&gt;&lt;/a&gt; a si mesmo.&lt;/p&gt;
&lt;p&gt;Depois que entendi isso, abandonei qualquer pretensÃ£o de originalidade, que, aliÃ¡s, Ã© &lt;a href=&#34;https://guzey.com/personal/why-have-a-blog/#but-i-dont-have-anything-original-to-say-and-i-would-be-just-repeating-things-said-elsewhere-on-the-internet&#34;&gt;superestimada&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Ainda assim, a procrastinaÃ§Ã£o seguia. Eu implicava com 2 coisas principalmente: a organizaÃ§Ã£o do conteÃºdo e a &lt;em&gt;stack&lt;/em&gt;.&lt;/p&gt;
&lt;h2 id=&#34;organizaÃ§Ã£o-do-conteÃºdo&#34;&gt;OrganizaÃ§Ã£o do conteÃºdo&lt;/h2&gt;
&lt;p&gt;Ter um blog em que escrevesse tudo que eu quisesse, usando apenas tags para organizar o conteÃºdo, nÃ£o me parecia ideal. E se alguÃ©m de TI entrasse no site buscando conteÃºdo tÃ©cnico e tivesse que navegar por um monte de textos opinativos? E se alguma amiga de fora da Ã¡rea de tecnologia entrasse no site e visse um monte de textos sobre desenvolvimento de software?&lt;/p&gt;
&lt;p&gt;Quero poder escrever sobre tudo que me interessa, mas tambÃ©m nÃ£o quero alienar uma potencial audiÃªncia apresentando tudo &amp;ldquo;junto e misturado&amp;rdquo;, numa forma difÃ­cil de navegar.&lt;/p&gt;
&lt;p&gt;Considerei sites separados para cada tipo de conteÃºdo, mas o trabalho extra necessÃ¡rio para manter mais de um site me demoveu dessa ideia. Fora que suscita a pergunta: qual critÃ©rio eu deveria usar para colocar determinado conteÃºdo num site e nÃ£o no outro? Os sites pessoais mais &lt;a href=&#34;https://aurelio.net/&#34;&gt;interessantes&lt;/a&gt; &lt;a href=&#34;https://epxx.co/&#34;&gt;que&lt;/a&gt; &lt;a href=&#34;https://thobias.org/&#34;&gt;conheÃ§o&lt;/a&gt; tratam de &lt;a href=&#34;https://epxx.co/artigos/index_pens.html&#34;&gt;tudo&lt;/a&gt; &lt;a href=&#34;https://aurelio.net/fvm/&#34;&gt;que &amp;ldquo;dÃ¡ na telha&amp;rdquo;&lt;/a&gt; dos donos. O meu seria assim tambÃ©m.&lt;/p&gt;
&lt;p&gt;Foi remoendo as questÃµes acima que decidi usar a organizaÃ§Ã£o com 2 &lt;a href=&#34;https://gohugo.io/content-management/taxonomies/&#34;&gt;taxonomias&lt;/a&gt; (&lt;strong&gt;categorias e tags&lt;/strong&gt;), que jÃ¡ Ã© usada em muitos blogs.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Uma &lt;a href=&#34;https://gmgall.net/categories&#34;&gt;categoria&lt;/a&gt; Ã© uma classificaÃ§Ã£o mais ampla e dificilmente um post vai estar em mais de uma categoria. Para comeÃ§ar, terei 2 categorias: uma para posts &lt;a href=&#34;https://gmgall.net/categories/tech&#34;&gt;tÃ©cnicos&lt;/a&gt; e outra para posts &lt;a href=&#34;https://gmgall.net/categories/non-tech&#34;&gt;nÃ£o tÃ©cnicos&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Uma &lt;a href=&#34;https://gmgall.net/tags&#34;&gt;tag&lt;/a&gt; Ã© uma classificaÃ§Ã£o mais estrita e frequentemente um post terÃ¡ mais de uma tag.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;AlÃ©m disso, existem as seÃ§Ãµes de conteÃºdo separadas. Nelas cada pÃ¡gina pode receber categorias e tags tambÃ©m, mas elas sÃ£o apresentadas de forma diferente dos textos. A Ãºnica seÃ§Ã£o separada hoje Ã© a de &lt;a href=&#34;https://gmgall.net/books&#34;&gt;leituras&lt;/a&gt;. Pretendo que cada pÃ¡gina sobre um livro mostre ao menos uma imagem da capa e informaÃ§Ãµes do livro em destaque.&lt;/p&gt;
&lt;p&gt;Cada categoria, tag e seÃ§Ã£o separada terÃ¡ seu prÃ³prio &lt;em&gt;feed&lt;/em&gt; RSS. Um potencial leitor pode assinar o &lt;em&gt;feed&lt;/em&gt; especÃ­fico e acompanhar apenas o conteÃºdo de seu interesse.&lt;/p&gt;
&lt;h2 id=&#34;stack&#34;&gt;Stack&lt;/h2&gt;
&lt;p&gt;Depois de algumas tentativas de usar &lt;a href=&#34;https://en.wikipedia.org/wiki/Content_management_system&#34;&gt;CMS&lt;/a&gt;s, ficou claro que eu nÃ£o queria ter o trabalho de instalar e manter atualizados os softwares de uma pilha &lt;a href=&#34;https://en.wikipedia.org/wiki/LAMP_(software_bundle)&#34;&gt;LAMP&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Static_site_generator&#34;&gt;Geradores de sites estÃ¡ticos&lt;/a&gt; seriam meu caminho. Li sobre as opÃ§Ãµes disponÃ­veis e fiquei convencido de que o melhor &amp;ldquo;no mercado&amp;rdquo; Ã© o &lt;a href=&#34;https://gohugo.io/&#34;&gt;Hugo&lt;/a&gt;. Decidi usÃ¡-lo. Gostei do que vi nos primeiros usos, mas demorei um pouco atÃ© encontrar um &lt;a href=&#34;https://www.pragprog.com/titles/bhhugo/build-websites-with-hugo/&#34;&gt;livro que me ensinou decentemente&lt;/a&gt; sobre ele.&lt;/p&gt;
&lt;p&gt;Para hospedagem, estou usando &lt;a href=&#34;https://pages.github.com/&#34;&gt;GitHub Pages&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Para fazer o &lt;em&gt;build&lt;/em&gt; e o &lt;em&gt;deploy&lt;/em&gt;, estou usando &lt;a href=&#34;https://github.com/features/actions&#34;&gt;GitHub Actions&lt;/a&gt;. Existem &lt;em&gt;actions&lt;/em&gt; prontas para &lt;a href=&#34;https://github.com/marketplace/actions/hugo-setup&#34;&gt;instalar o Hugo&lt;/a&gt; e &lt;a href=&#34;https://github.com/marketplace/actions/github-pages-action&#34;&gt;fazer o &lt;em&gt;deploy&lt;/em&gt; no GitHub Actions&lt;/a&gt;, entÃ£o o &lt;a href=&#34;https://github.com/gmgall/gmgall.net/blob/main/.github/workflows/gh-pages-deployment.yml&#34;&gt;&lt;em&gt;workflow&lt;/em&gt;&lt;/a&gt; fica relativamente simples.&lt;/p&gt;
&lt;p&gt;O primeiro lugar em que li sobre esse tipo de &lt;em&gt;workflow&lt;/em&gt; foi em &lt;a href=&#34;https://www.morling.dev&#34;&gt;morling.dev&lt;/a&gt;, no post &lt;a href=&#34;https://www.morling.dev/blog/automatically-deploying-hugo-website-via-github-actions/&#34;&gt;&lt;em&gt;Automatically Deploying a Hugo Website via GitHub Actions&lt;/em&gt;&lt;/a&gt;. Seguindo esse caminho, vocÃª fica com um repositÃ³rio Ãºnico que contÃ©m o cÃ³digo fonte do site (em um &lt;em&gt;branch&lt;/em&gt; principal) e os arquivos que efetivamente sÃ£o servidos (em um &lt;em&gt;branch&lt;/em&gt; &lt;a href=&#34;https://dev.to/mcaci/how-to-create-an-orphan-branch-in-git-35ac&#34;&gt;Ã³rfÃ£o&lt;/a&gt; &lt;code&gt;gp-pages&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Outro padrÃ£o que vi sendo bastante usado Ã© ter 2 repositÃ³rios: um sÃ³ para o cÃ³digo fonte e outro sÃ³ para os arquivos que serÃ£o servidos pelo GitHub Pages. Veja um exemplo em &lt;a href=&#34;https://ruddra.com/hugo-deploy-static-page-using-github-actions/&#34;&gt;&lt;em&gt;Hugo: Deploy Static Site using GitHub Actions&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Pensar nisso tudo acima antes mesmo de ter o que postar Ã© complicar demais o que Ã© simples, vocÃª deve estar pensando. O ideal seria simplesmente comeÃ§ar e ir ajustando o que fosse necessÃ¡rio pelo caminho.&lt;/p&gt;
&lt;p&gt;E vocÃª estaria certa. Procrastinei manter um site na web por muito mais tempo do que me orgulho. Estou com o domÃ­nio gmgall.net &amp;ldquo;parado&amp;rdquo; hÃ¡ vÃ¡rios anos.&lt;/p&gt;
&lt;p&gt;Protelei tanto por uma ansiedade de me expor que sÃ³ consegui lidar melhor com &lt;a href=&#34;https://pt.wikipedia.org/wiki/Psicoterapia&#34;&gt;ajuda&lt;/a&gt;. EntÃ£o deseje-me sorte e seja bem vinda, pessoa leitora! ğŸ˜&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Engenheiros do Caos</title>
      <link>https://gmgall.net/books/engenheiros-do-caos/</link>
      <pubDate>Sun, 21 Aug 2022 00:00:00 -0300</pubDate>
      
      <guid>https://gmgall.net/books/engenheiros-do-caos/</guid>
      <description>&lt;p&gt;Esse livro apresenta um histÃ³rico recente dos mÃ©todos de comunicaÃ§Ã£o dessa &amp;ldquo;nova&amp;rdquo; direita populista que tem &amp;ldquo;nadado de braÃ§ada&amp;rdquo; nas redes sociais.&lt;/p&gt;
&lt;p&gt;Uma combinaÃ§Ã£o de lÃ­deres populistas com tÃ©cnicas sofisticadas de persuasÃ£o baseadas em &lt;em&gt;microtargeting&lt;/em&gt;, &lt;em&gt;big data&lt;/em&gt; e &lt;em&gt;fake news&lt;/em&gt; resultou em dividendos eleitorais por todo o mundo, especialmente em uma conjuntura de revolta intensa  - porÃ©m difusa - com os ditos polÃ­ticos &amp;ldquo;tradicionais&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Brexit, Donald Trump, Boris Johnson, Matteo Salvini e Jair Bolsonaro sÃ£o flagelos paridos por esse processo. Compreender as ferramentas usadas por esses engenheiros do caos Ã© um pequeno passo para sairmos desse buraco.&lt;/p&gt;
&lt;p&gt;Esse Ã© o livro que mais recomendei em 2022.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Em termos polÃ­ticos, a chegada do Big Data poderia ser comparada Ã  invenÃ§Ã£o do microscÃ³pio. No passado, a partir de sondagens sempre aleatÃ³rias, os comunicadores polÃ­ticos podiam atingir grandes aglomerados demogrÃ¡ficos ou profissionais: os jovens, os professores do setor pÃºblico, as donas de casa e assim por diante. Hoje, o trabalho dos fÃ­sicos estatÃ­sticos permite enviar uma mensagem personalizada a cada eleitor com base nas caracterÃ­sticas individuais.&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>Criando Suas PrÃ³prias AÃ§Ãµes no fail2ban - Parte 3</title>
      <link>https://gmgall.net/blog/criando-suas-proprias-acoes-no-fail2ban-parte-3/</link>
      <pubDate>Thu, 04 Aug 2011 00:00:00 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/criando-suas-proprias-acoes-no-fail2ban-parte-3/</guid>
      <description>&lt;h2 id=&#34;estrutura-de-uma-aÃ§Ã£o&#34;&gt;Estrutura de uma aÃ§Ã£o&lt;/h2&gt;
&lt;p&gt;Cada aÃ§Ã£o Ã© um arquivo no diretÃ³rio &lt;code&gt;action.d&lt;/code&gt;. Esses arquivos seguem a seguinte estrutura:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[Definition]

# Option:  actionstart
# Notes.:  comando executado ao iniciar o Fail2Ban.
# Values:  CMD
#
actionstart =


# Option:  actionstop
# Notes.:  comando executado ao encerrar o Fail2Ban
# Values:  CMD
#
actionstop =


# Option:  actioncheck
# Notes.:  comando executado antes de cada comando actionban
# Values:  CMD
#
actioncheck =


# Option:  actionban
# Notes.:  comando executado ao banir um IP. Observe que o comando
#          Ã© executado com as permissÃµes do usuÃ¡rio executando o Fail2Ban.
# Tags:    &amp;lt;ip&amp;gt;  IP address
#          &amp;lt;failures&amp;gt;  number of failures
#          &amp;lt;time&amp;gt;  unix timestamp of the ban time
# Values:  CMD
#
actionban = ipfw add deny tcp from &amp;lt;ip&amp;gt; to &amp;lt;localhost&amp;gt; &amp;lt;port&amp;gt;


# Option:  actionunban
# Notes.:  comando executado ao &amp;#34;desbanir&amp;#34; um IP. Observe que o comando
#          Ã© executado com as permissÃµes do usuÃ¡rio executando o Fail2Ban.
# Tags:    &amp;lt;ip&amp;gt;  IP address
#          &amp;lt;failures&amp;gt;  number of failures
#          &amp;lt;time&amp;gt;  unix timestamp of the ban time
# Values:  CMD
#
actionunban = ipfw delete `ipfw list | grep -i &amp;lt;ip&amp;gt; | awk &amp;#39;{print $1;}&amp;#39;`

[Init]

# Option:  port
# Notes.:  specifies port to monitor
# Values:  [ NUM | STRING ]
#
port = ssh

# Option:  localhost
# Notes.:  the local IP address of the network interface
# Values:  IP
#
localhost = 127.0.0.1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;O arquivo que usei de exemplo acima jÃ¡ vem com o pacote e configura uma aÃ§Ã£o que usa o ipfw para bloquear os IPs. Traduzi os comentÃ¡rios da seÃ§Ã£o &lt;code&gt;[Definition]&lt;/code&gt; para explicar o que cada entrada define.&lt;/p&gt;
&lt;p&gt;A seÃ§Ã£o &lt;code&gt;[Init]&lt;/code&gt; define &amp;ldquo;variÃ¡veis&amp;rdquo; que podem ser usadas ao longo do arquivo. Nesse exemplo, &lt;code&gt;port&lt;/code&gt; e &lt;code&gt;localhost&lt;/code&gt;, mas que variÃ¡veis definir Ã© por conta do usuÃ¡rio. &lt;strong&gt;Lembrando que&lt;/strong&gt; &lt;code&gt;&amp;lt;ip&amp;gt;&lt;/code&gt; &lt;strong&gt;vira o IP/hostname casado no grupo&lt;/strong&gt; &lt;code&gt;&amp;lt;host&amp;gt;&lt;/code&gt; &lt;strong&gt;dos filtros&lt;/strong&gt;.&lt;/p&gt;
&lt;h2 id=&#34;definindo-uma-aÃ§Ã£o&#34;&gt;Definindo uma aÃ§Ã£o&lt;/h2&gt;
&lt;p&gt;Existem aÃ§Ãµes predefinidas que bloqueiam por &lt;code&gt;iptables&lt;/code&gt;, &lt;code&gt;ipfw&lt;/code&gt;, &lt;code&gt;shorewall&lt;/code&gt;, TCP wrappers, que avisam por e-mail a cada bloqueio&amp;hellip; Mas nÃ£o existe nenhuma que avise via Gtalk. Vamos criar uma aÃ§Ã£o que faz isso.&lt;/p&gt;
&lt;p&gt;Usarei o programa &lt;a href=&#34;https://web.archive.org/web/20110827104139/http://sendxmpp.platon.sk/&#34;&gt;sendxmpp&lt;/a&gt; para definir uma aÃ§Ã£o que enviarÃ¡ uma mensagem para mim no Gtalk a cada evento. Como configurar o sendxmpp para o Gtalk &lt;a href=&#34;http://ubuntuforums.org/showpost.php?s=0ecf5b2a9c9a97fbfa5438c354dcfc2c&amp;amp;p=8876182&amp;amp;postcount=3&#34;&gt;pode ser visto aqui&lt;/a&gt;. Conheci o sendxmpp num &lt;a href=&#34;http://eriberto.pro.br/blog/2011/03/02/mensagens-jabber-via-linha-de-comando-ideal-para-servidores-de-rede/&#34;&gt;post&lt;/a&gt; do &lt;a href=&#34;http://eriberto.pro.br/blog/&#34;&gt;blog&lt;/a&gt; do &lt;a href=&#34;http://eriberto.pro.br/site/&#34;&gt;JoÃ£o Eriberto Mota Filho&lt;/a&gt; (&lt;a href=&#34;https://twitter.com/eribertomota&#34;&gt;@eribertomota&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Vamos Ã  listagem do arquivo &lt;code&gt;action.d/gtalk.local&lt;/code&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[Definition]

actionstart = printf %%b &amp;#34;Hi,\n
              The jail &amp;lt;name&amp;gt; has been started successfully.\n
              Regards,\n
              Fail2Ban&amp;#34;|sendxmpp -t -u &amp;lt;from&amp;gt; -o gmail.com 

actionstop = printf %%b &amp;#34;Hi,\n
             The jail &amp;lt;name&amp;gt; has been stopped.\n
             Regards,\n
             Fail2Ban&amp;#34;|sendxmpp -t -u &amp;lt;from&amp;gt; -o gmail.com 

actioncheck =

actionban = printf %%b &amp;#34;Hi,\n
            The IP &amp;lt;ip&amp;gt; has just been banned by Fail2Ban after
            &amp;lt;failures&amp;gt; attempts against &amp;lt;name&amp;gt;.\n
            Regards,\n
            Fail2Ban&amp;#34;|sendxmpp -t -u &amp;lt;from&amp;gt; -o gmail.com &amp;lt;to&amp;gt;

actionunban =

[Init]

name = default

from =

to =
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Essa aÃ§Ã£o enviarÃ¡ uma mensagem para o usuÃ¡rio definido em &lt;code&gt;to&lt;/code&gt; tendo como remetente o usuÃ¡rio definido em &lt;code&gt;from&lt;/code&gt; ao iniciar, parar e ao bloquear um IP.&lt;/p&gt;
&lt;h2 id=&#34;ativando-sua-aÃ§Ã£o&#34;&gt;Ativando sua aÃ§Ã£o&lt;/h2&gt;
&lt;p&gt;As aÃ§Ãµes sÃ£o definidas por &lt;em&gt;jail&lt;/em&gt; ou globalmente na seÃ§Ã£o &lt;code&gt;[DEFAULT]&lt;/code&gt; de &lt;code&gt;jail.local&lt;/code&gt;. AÃ§Ãµes definidas nas &lt;em&gt;jails&lt;/em&gt; tem prioridade sobre as definidas globalmente.&lt;/p&gt;
&lt;p&gt;Observe o seguinte trecho de &lt;code&gt;jail.local&lt;/code&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;#
# ACTIONS
#

# Default banning action (e.g. iptables, iptables-new,
# iptables-multiport, shorewall, etc) It is used to define
# action_* variables. Can be overriden globally or per
# section within jail.local file
banaction = iptables-multiport

# email action. Since 0.8.1 upstream fail2ban uses sendmail
# MTA for the mailing. Change mta configuration parameter to mail
# if you want to revert to conventional &amp;#39;mail&amp;#39;.
mta = sendmail

# Default protocol
protocol = tcp

#
# Action shortcuts. To be used to define action parameter

# The simplest action to take: ban only
action_ = %(banaction)s[name=%(__name__)s, port=&amp;#34;%(port)s&amp;#34;, protocol=&amp;#34;%(protocol)s]

# ban &amp;amp; send an e-mail with whois report to the destemail.
action_mw = %(banaction)s[name=%(__name__)s, port=&amp;#34;%(port)s&amp;#34;, protocol=&amp;#34;%(protocol)s]
%(mta)s-whois[name=%(__name__)s, dest=&amp;#34;%(destemail)s&amp;#34;, protocol=&amp;#34;%(protocol)s]

# ban &amp;amp; send an e-mail with whois report and relevant log lines
# to the destemail.
action_mwl = %(banaction)s[name=%(__name__)s, port=&amp;#34;%(port)s&amp;#34;, protocol=&amp;#34;%(protocol)s]
%(mta)s-whois-lines[name=%(__name__)s, dest=&amp;#34;%(destemail)s&amp;#34;, logpath=%(logpath)s]

# Choose default action. To change, just override value of &amp;#39;action&amp;#39; with the
# interpolation to the chosen action shortcut (e.g. action_mw, action_mwl, etc) in jail.local
# globally (section [DEFAULT]) or per specific section
action = %(action_)s
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;A variÃ¡vel &lt;code&gt;action&lt;/code&gt; define a aÃ§Ã£o globalmente. As outras variÃ¡veis definidas antes (&lt;code&gt;action_mvl&lt;/code&gt;, &lt;code&gt;action_mw&lt;/code&gt; e &lt;code&gt;action_&lt;/code&gt;) sÃ£o atalhos Ãºteis. Leia os comentÃ¡rios com atenÃ§Ã£o para entender como essas variÃ¡veis interagem.&lt;/p&gt;
&lt;p&gt;Repare que mais de uma aÃ§Ã£o pode ser setada por linha e que cada aÃ§Ã£o pode receber parÃ¢metros entre colchetes. Esses parÃ¢metros definem os valores das variÃ¡veis declaradas na seÃ§Ã£o &lt;code&gt;[Init]&lt;/code&gt;. Os atalhos &lt;code&gt;action_mvl&lt;/code&gt;, &lt;code&gt;action_mw&lt;/code&gt; e &lt;code&gt;action_&lt;/code&gt; sÃ£o Ãºteis por jÃ¡ ativarem aÃ§Ãµes e passarem parÃ¢metros funcionais para tarefas rotineiras como banir e enviar um e-mail com informaÃ§Ãµes Ãºteis.&lt;/p&gt;
&lt;p&gt;Para definir nossa aÃ§Ã£o gtalk globalmente, basta fazer&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;action = %(action_)s
        gtalk[name=%(__name__)s, from=gmgall, to=gmgall]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;e recarregar as configuraÃ§Ãµes do serviÃ§o:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# /etc/init.d/fail2ban reload
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Funciona!&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;screenshot.png&#34;
         alt=&#34;Janela de chat do mensageiro instantÃ¢neo Pidgin, mostrando mensagens enviadas pelo fail2ban.&#34;/&gt;&lt;figcaption&gt;
            &lt;h4&gt;Janela de chat do mensageiro instantÃ¢neo Pidgin, mostrando mensagens enviadas pelo fail2ban.&lt;/h4&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

</description>
    </item>
    
    <item>
      <title>Criando Seus PrÃ³prios Filtros no fail2ban - Parte 2</title>
      <link>https://gmgall.net/blog/criando-seus-proprios-filtros-no-fail2ban-parte-2/</link>
      <pubDate>Mon, 01 Aug 2011 00:00:00 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/criando-seus-proprios-filtros-no-fail2ban-parte-2/</guid>
      <description>&lt;p&gt;Se nÃ£o existe um filtro pronto para o log que vocÃª deseja monitorar em &lt;code&gt;filter.d&lt;/code&gt;, serÃ¡ necessÃ¡rio criar seu prÃ³prio filtro. Mostrarei como fazer isso atravÃ©s do exemplo que descrevo abaixo:&lt;/p&gt;
&lt;h2 id=&#34;cenÃ¡rio-do-exemplo&#34;&gt;CenÃ¡rio do exemplo&lt;/h2&gt;
&lt;p&gt;Mantenho um wiki &lt;a href=&#34;http://moinmo.in/&#34;&gt;moinmoin&lt;/a&gt; e desejo bloquear o acesso Ã  ele pelos hosts que tentarem login por mais de 3 vezes sem sucesso. Vamos fazer um filtro para fazer esse bloqueio. O log do wiki Ã© escrito em &lt;code&gt;/var/log/moinmoin.log&lt;/code&gt;. Segue trecho desse log:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;2011-07-12 15:45:40,447 MoinMoin.Page WARNING The page &amp;#34;MissingPage&amp;#34; could not be found. Check your underlay directory setting.
2011-07-12 15:45:44,002 MoinMoin.auth WARNING moin: performing login action | request from 192.168.0.10
2011-07-12 15:45:44,003 MoinMoin.auth WARNING moin: could not authenticate user u&amp;#39;GuilhermeGall&amp;#39; (not valid) | request from 192.168.0.10
2011-07-12 15:45:44,030 MoinMoin.Page WARNING The page &amp;#34;MissingPage&amp;#34; could not be found. Check your underlay directory setting.
2011-07-12 15:45:47,705 MoinMoin.auth WARNING moin: performing login action | request from 192.168.0.10
2011-07-12 15:45:47,706 MoinMoin.auth WARNING moin: could not authenticate user u&amp;#39;GuilhermeGall&amp;#39; (not valid) | request from 192.168.0.10
2011-07-12 15:45:47,732 MoinMoin.Page WARNING The page &amp;#34;MissingPage&amp;#34; could not be found. Check your underlay directory setting.
2011-07-12 15:55:59,473 MoinMoin.Page WARNING The page &amp;#34;MissingPage&amp;#34; could not be found. Check your underlay directory setting.
2011-07-12 16:08:51,543 MoinMoin.Page WARNING The page &amp;#34;MissingPage&amp;#34; could not be found. Check your underlay directory setting.
2011-07-13 09:09:01,908 MoinMoin.auth WARNING moin: performing login action | request from 192.168.0.7
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;NÃ£o Ã© difÃ­cil perceber que as linhas com &lt;code&gt;could not authenticate user u&#39;GuilhermeGall&#39; (not valid)&lt;/code&gt; representam as tentativas de login malsucedidas. Se desejamos bloquear os hosts de origem dessas tentativas temos que fazer a regex do filtro casar essas linhas e usar o IP que aparece nelas para executar nossa aÃ§Ã£o (por &lt;em&gt;default&lt;/em&gt;, bloquear via &lt;code&gt;iptables&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Antes de criar nosso filtro, vamos entender a estrutura de um filtro e como desenvolver nossas prÃ³prias regexes.&lt;/p&gt;
&lt;h2 id=&#34;estrutura-de-um-filtro&#34;&gt;Estrutura de um filtro&lt;/h2&gt;
&lt;p&gt;Um filtro Ã© simplesmente um arquivo com uma entrada &lt;code&gt;failregex&lt;/code&gt;, que define as regexes que casam as linhas que representam as tentativas de login malsucedidas, e uma entrada &lt;code&gt;ignoreregex&lt;/code&gt;, que define regexes que casam com linhas que devem ser ignoradas. Outras entradas podem existir, como &lt;code&gt;before&lt;/code&gt; que faz um â€œimportâ€ de outro arquivo, mas &lt;code&gt;failregex&lt;/code&gt; e &lt;code&gt;ignoreregex&lt;/code&gt; sÃ£o as essenciais e usadas na maioria dos casos.&lt;/p&gt;
&lt;p&gt;Se for definir mais de uma regex para &lt;code&gt;failregex&lt;/code&gt; ou &lt;code&gt;ignoreregex&lt;/code&gt;, coloque uma por linha. Exemplo do arquivo &lt;code&gt;filter.d/apache-auth.conf&lt;/code&gt; que jÃ¡ vem no pacote &lt;code&gt;fail2ban&lt;/code&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[Definition]

# Option:  failregex
# Notes.:  regex to match the password failure messages in the logfile. The
#          host must be matched by a group named &amp;#34;host&amp;#34;. The tag &amp;#34;&amp;lt;HOST&amp;gt;&amp;#34; can
#          be used for standard IP/hostname matching and is only an alias for
#          (?:::f{4,6}:)?(?P&amp;lt;host&amp;gt;[\w\-.^_]+)
# Values:  TEXT
#
failregex = [[]client &amp;lt;HOST&amp;gt;[]] user .* authentication failure
            [[]client &amp;lt;HOST&amp;gt;[]] user .* not found
            [[]client &amp;lt;HOST&amp;gt;[]] user .* password mismatch

# Option:  ignoreregex
# Notes.:  regex to ignore. If this regex matches, the line is ignored.
# Values:  TEXT
#
ignoreregex =
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Conforme pode ser lido nos comentÃ¡rios do arquivo acima, a tag &lt;code&gt;&amp;lt;HOST&amp;gt;&lt;/code&gt; deve aparecer dentro da regex na posiÃ§Ã£o onde aparece o IP/hostname do host ofensor. Repare que mais de uma regex foi definida para &lt;code&gt;failregex&lt;/code&gt; â€“ uma em cada linha â€“ e que &lt;code&gt;ignoreregex&lt;/code&gt; pode ser vazio.&lt;/p&gt;
&lt;h2 id=&#34;desenvolvendo-suas-prÃ³prias-regexes&#34;&gt;Desenvolvendo suas prÃ³prias regexes&lt;/h2&gt;
&lt;p&gt;Para escrever suas prÃ³prias regexes para o &lt;code&gt;fail2ban&lt;/code&gt; Ã© preciso ter em mente o seguinte:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Em toda linha de uma &lt;code&gt;failregex&lt;/code&gt;, a parte que casa com o IP/hostname deve estar envolta pela estrutura &lt;code&gt;(?P&amp;lt;host&amp;gt; ... )&lt;/code&gt;. Essa estrutura Ã© uma extensÃ£o especÃ­fica do Python que atribui o nome &lt;code&gt;&amp;lt;host&amp;gt;&lt;/code&gt; ao que foi casado pelo grupo. A tag &lt;code&gt;&amp;lt;host&amp;gt;&lt;/code&gt; Ã© como vocÃª informa ao &lt;code&gt;fail2ban&lt;/code&gt; qual host estava tentando logar.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Como conveniÃªncia, Ã© possÃ­vel usar &lt;code&gt;&amp;lt;HOST&amp;gt;&lt;/code&gt; nas suas regexes, conforme citei no tÃ³pico anterior. &lt;code&gt;&amp;lt;HOST&amp;gt;&lt;/code&gt; Ã© um alias para &lt;code&gt;(?:::f{4,6}:)?(?P&amp;lt;host&amp;gt;\S+)&lt;/code&gt; que casa um IP/hostname dentro de um grupo chamado &lt;code&gt;&amp;lt;host&amp;gt;&lt;/code&gt;. Vide item anterior.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Nas aÃ§Ãµes, a tag &lt;code&gt;&amp;lt;ip&amp;gt;&lt;/code&gt; serÃ¡ substituÃ­da pelo IP do host casado pela tag &lt;code&gt;&amp;lt;host&amp;gt;&lt;/code&gt;, por isso sempre deve existir um grupo nomeado &lt;code&gt;&amp;lt;host&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Para que uma linha de um log case com sua &lt;code&gt;failregex&lt;/code&gt;, ela deve casar em duas partes: o inÃ­cio da linha tem que casar com um padrÃ£o de &lt;em&gt;timestamp&lt;/em&gt; e o restante da linha deve casar com a regex definida em &lt;code&gt;failregex&lt;/code&gt;. Se sua &lt;code&gt;failregex&lt;/code&gt; possui a Ã¢ncora &lt;code&gt;^&lt;/code&gt;, entÃ£o a Ã¢ncora refere-se ao inÃ­cio do restante da linha, apÃ³s o &lt;em&gt;timestamp&lt;/em&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Por Ãºltimo, mas nÃ£o menos importante, o comando &lt;code&gt;fail2ban-regex&lt;/code&gt; permite testar suas regexes antes de criar o filtro. Na realidade, como escrever suas prÃ³prias regexes pode envolver alguma â€“ muita! â€“ tentativa e erro no comeÃ§o, eu diria que esse Ã© o item mais importante. ğŸ™‚ Ele pode ser usado de duas maneiras:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;fail2ban-regex /path/para/arquivo.log &amp;#39;^regex a ser testada$&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ou&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;fail2ban-regex &amp;#39;linha exemplo de log&amp;#39; &amp;#39;^regex a ser testada$&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;definindo-o-filtro&#34;&gt;Definindo o filtro&lt;/h2&gt;
&lt;p&gt;A regex que casa com as linhas que representam as tentativas de login malsucedidas Ã©:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;MoinMoin\.auth (DEBUG|INFO|WARNING|ERROR|CRITICAL) moin: could not authenticate user .* \(not valid\) \| request from &amp;lt;HOST&amp;gt;$
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;NÃ£o Ã© do escopo desse artigo ensinar expressÃµes regulares. Tem muito &lt;a href=&#34;https://aurelio.net/regex/&#34;&gt;material bom sobre isso&lt;/a&gt; por aÃ­, mas resumindo a expressÃ£o acima:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;MoinMoin\.auth&lt;/code&gt; casa &lt;code&gt;MoinMoin.auth&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;DEBUG|INFO|WARNING|ERROR|CRITICAL)&lt;/code&gt; casa &lt;code&gt;DEBUG&lt;/code&gt;, &lt;code&gt;INFO&lt;/code&gt;, &lt;code&gt;WARNING&lt;/code&gt;, &lt;code&gt;ERROR&lt;/code&gt; ou &lt;code&gt;CRITICAL&lt;/code&gt;. Eu poderia ter casado apenas um dos nÃ­veis de severidade, mas ainda estou decidindo em qual nÃ­vel reportarei as mensagens referentes Ã  tentativas de login.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;moin: could not authenticate user&lt;/code&gt; casa &lt;code&gt;moin: could not authenticate user&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;.*&lt;/code&gt; casa &lt;em&gt;qualquer caractere em qualquer quantidade&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;not valid\) \| request from&lt;/code&gt; casa &lt;code&gt;(not valid) | request from&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;HOST&amp;gt;&lt;/code&gt; casa o &lt;em&gt;IP/hostname&lt;/em&gt;. Ã‰ a tal tag indicativa de onde estÃ¡ o IP/hostname que Ã© substituÃ­da por &lt;code&gt;(?:::f{4,6}:)?(?P&amp;lt;host&amp;gt;\S+)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;$&lt;/code&gt; casa o &lt;em&gt;fim da linha&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Testando uma linha de exemplo do log com o &lt;code&gt;fail2ban-regex&lt;/code&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ fail2ban-regex &amp;#39;2011-07-18 14:24:42,687 MoinMoin.auth WARNING moin: could not authenticate user u&amp;#39;UserName&amp;#39; (not valid) | request from 192.168.0.27&amp;#39; &amp;#39;MoinMoin\.auth (DEBUG|INFO|WARNING|ERROR|CRITICAL) moin: could not authenticate user .* \(not valid\) \| request from &amp;lt;HOST&amp;gt;$&amp;#39;

Running tests
=============

Use regex line : MoinMoin\.auth (DEBUG|INFO|WARNING|ERROR|CRITICAL)...
Use single line: 2011-07-18 14:24:42,687 MoinMoin.auth WARNING moin...

Results
=======

Failregex
|- Regular expressions:
|  [1] MoinMoin\.auth (DEBUG|INFO|WARNING|ERROR|CRITICAL) moin: could not authenticate user .* \(not valid\) \| request from &amp;lt;HOST&amp;gt;$
|
`- Number of matches:
   [1] 1 match(es)

Ignoreregex
|- Regular expressions:
|
`- Number of matches:

Summary
=======

Addresses found:
[1]
    192.168.0.27 (Mon Jul 18 14:24:42 2011)

Date template hits:
0 hit(s): MONTH Day Hour:Minute:Second
0 hit(s): WEEKDAY MONTH Day Hour:Minute:Second Year
0 hit(s): WEEKDAY MONTH Day Hour:Minute:Second
0 hit(s): Year/Month/Day Hour:Minute:Second
0 hit(s): Day/Month/Year Hour:Minute:Second
0 hit(s): Day/Month/Year Hour:Minute:Second
0 hit(s): Day/MONTH/Year:Hour:Minute:Second
0 hit(s): Month/Day/Year:Hour:Minute:Second
2 hit(s): Year-Month-Day Hour:Minute:Second
0 hit(s): Day-MONTH-Year Hour:Minute:Second[.Millisecond]
0 hit(s): Day-Month-Year Hour:Minute:Second
0 hit(s): TAI64N
0 hit(s): Epoch
0 hit(s): ISO 8601
0 hit(s): Hour:Minute:Second
0 hit(s): 

Success, the total number of match is 1

However, look at the above section &amp;#39;Running tests&amp;#39; which could contain important
information.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Perceba que o comando mostrou a regex e o nÃºmero de casamentos, alÃ©m do IP encontrado abaixo de &amp;ldquo;Addresses found&amp;rdquo;, indicando que a regex estÃ¡ correta. O nÃºmero de casamentos presumivelmente seria maior que 1, se o comando fosse executado contra um arquivo de log ao invÃ©s de apenas contra uma linha de exemplo.&lt;/p&gt;
&lt;p&gt;Vamos supor vocÃª tenha cometido um erro, como por exemplo nÃ£o especificar um grupo chamado &lt;code&gt;host&lt;/code&gt; na sua regex:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ fail2ban-regex &amp;#39;2011-07-18 14:24:42,687 MoinMoin.auth WARNING moin: could not authenticate user u&amp;#39;UserName&amp;#39; (not valid) | request from 192.168.0.27&amp;#39; &amp;#39;MoinMoin\.auth (DEBUG|INFO|WARNING|ERROR|CRITICAL) moin: could not authenticate user .* \(not valid\) \| request from$&amp;#39;

Running tests
=============

Use regex line : MoinMoin\.auth (DEBUG|INFO|WARNING|ERROR|CRITICAL)...
Use single line: 2011-07-18 14:24:42,687 MoinMoin.auth WARNING moin...

No &amp;#39;host&amp;#39; group in &amp;#39;MoinMoin\.auth (DEBUG|INFO|WARNING|ERROR|CRITICAL) moin: could not authenticate user .* \(not valid\) \| request from$&amp;#39;
Cannot remove regular expression. Index 0 is not valid

Results
=======

Failregex
|- Regular expressions:
|  [1] MoinMoin\.auth (DEBUG|INFO|WARNING|ERROR|CRITICAL) moin: could not authenticate user .* \(not valid\) \| request from$
|
`- Number of matches:
   [1] 0 match(es)

Ignoreregex
|- Regular expressions:
|
`- Number of matches:

Summary
=======

Sorry, no match

Look at the above section &amp;#39;Running tests&amp;#39; which could contain important
information.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Perceba que o &lt;code&gt;fail2ban-regex&lt;/code&gt; informa o erro &lt;code&gt;No &#39;host&#39; group in...&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Como jÃ¡ temos a regex funcional, crie um arquivo com o nome do filtro em &lt;code&gt;filter.d&lt;/code&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# cd /etc/fail2ban/
# cat filter.d/moinmoin.conf
[Definition]

# Option:  failregex
# Notes.:  regex to match the password failures messages in the logfile. The
#          host must be matched by a group named &amp;#34;host&amp;#34;. The tag &amp;#34;&amp;lt;HOST&amp;gt;&amp;#34; can
#          be used for standard IP/hostname matching and is only an alias for
#          (?:::f{4,6}:)?(?P&amp;lt;host&amp;gt;[\w\-.^_]+)
# Values:  TEXT
#
failregex = MoinMoin.auth (DEBUG|INFO|WARNING|ERROR|CRITICAL) moin: could not authenticate user .* \(not valid\) \| request from &amp;lt;HOST&amp;gt;$

# Option:  ignoreregex
# Notes.:  regex to ignore. If this regex matches, the line is ignored.
# Values:  TEXT
#
ignoreregex =
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Crie uma &lt;em&gt;jail&lt;/em&gt; que usa o filtro recÃ©m-criado em &lt;code&gt;jail.local&lt;/code&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[moinmoin]

enabled = true
port = 80
filter = moinmoin
logpath = /var/log/moinmoin.log
maxretry = 3
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;A variÃ¡vel &lt;code&gt;filter&lt;/code&gt; define o nome do filtro, que Ã© o nome do arquivo criado em &lt;code&gt;filter.d&lt;/code&gt; sem a extensÃ£o &lt;code&gt;.conf&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Reinicie o &lt;code&gt;fail2ban&lt;/code&gt; para ativar a nova &lt;em&gt;jail&lt;/em&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# /etc/init.d/fail2ban restart
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ã‰ interessante monitorar o log do prÃ³prio &lt;code&gt;fail2ban&lt;/code&gt;, que por padrÃ£o fica em &lt;code&gt;/var/log/fail2ban.log&lt;/code&gt;, para verificar se suas alteraÃ§Ãµes foram aplicadas com sucesso:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# tail -f /var/log/fail2ban.log
2011-08-01 09:52:04,994 fail2ban.filter : INFO   Set findtime = 600
2011-08-01 09:52:04,994 fail2ban.actions: INFO   Set banTime = 600
2011-08-01 09:52:04,999 fail2ban.jail   : INFO   Creating new jail &amp;#39;ssh&amp;#39;
2011-08-01 09:52:04,999 fail2ban.jail   : INFO   Jail &amp;#39;ssh&amp;#39; uses poller
2011-08-01 09:52:05,000 fail2ban.filter : INFO   Added logfile = /var/log/auth.log
2011-08-01 09:52:05,001 fail2ban.filter : INFO   Set maxRetry = 3
2011-08-01 09:52:05,002 fail2ban.filter : INFO   Set findtime = 600
2011-08-01 09:52:05,002 fail2ban.actions: INFO   Set banTime = 600
2011-08-01 09:52:05,035 fail2ban.jail   : INFO   Jail &amp;#39;moinmoin&amp;#39; started
2011-08-01 09:52:05,039 fail2ban.jail   : INFO   Jail &amp;#39;ssh&amp;#39; started
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As duas Ãºltimas linhas nos mostra as &lt;em&gt;jails&lt;/em&gt; iniciadas. A &lt;code&gt;ssh&lt;/code&gt;, que jÃ¡ vem configurada, e a &lt;code&gt;moinmoin&lt;/code&gt;, que acabamos de configurar.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>IntroduÃ§Ã£o ao fail2ban - Parte 1</title>
      <link>https://gmgall.net/blog/introducao-ao-fail2ban-parte-1/</link>
      <pubDate>Fri, 29 Jul 2011 00:00:00 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/introducao-ao-fail2ban-parte-1/</guid>
      <description>&lt;p&gt;O fail2ban Ã© um software que monitora os logs do sistema e em caso de X (sendo X configurÃ¡vel) tentativas de autenticaÃ§Ã£o sem sucesso em diversos serviÃ§os toma uma atitude, que pode ser colocar o host ofensor em &lt;code&gt;/etc/hosts.deny&lt;/code&gt;, &amp;ldquo;dropar&amp;rdquo; seus pacotes via &lt;code&gt;iptables&lt;/code&gt; ou qualquer outra aÃ§Ã£o definida pelo usuÃ¡rio.&lt;/p&gt;
&lt;h2 id=&#34;instalaÃ§Ã£o-do-fail2ban&#34;&gt;InstalaÃ§Ã£o do fail2ban&lt;/h2&gt;
&lt;p&gt;Em mÃ¡quinas Debian, a melhor maneira de instalar o &lt;code&gt;fail2ban&lt;/code&gt; Ã© via &lt;code&gt;apt-get&lt;/code&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# apt-get update
# apt-get install fail2ban
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As configuraÃ§Ãµes &lt;em&gt;default&lt;/em&gt; bloqueiam via &lt;code&gt;iptables&lt;/code&gt; por 10 minutos os hosts que tentarem sem sucesso login via ssh 6 vezes. O &lt;code&gt;fail2ban&lt;/code&gt; cria uma &lt;em&gt;chain&lt;/em&gt; com nome no padrÃ£o &lt;code&gt;fail2ban-serviÃ§o&lt;/code&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# iptables -L
Chain INPUT (policy ACCEPT)
target prot opt source destination
fail2ban-ssh tcp -- anywhere anywhere multiport dports ssh

Chain FORWARD (policy ACCEPT)
target prot opt source destination

Chain OUTPUT (policy ACCEPT)
target prot opt source destination

Chain fail2ban-ssh (1 references)
target prot opt source destination
RETURN all -- anywhere anywhere
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Lembrando que todo esse comportamento Ã© configurÃ¡vel. O bloqueio pode ser feito via TCP-wrappers (&lt;code&gt;/etc/hosts.{allow,deny}&lt;/code&gt;), e muitos outros serviÃ§os sÃ£o suportados.&lt;/p&gt;
&lt;h2 id=&#34;entendendo-os-arquivos-de-configuraÃ§Ã£o&#34;&gt;Entendendo os arquivos de configuraÃ§Ã£o&lt;/h2&gt;
&lt;p&gt;Alguns termos usados pelo &lt;code&gt;fail2ban&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;filter&lt;/strong&gt;: um filtro define uma regex que casa um padrÃ£o correspondente a uma tentativa de login mal sucedido nos arquivos de log;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;action&lt;/strong&gt;: uma aÃ§Ã£o define os comandos que sÃ£o executados nos mais diversos eventos, como bloquear um host (ex: bloquear via TCP-wrappers ou &lt;code&gt;iptables&lt;/code&gt;), iniciar o &lt;code&gt;fail2ban&lt;/code&gt; (ex: criar as chains no firewall) e parar o &lt;code&gt;fail2ban&lt;/code&gt; (ex: remover as &lt;em&gt;chains&lt;/em&gt; criadas ao iniciar);&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;jail&lt;/strong&gt;: uma &lt;em&gt;jail&lt;/em&gt; Ã© uma combinaÃ§Ã£o de um filtro com uma ou vÃ¡rias &lt;em&gt;actions&lt;/em&gt;. O &lt;code&gt;fail2ban&lt;/code&gt; pode lidar com diversas &lt;em&gt;jails&lt;/em&gt; ao mesmo tempo.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Uma &lt;em&gt;jail&lt;/em&gt; Ã© como dar a seguinte ordem ao &lt;code&gt;fail2ban&lt;/code&gt;: &amp;ldquo;bloqueie via &lt;code&gt;iptables&lt;/code&gt; por 10 minutos os hosts que aparecerem 3 vezes em &lt;code&gt;/var/log/auth.log&lt;/code&gt; com falha de autenticaÃ§Ã£o&amp;rdquo;. Nesse exemplo, bloquear via &lt;code&gt;iptables&lt;/code&gt; Ã© uma aÃ§Ã£o e a regex que casa a falha de autenticaÃ§Ã£o Ã© o filtro.&lt;/p&gt;
&lt;p&gt;Os arquivos de configuraÃ§Ã£o ficam em &lt;code&gt;/etc/fail2ban&lt;/code&gt;.&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# cd /etc/fail2ban
# ls -l
total 17
drwxr-xr-x 2 root root 1024 Jun 28 14:30 action.d
-rw-r--r-- 1 root root 859 Feb 27 2008 fail2ban.conf
drwxr-xr-x 2 root root 1024 Jun 28 14:30 filter.d
-rw-r--r-- 1 root root 6683 Jun 28 2010 jail.conf
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Os diretÃ³rios &lt;code&gt;action.d&lt;/code&gt; e &lt;code&gt;filter.d&lt;/code&gt; mantÃªm as configuraÃ§Ãµes de aÃ§Ãµes e filtros, respectivamente. Os que vÃªm com o pacote jÃ¡ devem atender Ã  maior parte das necessidades. O arquivo &lt;code&gt;fail2ban.conf&lt;/code&gt; contÃ©m configuraÃ§Ãµes gerais do &lt;em&gt;daemon&lt;/em&gt; &lt;code&gt;fail2ban-server&lt;/code&gt;, como &lt;em&gt;path&lt;/em&gt; do arquivo de &lt;em&gt;log&lt;/em&gt; do &lt;code&gt;fail2ban&lt;/code&gt;, &lt;em&gt;path&lt;/em&gt; do arquivo socket usado para o cliente de linha de comando se comunicar com o &lt;em&gt;daemon&lt;/em&gt; etc.&lt;/p&gt;
&lt;p&gt;O arquivo &lt;code&gt;jail.conf&lt;/code&gt; Ã© o mais importante, jÃ¡ que configura as &lt;em&gt;jails&lt;/em&gt;. No tÃ³pico abaixo serÃ¡ explicado como modificar uma &lt;em&gt;jail&lt;/em&gt;.&lt;/p&gt;
&lt;h2 id=&#34;mudando-as-configuraÃ§Ãµes-default&#34;&gt;Mudando as configuraÃ§Ãµes default&lt;/h2&gt;
&lt;p&gt;Na maior parte do tempo, os filtros e aÃ§Ãµes que vÃªm com o pacote atendem Ã s necessidades, bastando usÃ¡-los nas suas &lt;em&gt;jails&lt;/em&gt;. A Ãºnica &lt;em&gt;jail&lt;/em&gt; que vem ativada por padrÃ£o Ã© a que bloqueia os hosts que tentarem logar mais de 6 vezes via SSH. Como exemplo, serÃ¡ mostrado como alterar o nÃºmero de tentativas antes do bloqueio de 6 para 3.&lt;/p&gt;
&lt;p&gt;Primeiramente crie uma cÃ³pia do arquivo &lt;code&gt;jail.conf&lt;/code&gt; chamada &lt;code&gt;jail.local&lt;/code&gt; e faÃ§a as suas modificaÃ§Ãµes nesse arquivo:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# cp jail.conf jail.local
# vim jail.local
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;O trecho abaixo configura uma &lt;em&gt;jail&lt;/em&gt; chamada &lt;code&gt;ssh&lt;/code&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[ssh]

enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Mude para:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[ssh]

enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;FaÃ§a o &lt;code&gt;fail2ban&lt;/code&gt; reler os arquivos de configuraÃ§Ã£o:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# /etc/init.d/fail2ban reload
Reloading authentication failure monitor: fail2ban.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;NÃ£o faÃ§a as alteraÃ§Ãµes diretamente em &lt;code&gt;jail.conf&lt;/code&gt;. Apesar de funcionar, o arquivo pode ser sobrescrito por atualizaÃ§Ãµes no pacote &lt;code&gt;fail2ban&lt;/code&gt;. O &lt;code&gt;fail2ban&lt;/code&gt; aplica as regras primeiro do &lt;code&gt;jail.conf&lt;/code&gt; depois do &lt;code&gt;jail.local&lt;/code&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Daemon em Python</title>
      <link>https://gmgall.net/blog/daemon-em-python/</link>
      <pubDate>Sun, 24 May 2009 00:00:00 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/daemon-em-python/</guid>
      <description>&lt;p&gt;JÃ¡ usei mais de uma vez o cÃ³digo abaixo para criar pequenos &lt;a href=&#34;http://en.wikipedia.org/wiki/Daemon_(computer_software)&#34;&gt;daemons&lt;/a&gt; para Linux. Achei &lt;a href=&#34;https://www.jejik.com/articles/2007/02/a_simple_unix_linux_daemon_in_python/&#34;&gt;aqui&lt;/a&gt; e como ele foi &lt;a href=&#34;https://www.jejik.com/articles/2007/02/a_simple_unix_linux_daemon_in_python/#c6&#34;&gt;liberado em domÃ­nio pÃºblico&lt;/a&gt;, use como melhor convir.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; sys&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt; time&lt;span style=&#34;color:#f92672&#34;&gt;,&lt;/span&gt; atexit
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; signal &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; SIGTERM 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Daemon&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    A generic daemon class.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    Usage: subclass the Daemon class and override the run() method
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;    &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, pidfile, stdin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/dev/null&amp;#39;&lt;/span&gt;, stdout&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/dev/null&amp;#39;&lt;/span&gt;, stderr&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/dev/null&amp;#39;&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdin &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; stdin
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdout &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; stdout
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stderr &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; stderr
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pidfile
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;daemonize&lt;/span&gt;(self):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        do the UNIX double-fork magic, see Stevens&amp;#39; &amp;#34;Advanced
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        Programming in the UNIX Environment&amp;#34; for details (ISBN 0201563177)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        http://www.erlenstar.demon.co.uk/unix/faq_2.html#SEC16
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fork()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; pid &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#75715e&#34;&gt;# exit first parent&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;exit(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;OSError&lt;/span&gt;, e:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stderr&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;fork #1 failed: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%d&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; (&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%s&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; (e&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;errno, e&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;strerror))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;exit(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# decouple from parent environment&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;chdir(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;setsid()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;umask(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# do second fork&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fork()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; pid &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#75715e&#34;&gt;# exit from second parent&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;exit(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;OSError&lt;/span&gt;, e:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stderr&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;fork #2 failed: &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%d&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; (&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%s&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;)&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; (e&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;errno, e&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;strerror))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;exit(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# redirect standard file descriptors&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdout&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;flush()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stderr&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;flush()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        si &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; file(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdin, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        so &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; file(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdout, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;a+&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        se &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; file(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stderr, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;a+&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;dup2(si&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fileno(), sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdin&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fileno())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;dup2(so&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fileno(), sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdout&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fileno())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;dup2(se&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fileno(), sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stderr&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fileno())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# write pidfile&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        atexit&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;register(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;delpid)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        pid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; str(os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;getpid())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        file(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;w+&amp;#39;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%s&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; pid)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;delpid&lt;/span&gt;(self):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;remove(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;start&lt;/span&gt;(self):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        Start the daemon
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# Check for a pidfile to see if the daemon already runs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; file(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; int(pf&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;strip())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pf&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;close()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;IOError&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; pid:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            message &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pidfile &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%s&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; already exist. Daemon already running?&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stderr&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write(message &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;exit(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# Start the daemon&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;daemonize()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;run()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;stop&lt;/span&gt;(self):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        Stop the daemon
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# Get the pid from the pidfile&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; file(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile,&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; int(pf&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;strip())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pf&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;close()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;IOError&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            pid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;not&lt;/span&gt; pid:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            message &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pidfile &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%s&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; does not exist. Daemon not running?&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stderr&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write(message &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;# not an error in a restart&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# Try killing the daemon process&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;kill(pid, SIGTERM)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                time&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sleep(&lt;span style=&#34;color:#ae81ff&#34;&gt;0.1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;OSError&lt;/span&gt;, err:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            err &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; str(err)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; err&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;find(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;No such process&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;path&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;exists(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                    os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;remove(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                print str(err)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;exit(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;restart&lt;/span&gt;(self):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        Restart the daemon
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stop()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;start()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;run&lt;/span&gt;(self):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        You should override this method when you subclass Daemon. It will be called after the process has been
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        daemonized by start() or restart().
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;        &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Resolvi adicionar a funcionalidade de verificar o status do processo tambÃ©m, daÃ­ adicionei o seguinte mÃ©todo Ã  classe acima:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;status&lt;/span&gt;(self):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        pf &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; file(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        pid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; int(pf&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;strip())
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        pf&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;close()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;IOError&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        pid &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;None&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        procfile &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; file(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/proc/&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%d&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;/status&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; pid, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        procfile&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;close()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;IOError&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdout&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;there is not a process with the PID specified in &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%s&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;exit(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TypeError&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdout&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pidfile &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%s&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; does not exist&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pidfile)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;exit(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sys&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stdout&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;the process with the PID &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;%d&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt; is running&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt; pid)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;NÃ£o ficou muito bonito, mas funciona. Lembrando o que jÃ¡ estÃ¡ comentado no &lt;a href=&#34;http://www.jejik.com/articles/2007/02/a_simple_unix_linux_daemon_in_python&#34;&gt;cÃ³digo original&lt;/a&gt;: para usar a classe acima para &amp;ldquo;daemonizar&amp;rdquo; seu programa, crie uma classe filha de &lt;code&gt;Daemon&lt;/code&gt; e sobrescreva o mÃ©todo &lt;code&gt;run()&lt;/code&gt;. Ele serÃ¡ chamado apÃ³s o processo de &amp;ldquo;daemonizaÃ§Ã£o&amp;rdquo; por &lt;code&gt;start()&lt;/code&gt; e &lt;code&gt;restart()&lt;/code&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>SequÃªncia Look and Say em Python</title>
      <link>https://gmgall.net/blog/sequencia-look-and-say-em-python/</link>
      <pubDate>Wed, 11 Mar 2009 00:00:00 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/sequencia-look-and-say-em-python/</guid>
      <description>&lt;p&gt;Tenho brincado ultimamente com os desafios do &lt;a href=&#34;http://www.pythonchallenge.com/&#34;&gt;Python Challenge&lt;/a&gt;. SÃ£o bem interessantes para quem quer aprender Python na prÃ¡tica. Estou resolvendo o nÃ­vel 11 e jÃ¡ precisei &lt;a href=&#34;https://web.archive.org/web/20090309064253/http://www.pythonware.com/products/pil/&#34;&gt;processar imagens&lt;/a&gt;, descompactar dados comprimidos com &lt;a href=&#34;https://docs.python.org/3/library/zipfile.html&#34;&gt;zip&lt;/a&gt; e &lt;a href=&#34;https://docs.python.org/3/library/bz2.html&#34;&gt;bz2&lt;/a&gt;, &lt;a href=&#34;https://docs.python.org/3/library/pickle.html&#34;&gt;serializar objetos&lt;/a&gt;, &lt;a href=&#34;https://docs.python.org/3/library/urllib.html&#34;&gt;acessar recursos via URL&lt;/a&gt;, &lt;a href=&#34;https://docs.python.org/3/library/re.html&#34;&gt;usar expressÃµes regulares&lt;/a&gt; e algumas tarefas que nÃ£o exigiam necessariamente um mÃ³dulo.&lt;/p&gt;
&lt;p&gt;O Ãºltimo nÃ­vel que resolvi tinha como resposta o &lt;a href=&#34;https://web.archive.org/web/20111111070626/http://oeis.org/A005341&#34;&gt;comprimento de um elemento especÃ­fico&lt;/a&gt; de uma &lt;a href=&#34;https://web.archive.org/web/20090303175131/http://www.research.att.com/~njas/sequences/&#34;&gt;sequÃªncia de inteiros&lt;/a&gt; conhecida como &lt;a href=&#34;https://web.archive.org/web/20090304154846/http://www.research.att.com/~njas/sequences/A005150&#34;&gt;&lt;em&gt;look and say&lt;/em&gt;&lt;/a&gt; (olhe e descreva). Achei diversas implementaÃ§Ãµes da geraÃ§Ã£o da sequÃªncia pela web, nenhuma delas me pareceu &lt;em&gt;pythonica&lt;/em&gt; ou legÃ­vel o suficiente. Resolvi juntar algumas das idÃ©ias que vi nessas implementaÃ§Ãµes com os conhecimentos que obtive recentemente com a leitura de um material sobre &lt;a href=&#34;https://docs.python.org/dev/howto/functional.html&#34;&gt;programaÃ§Ã£o funcional em Python&lt;/a&gt; e criei uma funÃ§Ã£o que retorna uma lista com os elementos da sequÃªncia. A minha soluÃ§Ã£o nÃ£o Ã© a mais eficiente possÃ­vel (&lt;a href=&#34;http://www.fantascienza.net/leonardo/so/briciole_python1/&#34;&gt;essa pÃ¡gina&lt;/a&gt; contÃ©m uma implementaÃ§Ã£o alegadamente otimizada para velocidade), mas acho que Ã© elegante e mostra alguns aspectos interessantes da linguagem. Segue o cÃ³digo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;look_and_say&lt;/span&gt;(first, elements):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; itertools &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; groupby
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    seq &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [str(first)]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;say&lt;/span&gt;(number):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        ret &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; k,g &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; groupby(number):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            ret&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append( str(len(list(g))) &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; k )
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;join(ret)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; xrange(elements):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        seq&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(say(seq[&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; seq
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;O argumento &lt;code&gt;first&lt;/code&gt; de &lt;code&gt;look_and_say&lt;/code&gt; recebe o primeiro elemento da lista e &lt;code&gt;elements&lt;/code&gt; quantos elementos depois do primeiro devem ser gerados. Exemplo de uso:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; look_and_say(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;11&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;21&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;1211&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;111221&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;312211&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;13112221&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;1113213211&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;31131211131221&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;13211311123113112211&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;11131221133112132113212221&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; look_and_say(&lt;span style=&#34;color:#ae81ff&#34;&gt;55&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;55&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;25&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;1215&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;11121115&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;31123115&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Dentre os aspectos que gostaria de destacar estÃ£o a possibilidade de importar partes de mÃ³dulos e definir funÃ§Ãµes dentro de funÃ§Ãµes, o uso de listas para &lt;a href=&#34;https://web.archive.org/web/20090324052548/http://codare.net/2006/09/17/python-concatenacao-eficiente-de-strings/&#34;&gt;concatenar strings com eficiÃªncia&lt;/a&gt; e o uso de &lt;a href=&#34;https://docs.python.org/dev/howto/functional.html#grouping-elements&#34;&gt;itertools.groupby&lt;/a&gt; que faz um agrupamento semelhante ao do comando &lt;code&gt;uniq&lt;/code&gt; do Unix, juntando elementos iguais consecutivos em um &lt;a href=&#34;https://docs.python.org/dev/howto/functional.html#iterators&#34;&gt;&lt;em&gt;iterator&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Para quem quiser uma abordagem matemÃ¡tica da sequÃªncia, o &lt;a href=&#34;https://mathworld.wolfram.com/&#34;&gt;Wolfram Mathworld&lt;/a&gt; tem uma &lt;a href=&#34;https://mathworld.wolfram.com/LookandSaySequence.html&#34;&gt;pÃ¡gina sobre ela&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Metaclasses em Python</title>
      <link>https://gmgall.net/blog/metaclasses-em-python/</link>
      <pubDate>Sat, 21 Feb 2009 00:00:00 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/metaclasses-em-python/</guid>
      <description>&lt;h2 id=&#34;introduÃ§Ã£o&#34;&gt;IntroduÃ§Ã£o&lt;/h2&gt;
&lt;p&gt;Li dois textos interessantes no &lt;a href=&#34;http://kodumaro.blogspot.com/&#34;&gt;Kodumaro&lt;/a&gt; recentemente: um sobre &lt;a href=&#34;http://kodumaro.blogspot.com/2009/01/propriedades.html&#34;&gt;propriedades e acessores&lt;/a&gt; e outro sobre o &lt;a href=&#34;http://kodumaro.blogspot.com/2009/01/s-ingleton.html&#34;&gt;design pattern &lt;em&gt;singleton&lt;/em&gt;&lt;/a&gt;. Ambos citavam as metaclasses, um conceito novo para mim e, pelo que andei conversando, novo para muitos de meus colegas de faculdade e trabalho. O seguinte texto Ã© resultado de minha tentativa de explicar o que sÃ£o metaclasses de uma forma simples de ser assimilada por pessoas que comeÃ§aram a estudar Python hÃ¡ pouco tempo como eu e portanto nÃ£o pode ser considerado como um guia definitivo e sem erros sobre o assunto. Qualquer sugestÃ£o ou comentÃ¡rio Ã© bem vindo.&lt;/p&gt;
&lt;h2 id=&#34;revisando-orientaÃ§Ã£o-a-objetos-e-definindo-metaclasses&#34;&gt;Revisando OrientaÃ§Ã£o a Objetos e definindo metaclasses&lt;/h2&gt;
&lt;p&gt;Em uma linguagem de programaÃ§Ã£o orientada a objetos, vocÃª pode definir classes que combinam dados (atributos) e mÃ©todos (comportamentos) que atuam sobre esses dados. Pode-se afirmar que ao definir uma classe se estÃ¡ definindo um domÃ­nio.&lt;/p&gt;
&lt;p&gt;As classes geralmente atuam como modelos para a criaÃ§Ã£o de instÃ¢ncias de classe, que apesar de compartilharem uma mesma &amp;ldquo;forma&amp;rdquo;, possuem dados diferentes. Uma instÃ¢ncia &lt;code&gt;real&lt;/code&gt; e outra &lt;code&gt;peso&lt;/code&gt; de uma mesma classe &lt;code&gt;Moeda&lt;/code&gt; podem possuir um atributo &lt;code&gt;cotacao&lt;/code&gt;, mas cada instÃ¢ncia terÃ¡ seu prÃ³prio valor para esse atributo.&lt;/p&gt;
&lt;p&gt;Em Python, tudo Ã© objeto e tudo tem um tipo. NÃ£o existe diferenÃ§a real entre uma classe e um tipo, especialmente depois da unificaÃ§Ã£o de classes e tipos iniciada no Python 2.2. Ao definir uma classe, portanto, o programador estÃ¡ criando um novo tipo de dados. Como tudo Ã© objeto, as classes tambÃ©m o sÃ£o e possuem uma classe, um tipo. A classe de uma classe Ã© chamada de metaclasse. O tipo &lt;em&gt;default&lt;/em&gt; de uma classe Ã© &lt;code&gt;type&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Moeda&lt;/span&gt;(object):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;pass&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; type(Moeda)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;type &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;type&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; Moeda
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;__main__&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Moeda&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ao chamar &lt;code&gt;type()&lt;/code&gt; com apenas um argumento, obtÃ©m-se o tipo do objeto. Observe que o tipo da &lt;strong&gt;classe&lt;/strong&gt; &lt;code&gt;Moeda&lt;/code&gt; Ã© &lt;code&gt;type&lt;/code&gt;. Afirmar que o tipo de uma classe Ã© &lt;code&gt;type&lt;/code&gt; Ã© o mesmo que afirmar que a sua metaclasse Ã© &lt;code&gt;type&lt;/code&gt;. O exemplo acima comprovou que as classes realmente sÃ£o um objeto com um tipo.&lt;/p&gt;
&lt;p&gt;Os conceitos apresentados atÃ© aqui sÃ£o um tanto abstratos para quem aprendeu orientaÃ§Ã£o a objetos em linguagens como Java e C# e para os novatos em Python. No tÃ³pico seguinte, apresento a implementaÃ§Ã£o de uma classe e de uma metaclasse com dicionÃ¡rios, como se Python nÃ£o tivesse suporte sintÃ¡tico para OO. Apesar de ninguÃ©m querer programar assim na prÃ¡tica o exemplo Ã© extremamente Ãºtil para entender como os objetos funcionam em Python.&lt;/p&gt;
&lt;h2 id=&#34;implementando-classes-com-dicionÃ¡rios&#34;&gt;Implementando classes com dicionÃ¡rios&lt;/h2&gt;
&lt;p&gt;O cÃ³digo abaixo foi originalmente postado no blog de Pedro Werneck em um post que explicava o &lt;a href=&#34;https://web.archive.org/web/20110812155307/http://diaspar.blogspot.com/2008/11/o-porqu-do-self-explcito-ser-que-agora.html&#34;&gt;porquÃª do &lt;code&gt;self&lt;/code&gt; explÃ­cito&lt;/a&gt;. Apesar de explicar metaclasses nÃ£o ser o objetivo principal do texto, achei bastante Ãºtil para entender como o suporte a orientaÃ§Ã£o a objetos foi implementado em Python. Isso acaba levando ao entendimento de vÃ¡rios conceitos interessantes (entre eles metaclasses) da linguagem e a uma apreciaÃ§Ã£o ainda maior de sua simplicidade e consistÃªncia.&lt;/p&gt;
&lt;p&gt;No post original, o cÃ³digo evoluiu aos poucos atÃ© chegar ao ponto em que estÃ¡ aqui. Para um entendimento pleno, &lt;a href=&#34;https://web.archive.org/web/20110812155307/http://diaspar.blogspot.com/2008/11/o-porqu-do-self-explcito-ser-que-agora.html&#34;&gt;leia o post original&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A primeira parte define uma funÃ§Ã£o &lt;code&gt;newClass&lt;/code&gt; que recebe um nome de classe e um dicionÃ¡rio com seus atributos e retorna um dicionÃ¡rio que faz o papel das &amp;ldquo;classes&amp;rdquo; desse programa.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# precisaremos usar isso logo adiante...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; functools &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; partial
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;### Agora jÃ¡ podemos pensar nela como a classe &amp;#39;Class&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;newClass&lt;/span&gt;(nome, atributos):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    cls &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;nome&amp;#39;&lt;/span&gt;:nome} &lt;span style=&#34;color:#75715e&#34;&gt;# cria o dicionÃ¡rio para a classe somente com seu nome&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; k, v &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; atributos&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;items():
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# aqui se um mÃ©todo for o newNome, ele tem de receber a mesma&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# alteraÃ§Ã£o e passar a receber &amp;#39;cls&amp;#39; como primeiro argumento&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; k &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;new&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;nome:
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            v &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; partial(v, cls)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# e atribuÃ­mos tudo normalmente&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        cls[k] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; v
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; cls
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Em seguida, Ã© definido uma &amp;ldquo;classe&amp;rdquo; &lt;code&gt;Pessoa&lt;/code&gt; com os atributos &lt;code&gt;nome&lt;/code&gt;, &lt;code&gt;nascimento&lt;/code&gt; e um mÃ©todo &lt;code&gt;idade&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;### Classe Pessoa&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# construtor, corresponde ao __new__ de Python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;newPessoa&lt;/span&gt;(cls, nome, nascimento): &lt;span style=&#34;color:#75715e&#34;&gt;# agora a classe mesmo vem aqui&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    inst &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {} &lt;span style=&#34;color:#75715e&#34;&gt;# a nova instÃ¢ncia&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    inst[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;classe&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; cls &lt;span style=&#34;color:#75715e&#34;&gt;# a instÃ¢ncia tem de saber de que classe Ã©, e&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                         &lt;span style=&#34;color:#75715e&#34;&gt;# agora pode saber dinamicamente&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# Agora a instÃ¢ncia vai criar os mÃ©todos embrulhando as chamadas&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# para as funÃ§Ãµes originais em uma nova, jÃ¡ se incluindo nela&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; k, v &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; cls&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;items():
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;# Se for funÃ§Ã£o...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; callable(v):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            &lt;span style=&#34;color:#75715e&#34;&gt;# Ã©, entÃ£o vamos embrulhar...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            metodo &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; partial(v, inst)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;            inst[k] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; metodo
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    inst[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;init&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;cls[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;nome&amp;#39;&lt;/span&gt;]](nome, nascimento)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; inst
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# inicializador, corresponde ao __init__ de Python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;initPessoa&lt;/span&gt;(inst, nome, nascimento):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    inst[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;nome&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nome
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    inst[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;nascimento&amp;#39;&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nascimento
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# assim como fazemos normalmente no __init__, aqui nÃ£o precisamos&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;# nos preocupar&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;idade&lt;/span&gt;(inst, hoje):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    hd, hm, ha &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; hoje
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    nd, nm, na &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; inst[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;nascimento&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ha &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; na
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; x
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Com as funÃ§Ãµes que se tornarÃ£o os mÃ©todos da classe &lt;code&gt;Pessoa&lt;/code&gt; definidos, falta a Ãºltima parte da definiÃ§Ã£o da classe que Ã© criar o objeto que representa a classe. Esse objeto Ã© retornado pela funÃ§Ã£o &lt;code&gt;newClass&lt;/code&gt; definida no inÃ­cio do cÃ³digo.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# e agora initPessoa() tem de entrar aqui tambÃ©m&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Pessoa &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; newClass(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Pessoa&amp;#39;&lt;/span&gt;, {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;newPessoa&amp;#39;&lt;/span&gt;:newPessoa,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                             &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;initPessoa&amp;#39;&lt;/span&gt;:initPessoa,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                             &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;idade&amp;#39;&lt;/span&gt;:idade})
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;### Fim da definiÃ§Ã£o de classe&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A seguir, cria-se duas instÃ¢ncias de &lt;code&gt;Pessoa&lt;/code&gt; para testar a implementaÃ§Ã£o.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hank &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Pessoa[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;newPessoa&amp;#39;&lt;/span&gt;](&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Hank Moody&amp;#39;&lt;/span&gt;, (&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1967&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print hank[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;idade&amp;#39;&lt;/span&gt;]((&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;fante &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Pessoa[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;newPessoa&amp;#39;&lt;/span&gt;](&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;John Fante&amp;#39;&lt;/span&gt;, (&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1909&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print fante[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;idade&amp;#39;&lt;/span&gt;]((&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Nesse exemplo, a funÃ§Ã£o &lt;code&gt;newClass&lt;/code&gt; faz o papel de uma metaclasse, pois Ã© ela que Ã© chamada para criar a classe. Ã‰ interessante notar que nÃ£o existe diferenÃ§a real entre o funcionamento de &lt;code&gt;newClass&lt;/code&gt; e &lt;code&gt;newPessoa&lt;/code&gt;. Ambas sÃ£o funÃ§Ãµes que retornam instÃ¢ncias, as instÃ¢ncias retornadas por &lt;code&gt;newClass&lt;/code&gt; sÃ£o &amp;ldquo;classes&amp;rdquo; e as instÃ¢ncias retornadas por &lt;code&gt;newPessoa&lt;/code&gt; sÃ£o objetos do tipo &lt;code&gt;Pessoa&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;O autor termina o texto usando as funÃ§Ãµes de inicializaÃ§Ã£o e cÃ¡lculo de idade com a metaclasse padrÃ£o de Python, &lt;code&gt;type&lt;/code&gt;. Ela recebe uma string que serÃ¡ o nome da nova classe, uma tupla de classes base e um dicionÃ¡rio representando o &lt;em&gt;namespace&lt;/em&gt; da classe. Esse dicionÃ¡rio contÃ©m o que vocÃª normalmente define como o corpo de uma instruÃ§Ã£o &lt;code&gt;class&lt;/code&gt;. A Ãºnica coisa que tem que mudar Ã© o acesso aos atributos, que antes estavam sendo feitos como chaves de dicionÃ¡rios e agora devem usar a sintaxe de atributos normais.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#-*- coding: utf-8 -*-&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;initPessoa&lt;/span&gt;(inst, nome, nascimento):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        inst&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nome &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nome
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        inst&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nascimento &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nascimento
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;idade&lt;/span&gt;(inst, hoje):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        hd, hm, ha &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; hoje
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        nd, nm, na &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; inst&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;nascimento
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ha &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; na
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; x
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Pessoa &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; type(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Pessoa&amp;#39;&lt;/span&gt;, (), {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;__init__&amp;#39;&lt;/span&gt;:initPessoa,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;                              &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;idade&amp;#39;&lt;/span&gt;:idade})
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RepresentaÃ§Ã£o de Pessoa como string: &amp;#34;&lt;/span&gt;,Pessoa
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tipo de Pessoa (sua metaclasse): &amp;#34;&lt;/span&gt;,type(Pessoa)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Imprimindo a idade de uma instÃ¢ncia de Pessoa para teste: &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;hank &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Pessoa(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Hank Moody&amp;#39;&lt;/span&gt;, (&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1967&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print hank&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;idade((&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Resumindo:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Em Python tudo Ã© objeto, inclusive classes e instÃ¢ncias. NÃ£o existe diferenÃ§a real entre elas.&lt;/li&gt;
&lt;li&gt;Criar uma classe Ã© criar um novo tipo.&lt;/li&gt;
&lt;li&gt;A classe de uma classe Ã© chamada de metaclasse. As instÃ¢ncias de metaclasses sÃ£o classes.&lt;/li&gt;
&lt;li&gt;A metaclasse &lt;em&gt;default&lt;/em&gt; Ã© &lt;code&gt;type&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;NÃ£o existe diferenÃ§a real entre mÃ©todos e funÃ§Ãµes. Os mÃ©todos sÃ£o apenas funÃ§Ãµes com &lt;em&gt;namespaces&lt;/em&gt; especÃ­ficos (suas classes).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;criando-e-definindo-metaclasses&#34;&gt;Criando e definindo metaclasses&lt;/h2&gt;
&lt;p&gt;Para definir sua prÃ³pria metaclasse, basta criar uma classe que herda da metaclasse &lt;code&gt;type&lt;/code&gt;. O mÃ©todo inicializador recebe os mesmos argumentos que o mÃ©todo inicializador de &lt;code&gt;type&lt;/code&gt;: uma string que serÃ¡ o nome da classe, uma tupla de classes bases e um dicionÃ¡rio representando o &lt;em&gt;namespace&lt;/em&gt; da classe.&lt;/p&gt;
&lt;p&gt;Segue um &lt;a href=&#34;https://web.archive.org/web/20090215011047/http://www.ibm.com/developerworks/linux/library/l-pymeta.html&#34;&gt;exemplo ligeiramente modificado&lt;/a&gt; de um artigo do &lt;a href=&#34;https://web.archive.org/web/20090221162632/http://www.ibm.com/developerworks/&#34;&gt;IBM developerWorks&lt;/a&gt;. Primeiramente, vamos definir uma nova metaclasse:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ChattyType&lt;/span&gt;(type):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __new__(cls, name, bases, dct):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;       print &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Alocando memÃ³ria para classe&amp;#34;&lt;/span&gt;, name
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;       dct[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;usa_metaclasse&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; type&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__new__(cls, name, bases, dct)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(cls, name, bases, dct):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;       print &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Inicializando (configurando) classe&amp;#34;&lt;/span&gt;, name
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;       super(ChattyType, cls)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__init__(name, bases, dct)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Essa metaclasse sobrescreve o mÃ©todo &lt;code&gt;__new__&lt;/code&gt; que efetivamente Ã© o construtor e retorna uma nova instÃ¢ncia de classe (nesse exemplo especÃ­fico, a instÃ¢ncia retornada serÃ¡ uma classe por estarmos escrevendo uma &lt;strong&gt;meta&lt;/strong&gt;classe) e o mÃ©todo &lt;code&gt;__init__&lt;/code&gt; que Ã© o inicializador da instÃ¢ncia e nÃ£o retorna nada. Ã‰ tentador chamar o &lt;code&gt;__init__&lt;/code&gt; de construtor, mas o trabalho de criaÃ§Ã£o de instÃ¢ncias Ã© do &lt;code&gt;__new__&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;O cÃ³digo acima criou um novo tipo que imprime uma mensagem quando estÃ¡ sendo criado e outra quando estÃ¡ sendo inicializado. Definiu-se tambÃ©m que todas as instÃ¢ncias do novo tipo terÃ£o um atributo &lt;code&gt;usa_metaclasse&lt;/code&gt; com o valor inicial &lt;code&gt;True&lt;/code&gt;. Essa mudanÃ§a foi feita adicionando uma chave ao dicionÃ¡rio que representa o &lt;em&gt;namespace&lt;/em&gt;  da classe (&lt;code&gt;dct&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Com a metaclasse definida, jÃ¡ Ã© possÃ­vel criar classes a partir dela chamando-a como chama-se &lt;code&gt;type&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; X&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ChattyType(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;X&amp;#39;&lt;/span&gt;, (object,), {})
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Alocando memÃ³ria para classe X
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Inicializando (configurando) classe X
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Instanciar classes manualmente como feito acima, nÃ£o Ã© um procedimento muito comum. Segue como Python &lt;a href=&#34;https://www.python.org/download/releases/2.2.3/descrintro/#metaclasses&#34;&gt;determina a metaclasse&lt;/a&gt; de uma determinada classe:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Se o dicionÃ¡rio que representa o &lt;em&gt;namespace&lt;/em&gt; da classe contiver uma chave &lt;code&gt;__metaclass__&lt;/code&gt;, o seu valor Ã© usado.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SenÃ£o, se existe pelo menos uma classe base, sua metaclasse Ã© usada.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SenÃ£o, se existe uma variÃ¡vel global &lt;code&gt;__metaclass__&lt;/code&gt;, seu valor Ã© usado.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SenÃ£o, &lt;code&gt;types.ClassType&lt;/code&gt; Ã© usado.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A criaÃ§Ã£o da classe &lt;code&gt;X&lt;/code&gt; feita no exemplo acima comumente seria feita assim:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;X&lt;/span&gt;(object):
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;    __metaclass__&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ChattyType
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Alocando memÃ³ria para classe X
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Inicializando (configurando) classe X
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A instanciaÃ§Ã£o de &lt;code&gt;ChattyType&lt;/code&gt;, feita explicitamente no primeiro exemplo, agora Ã© feita pelo interpretador Python no final da instruÃ§Ã£o &lt;code&gt;class&lt;/code&gt;. Note que a instruÃ§Ã£o &lt;code&gt;class&lt;/code&gt; Ã© simplesmente &lt;a href=&#34;https://en.wikipedia.org/wiki/Syntactic_sugar&#34;&gt;aÃ§Ãºcar sintÃ¡tico&lt;/a&gt; para a instanciaÃ§Ã£o de classes atravÃ©s de suas metaclasses. Os programadores que nÃ£o fazem uso de metaclasses acabam nÃ£o percebendo isso, jÃ¡ que simplesmente criam suas classes usando &lt;code&gt;class&lt;/code&gt; e Python simplesmente as instancia chamando &lt;code&gt;type&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Continuando o exemplo, podemos confirmar que o tipo da classe Ã© a metaclasse:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; type(X)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;__main__&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ChattyType&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; y&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;X()
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; type(y)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;__main__&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;X&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; type(X) &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; type(type(y))
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;True&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Para concluir, segue algumas dicas na hora de usar metaclasses:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;A modificaÃ§Ã£o do dicionÃ¡rio que representa o &lt;em&gt;namespace&lt;/em&gt; da classe deve ser feita em &lt;code&gt;__new__&lt;/code&gt;, como no exemplo. Se na definiÃ§Ã£o de &lt;code&gt;ChattyType&lt;/code&gt;, &lt;code&gt;dct[&#39;usa_metaclasse&#39;]=True&lt;/code&gt; fosse executado em &lt;code&gt;__init__&lt;/code&gt;, a alteraÃ§Ã£o nÃ£o teria efeito. Considere o uso de &lt;a href=&#34;https://docs.python.org/3/library/functions.html#setattr&#34;&gt;setattr&lt;/a&gt; nesses casos.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sempre herde de &lt;code&gt;type&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;__new__&lt;/code&gt; Ã© o construtor e deve retornar uma nova instÃ¢ncia.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Erros em metaclasses costumam aparecer durante &lt;code&gt;import&lt;/code&gt;s e definiÃ§Ãµes de classes que usem metaclasses diferentes de &lt;code&gt;type&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;alguns-exemplos&#34;&gt;Alguns exemplos&lt;/h2&gt;
&lt;p&gt;Metaclasses sÃ£o usadas na maior parte do tempo para alterar o comportamento de criaÃ§Ã£o e inicializaÃ§Ã£o de classes. Na maioria dos casos, os usuÃ¡rios finais sÃ£o outros programadores. Frameworks e ferramentas de mapeamento objeto-relacional sÃ£o exemplos de softwares que usam metaclasses.&lt;/p&gt;
&lt;p&gt;Alguns usos para as metaclasses:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://web.archive.org/web/20101122212629/http://www.python.org.br/wiki/UnificandoTiposClasses&#34;&gt;Criar propriedades automaticamente&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://kodumaro.blogspot.com/2009/01/s-ingleton.html&#34;&gt;Usar o design pattern singleton de forma transparente&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://everything2.com/title/metaclass&#34;&gt;Monitorar todas as chamadas a mÃ©todos de uma classe&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://web.archive.org/web/20090405120043/http://effbot.org/zone/metaclass-plugins.htm&#34;&gt;Fazer plugins se registrarem automaticamente em um registro comum&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Verificar diversos aspectos de uma classe para garantir que a classe tenha os mÃ©todos e atributos necessÃ¡rios para o correto funcionamento do sistema. Isso Ã© interessante se a aplicaÃ§Ã£o pode ser estendida por plugins desenvolvidos por terceiros.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O importante Ã© que a classe sÃ³ Ã© realmente criada na chamada final a &lt;code&gt;type&lt;/code&gt; na metaclasse. VocÃª Ã© livre para modificar o dicionÃ¡rio de atributos de acordo com as suas necessidades antes disso, portanto existem muito mais possibilidades de uso para as metaclasses do que as apresentadas aqui.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Here Strings, Redirecionamentos e o builtin time</title>
      <link>https://gmgall.net/blog/here-strings-redirecionamentos-e-o-builtin-time/</link>
      <pubDate>Wed, 28 Jan 2009 00:00:00 -0300</pubDate>
      
      <guid>https://gmgall.net/blog/here-strings-redirecionamentos-e-o-builtin-time/</guid>
      <description>&lt;p&gt;Estou fazendo um comparativo entre &lt;code&gt;gzip&lt;/code&gt; e &lt;code&gt;bzip2&lt;/code&gt; em seus diferentes modos de compressÃ£o (-1 a -9) e para automatizar o processo fiz um script bash que usa alguns recursos bastante interessantes, mas Ã s vezes negligenciados, por isso vou falar sobre eles aqui.&lt;/p&gt;
&lt;p&gt;O script basicamente compacta um determinado arquivo com o &lt;code&gt;bzip2&lt;/code&gt; e o &lt;code&gt;gzip&lt;/code&gt;, cada um deles usando todos os modos de compressÃ£o, mede o tempo que o compactador ficou na CPU e escreve os resultados em um arquivo de saÃ­da. O comando para compactar o arquivo Ã© montado dinamicamente usando dois loops aninhados. Um deles, o mais externo, itera sobre a lista de modos de compressÃ£o (-1 a -9) e o outro, o mais interno, itera sobre os compactadores. No final, a linha que realmente faz a compactaÃ§Ã£o e mede o tempo gasto Ã©&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;TIMEC&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;bc &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt; time eval &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$CMDC&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;; &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; 2&amp;gt;&amp;amp;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Onde &lt;code&gt;TIMEC&lt;/code&gt; recebe o tempo de CPU gasto pelo comando de compactaÃ§Ã£o e &lt;code&gt;$CMDC&lt;/code&gt; contÃ©m o comando de compactaÃ§Ã£o. Um valor que essa variÃ¡vel pode assumir durante a execuÃ§Ã£o Ã© &lt;code&gt;gzip -c -2 arquivo&amp;gt;arquivo.gz&lt;/code&gt;, por exemplo.&lt;/p&gt;
&lt;p&gt;Feita essa introduÃ§Ã£o, o primeiro recurso interessante que eu gostaria de apresentar Ã© o &lt;em&gt;here strings&lt;/em&gt;. O funcionamento dele Ã© simples. Dado um comando como:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;bc &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;1+1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;a string &lt;code&gt;1+1&lt;/code&gt; serÃ¡ usada para alimentar a entrada padrÃ£o de &lt;code&gt;bc&lt;/code&gt;. Isso substitui a forma tradicional&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;echo &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;1+1&amp;#39;&lt;/span&gt; | bc
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;que faz a mesma coisa, mas forÃ§a um &lt;a href=&#34;https://en.wikipedia.org/wiki/Fork_(system_call)&#34;&gt;fork&lt;/a&gt; para isso, sendo mais ineficiente.&lt;/p&gt;
&lt;p&gt;Na linha do script que citei no inÃ­cio do post, o &lt;code&gt;bc&lt;/code&gt; vai receber o tempo gasto em modo usuÃ¡rio e o tempo gasto em modo kernel separados por um sinal de adiÃ§Ã£o, fazendo portanto &lt;code&gt;TIMEC&lt;/code&gt; receber a soma desses valores. Aqui chegamos no segundo recurso que gostaria de citar nesse post. O builtin &lt;code&gt;time&lt;/code&gt; do bash (nÃ£o confundir com o comando externo &lt;code&gt;time&lt;/code&gt;), pode ter sua saÃ­da formatada atravÃ©s do conteÃºdo da variÃ¡vel &lt;code&gt;TIMEFORMAT&lt;/code&gt;. Para fazer a saÃ­da do &lt;code&gt;time&lt;/code&gt; ficar no formato de uma soma, simplesmente atribuÃ­ o valor &lt;code&gt;%U+%S&lt;/code&gt; Ã  &lt;code&gt;TIMEFORMAT&lt;/code&gt;. O &lt;code&gt;%U&lt;/code&gt; representa o tempo gasto em modo de usuÃ¡rio e o &lt;code&gt;%S&lt;/code&gt; o tempo gasto em modo kernel.&lt;/p&gt;
&lt;p&gt;Exemplo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ time df
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Sist. Arq.           1K-blocos      Usad Dispon.   Uso% Montado em
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/dev/hdc3             &lt;span style=&#34;color:#ae81ff&#34;&gt;37491624&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;32393072&lt;/span&gt;   &lt;span style=&#34;color:#ae81ff&#34;&gt;3194048&lt;/span&gt;  92% /
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tmpfs                   &lt;span style=&#34;color:#ae81ff&#34;&gt;255180&lt;/span&gt;         &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;    &lt;span style=&#34;color:#ae81ff&#34;&gt;255180&lt;/span&gt;   0% /dev/shm
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;real    0m0.061s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;user    0m0.020s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sys     0m0.016s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ TIMEFORMAT&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;%U+%S &lt;span style=&#34;color:#75715e&#34;&gt;# Formatando a saÃ­da de time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ time df
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;Sist. Arq.           1K-blocos      Usad Dispon.   Uso% Montado em
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/dev/hdc3             &lt;span style=&#34;color:#ae81ff&#34;&gt;37491624&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;32393072&lt;/span&gt;   &lt;span style=&#34;color:#ae81ff&#34;&gt;3194048&lt;/span&gt;  92% /
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;tmpfs                   &lt;span style=&#34;color:#ae81ff&#34;&gt;255180&lt;/span&gt;         &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;    &lt;span style=&#34;color:#ae81ff&#34;&gt;255180&lt;/span&gt;   0% /dev/shm
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;0.020+0.008
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Com isso, sÃ³ fica faltando uma Ãºltima coisa para mostrar: como redirecionar a saÃ­da do builtin &lt;code&gt;time&lt;/code&gt;. A primeira coisa importante a ter em mente, Ã© que os tempos medidos em si sÃ£o jogados na &lt;code&gt;stderr&lt;/code&gt;, enquanto que a &lt;code&gt;stdout&lt;/code&gt; Ã© usada para a saÃ­da do comando cujo tempo de execuÃ§Ã£o Ã© medido. Dito isso uma primeira tentativa de redirecionar a saÃ­da do &lt;code&gt;time&lt;/code&gt; para um arquivo por exemplo, seria fazer simplesmente fazer algo como &lt;code&gt;time comando 2&amp;gt; arquivo&lt;/code&gt;, mas isso nÃ£o funciona. O que Ã© redirecionado para arquivo nesse caso Ã© a saÃ­da de erros de comando, nÃ£o a do time, que continua imprimindo na tela. Exemplo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ time ls naoexiste 2&amp;gt;saida_erros
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;real    0m0.041s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;user    0m0.036s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sys     0m0.004s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cat saida_erros
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;ls: impossÃ­vel acessar naoexiste: Arquivo ou diretÃ³rio nÃ£o encontrado
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A saÃ­da para isso Ã© executar o &lt;code&gt;time&lt;/code&gt; dentro de um bloco (em uma subshell tambÃ©m funciona, mas Ã© ineficiente) e redirecionar a saÃ­da de erros desse bloco. Exemplo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ &lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt; time ls naoexiste 2&amp;gt;/dev/null; &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; 2&amp;gt;saida_erros
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ cat saida_erros
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;real    0m0.056s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;user    0m0.028s
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sys     0m0.004s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Perceba que dentro do bloco eu redirecionei a saÃ­da de erros de &lt;code&gt;ls naoexiste&lt;/code&gt; para &lt;code&gt;/dev/null&lt;/code&gt;, para que ela nÃ£o se misturasse com a saÃ­da do &lt;code&gt;time&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Com isso jÃ¡ temos toda a teoria para entender a linha que citei no inÃ­cio do post. Vamos desmembrÃ¡-la e revisar o que apresentei nesse post.&lt;/p&gt;
&lt;h2 id=&#34;revisando&#34;&gt;Revisando&lt;/h2&gt;
&lt;p&gt;Na linha&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;TIMEC&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;bc &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;{&lt;/span&gt; time eval &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;$CMDC&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;; &lt;span style=&#34;color:#f92672&#34;&gt;}&lt;/span&gt; 2&amp;gt;&amp;amp;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;TIMEC&lt;/code&gt; vai receber a soma, feita pela calculadora &lt;code&gt;bc&lt;/code&gt;, dos tempos calculados pelo builtin &lt;code&gt;time&lt;/code&gt; do bash. A saÃ­da desse comando foi formatada de acordo com a variÃ¡vel &lt;code&gt;TIMEFORMAT&lt;/code&gt; para formar uma string com uma soma do tempo gasto em modo kernel com o tempo gasto em modo de usuÃ¡rio (&lt;code&gt;%U+%S&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Dentro da subshell cujo resultado alimenta a entrada padrÃ£o do &lt;code&gt;bc&lt;/code&gt; o &lt;code&gt;time&lt;/code&gt; precisou ser executado dentro de um bloco, para ser possÃ­vel capturar o seu resultado, que vai para &lt;code&gt;stderr&lt;/code&gt;. A &lt;code&gt;stdout&lt;/code&gt; Ã© usada para a saÃ­da do comando cujo tempo de execuÃ§Ã£o Ã© medido pelo &lt;code&gt;time&lt;/code&gt;. A &lt;code&gt;stderr&lt;/code&gt; do bloco inteiro foi conectado a &lt;code&gt;stdout&lt;/code&gt;, sendo assim devidamente retornada pela subshell e usada para alimentar a entrada padrÃ£o da &lt;code&gt;bc&lt;/code&gt; via &lt;em&gt;here strings&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Ã‰ isso. Quaisquer comentÃ¡rios sÃ£o bem vindos.&lt;/p&gt;
&lt;h2 id=&#34;referÃªncias&#34;&gt;ReferÃªncias&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://mywiki.wooledge.org/BashFAQ/032&#34;&gt;BashFaq: How can I redirect the output of &amp;rsquo;time&amp;rsquo; to a variable or file?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://tldp.org/LDP/abs/html/io-redirection.html&#34;&gt;Advanced Bash-Scripting Guide: I/O Redirection&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://jneves.wordpress.com/2008/03/05/hello-world/&#34;&gt;Papo de Botequim: Tira Gosto&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://linux.die.net/man/1/bash&#34;&gt;Manpage do Bash&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>
